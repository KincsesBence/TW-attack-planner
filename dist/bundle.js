/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var n={"./src/core/Api.tsx":(n,a,e)=>{e.r(a),e.d(a,{addPlan:()=>_,findPlan:()=>y,getAllPlayer:()=>h,getAllVillages:()=>g,getServerConifg:()=>p,getUnitConfig:()=>u,loadPages:()=>w,loadPlans:()=>x,removePlan:()=>V,updatePlan:()=>k});var t=e("./src/core/VillageModel.tsx"),i=e("./src/core/xml2json.ts");const l="https://"+window.location.hostname,o=game_data,s="/map/village.txt",r="/map/player.txt",c="/interface.php?func=get_unit_info",d="/interface.php?func=get_config";async function p(){let n=await $.ajax({url:l+d});return JSON.parse((0,i.xml2json)(n,"")).config}async function u(){let n=await $.ajax({url:l+c});return JSON.parse((0,i.xml2json)(n,"")).config}async function g(){let n=await $.ajax({url:l+s});n=n.trim();let a=[],e=n.split("\n");for(let n=0;n<e.length;n++){let t=e[n].split(",");a.push({id:parseInt(t[0]),name:decodeURIComponent(t[1]).replaceAll("+"," "),owner:parseInt(t[4]),coord:{text:t[2]+"|"+t[3],x:parseInt(t[2]),y:parseInt(t[3])},popRemain:null,unitsContain:null,popSize:null})}return a}async function h(){let n=await $.ajax({url:l+r});n=n.trim();let a=[],e=n.split("\n");for(let n=0;n<e.length;n++){let t=e[n].split(",");a.push({id:parseInt(t[0]),name:decodeURIComponent(t[1]).replaceAll("+"," "),allyId:parseInt(t[2]),villageCnt:parseInt(t[3]),pionts:parseInt(t[4]),rank:parseInt(t[5])})}return a}function m(n=1,a=0){return`/game.php?${0!=o.player.sitter?"t="+o.player.id+"&":""}village=${o.village.id}&group=${a}&page=${n}&screen=overview_villages&mode=combined`}async function w(n=0,a=0){console.log(a);let e=[],t=await $.ajax({url:m(0,a)}),{groups:i,pageCnt:l}=function(n){let a=[];$(n).find(".group-menu-item").get().forEach((n=>{a.push({text:$(n).text().trim().slice(1,-1),value:parseInt($(n).attr("data-group-id"))})}));let e=$($(n).find(".paged-nav-item").get()[0]).parent().find("select"),t=0;return t=1==e.length?e.find("option").length-1:$(n).find(".paged-nav-item").length,{groups:a,pageCnt:t}}(t);e.push(...await b(t)),l>0&&window.top.UI.InfoMessage(`Falvak betöltése 1/${l}`);var o=[];for(let n=1;n<l;n++)o.push(f(m(n,a),n));return await Promise.allSettled(o).then((n=>n.forEach((async n=>{e.push(...n.value)})))),{groups:i,villages:e}}function f(n,a){return new Promise((async(e,t)=>{setTimeout((async()=>{window.top.UI.InfoMessage(`Falvak betöltése 1/${a+1}`);let t=await $.ajax({url:n}),i=await b(t);e(i)}),200*a)}))}function v(n){let a=n.split("/");return a[a.length-1].split(".")[0].replace("unit_","").replace("@2x","")}async function b(n){let a=$(n).find("#combined_table").find("tr"),e=[],i=[];$(a).find("th").get().forEach(((n,a)=>{let e=$(n).find("img");if(e.length>0){let n=$(e).attr("src");n.includes("graphic/unit/unit_")&&!n.includes("unit_militia")&&i.push({index:a,name:v(n)})}}));for(let n=1;n<a.length;n++){const l=a[n];let o=$(l).find("td"),s=parseInt($(l).find(".quickedit-vn").attr("data-id")),r={spear:0,sword:0,axe:0,archer:0,spy:0,light:0,marcher:0,heavy:0,ram:0,catapult:0,knight:0,snob:0},c=0;i.forEach((n=>{let a=parseInt($(o[n.index]).text());r[n.name]=a,c+=window.unitConfig[n.name].pop*a}));let d=(await t.VillageModel.init()).find((n=>n.id==s)),p=parseInt($(o[7]).find("a").text().split(" ")[0]);d.unitsContain=r,d.popRemain=p,d.popSize=c,e.push(d)}return console.log(e),e}function x(){let n=localStorage.getItem("TW-Attack-Planner"),a=[];return n&&(a=JSON.parse(n)),a}function y(n){let a=localStorage.getItem("TW-Attack-Planner"),e=[];a&&(e=JSON.parse(a));let t=e.findIndex(n);return t>-1?e[t]:null}function _(n){let a=localStorage.getItem("TW-Attack-Planner"),e=[];return a&&(e=JSON.parse(a)),-1==e.findIndex((a=>a.name==n.name))&&(e.push(n),localStorage.setItem("TW-Attack-Planner",JSON.stringify(e)),!0)}function k(n){let a=localStorage.getItem("TW-Attack-Planner"),e=[];a&&(e=JSON.parse(a));let t=e.findIndex((a=>a.id==n.id));return e[t]=n,localStorage.setItem("TW-Attack-Planner",JSON.stringify(e)),!0}function V(n){let a=localStorage.getItem("TW-Attack-Planner"),e=[];a&&(e=JSON.parse(a));let t=e.findIndex((a=>a.id==n));t>-1&&(e.splice(t,1),localStorage.setItem("TW-Attack-Planner",JSON.stringify(e)))}},"./src/core/LaunchVillagesModel.tsx":(n,a,e)=>{e.r(a),e.d(a,{LaunchVillagesModel:()=>l});var t=e("./src/core/Api.tsx"),i=e("./src/core/Model.tsx");class l extends i.Model{static init(n=0){return null==l.instance||this.group!=n?async function(){return l.instance=new l,await l.instance.loadlaunchVillages(n),l.instance}():async function(){return l.instance}()}async loadlaunchVillages(n){let{groups:a,villages:e}=await(0,t.loadPages)(0,n);this.items=e,l.groups=a}}l.instance=null,l.group=0,l.groups=[]},"./src/core/Model.tsx":(n,a,e)=>{e.r(a),e.d(a,{Model:()=>t});class t{constructor(n=[]){this.items=[],this.items=n}first(){return this.items.length>0?this.items[0]:null}get(n=this.items.length){return this.items.slice(0,n)}filter(n){let a=this.items.filter(n);return new t(a)}find(n){return this.items.find(n)}sort(n,a){let e=this.items.sort(((e,t)=>e[n]>t[n]?a?1:-1:a?-1:1));return new t(e)}}},"./src/core/PlayersModel.tsx":(n,a,e)=>{e.r(a),e.d(a,{PlayersModel:()=>l});var t=e("./src/core/Api.tsx"),i=e("./src/core/Model.tsx");class l extends i.Model{static init(){return console.log(l.instance),null==l.instance?async function(){return l.instance=new l,await l.instance.loadPlayers(),l.instance}():async function(){return l.instance}()}async loadPlayers(){this.items=await(0,t.getAllPlayer)()}}l.instance=null},"./src/core/VillageModel.tsx":(n,a,e)=>{e.r(a),e.d(a,{VillageModel:()=>l});var t=e("./src/core/Api.tsx"),i=e("./src/core/Model.tsx");class l extends i.Model{static init(){return null==l.instance?async function(){return l.instance=new l,await l.instance.loadVillages(),l.instance}():l.instance}async loadVillages(){this.items=await(0,t.getAllVillages)()}}l.instance=null},"./src/core/xml2json.ts":(n,a,e)=>{function t(n,a){var e={toObj:function(n){var a={};if(1==n.nodeType){if(n.attributes.length)for(var t=0;t<n.attributes.length;t++)a["@"+n.attributes[t].nodeName]=(n.attributes[t].nodeValue||"").toString();if(n.firstChild){for(var i=0,l=0,o=!1,s=n.firstChild;s;s=s.nextSibling)1==s.nodeType?o=!0:3==s.nodeType&&s.nodeValue.match(/[^ \f\n\r\t\v]/)?i++:4==s.nodeType&&l++;if(o)if(i<2&&l<2)for(e.removeWhite(n),s=n.firstChild;s;s=s.nextSibling)3==s.nodeType?a["#text"]=e.escape(s.nodeValue):4==s.nodeType?a["#cdata"]=e.escape(s.nodeValue):a[s.nodeName]?a[s.nodeName]instanceof Array?a[s.nodeName][a[s.nodeName].length]=e.toObj(s):a[s.nodeName]=[a[s.nodeName],e.toObj(s)]:a[s.nodeName]=e.toObj(s);else n.attributes.length?a["#text"]=e.escape(e.innerXml(n)):a=e.escape(e.innerXml(n));else if(i)n.attributes.length?a["#text"]=e.escape(e.innerXml(n)):a=e.escape(e.innerXml(n));else if(l)if(l>1)a=e.escape(e.innerXml(n));else for(s=n.firstChild;s;s=s.nextSibling)a["#cdata"]=e.escape(s.nodeValue)}n.attributes.length||n.firstChild||(a=null)}else 9==n.nodeType?a=e.toObj(n.documentElement):alert("unhandled node type: "+n.nodeType);return a},toJson:function(n,a,t){var i=a?'"'+a+'"':"";if(n instanceof Array){for(var l=0,o=n.length;l<o;l++)n[l]=e.toJson(n[l],"",t+"\t");i+=(a?":[":"[")+(n.length>1?"\n"+t+"\t"+n.join(",\n"+t+"\t")+"\n"+t:n.join(""))+"]"}else if(null==n)i+=(a&&":")+"null";else if("object"==typeof n){var s=[];for(var r in n)s[s.length]=e.toJson(n[r],r,t+"\t");i+=(a?":{":"{")+(s.length>1?"\n"+t+"\t"+s.join(",\n"+t+"\t")+"\n"+t:s.join(""))+"}"}else i+="string"==typeof n?(a&&":")+'"'+n.toString()+'"':(a&&":")+n.toString();return i},innerXml:function(n){var a="";if("innerHTML"in n)a=n.innerHTML;else for(var e=function(n){var a="";if(1==n.nodeType){a+="<"+n.nodeName;for(var t=0;t<n.attributes.length;t++)a+=" "+n.attributes[t].nodeName+'="'+(n.attributes[t].nodeValue||"").toString()+'"';if(n.firstChild){a+=">";for(var i=n.firstChild;i;i=i.nextSibling)a+=e(i);a+="</"+n.nodeName+">"}else a+="/>"}else 3==n.nodeType?a+=n.nodeValue:4==n.nodeType&&(a+="<![CDATA["+n.nodeValue+"]]>");return a},t=n.firstChild;t;t=t.nextSibling)a+=e(t);return a},escape:function(n){return n.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(n){n.normalize();for(var a=n.firstChild;a;)if(3==a.nodeType)if(a.nodeValue.match(/[^ \f\n\r\t\v]/))a=a.nextSibling;else{var t=a.nextSibling;n.removeChild(a),a=t}else 1==a.nodeType?(e.removeWhite(a),a=a.nextSibling):a=a.nextSibling;return n}};9==n.nodeType&&(n=n.documentElement);var t=e.toJson(e.toObj(e.removeWhite(n)),n.nodeName,"\t");return"{\n"+a+(a?t.replace(/\t/g,a):t.replace(/\t|\n/g,""))+"\n}"}e.r(a),e.d(a,{xml2json:()=>t})},"./src/view/launchDialog.tsx":(n,a,e)=>{e.r(a),e.d(a,{launchDialog:()=>l});var t=e("./src/core/Api.tsx"),i=e("./src/view/mainWindow.tsx");const l=n=>(console.log(n),`\n        <style>\n            .launch-dialog{\n                display:grid;\n                text-align:center;\n            }\n            .launch-dialog option {\n                font-size:16px;\n                padding:2px 5px;\n                text-align:center;\n            }\n\n            .launch-dialog button{\n                margin: 10px auto;\n                width: max-content;\n            }\n\n            .launch-dialog-selector{\n                display:grid;\n            }\n\n            .new-plan{\n                display:none;\n            }\n\n            .steps{\n                width:100%;\n                display:inline-flex;\n                justify-content: space-evenly;\n                width: 100%;\n                padding: 10px 0;\n            }\n\n            .step{\n                display:grid;\n            }\n\n            .circle{\n                border-radius:50%;\n                background: linear-gradient(to bottom, #947a62 0%,#7b5c3d 22%,#6c4824 30%,#6c4824 100%);\n                color:white;\n                padding: 4px 10px;\n                font-size: 20px;\n                cursor:pointer;\n            }\n\n            .inactive{\n                background: linear-gradient(to bottom, #947a6266 0%,#7b5c3d69 22%,#6c48245e 30%,#6c482480 100%) !important\n            }\n        </style>\n        <div id="dialog-loading" style="display: none;justify-content: center;width: 100%;">\n            <img style="height:25px" src="https://dshu.innogamescdn.com/asset/6389cdba/graphic/loading.gif"><span style="padding:5px">Betöltés...</span>\n        </div>\n        <div class="launch-dialog">\n            <div><h1>TW Attack Planner</h1></div>\n            <div class="launch-dialog-selector">\n                <h3>Plans:</h3>\n                <select id="launchDialogSelect" size="5">\n                    ${n.map((n=>(console.log(n),`<option value="${n.id}">${n.name}</option>`)))}\n                </select>\n                <button onclick="launchDialog.loadPlan()" class="btn">Load Plan</button>\n                <button onclick="launchDialog.removePlan()" class="btn">Remove Plan</button>\n\n                <button onclick="launchDialog.newplan()" class="btn">+ New Plan</button>\n            </div>\n\n            <div class="new-plan">\n                <div class="steps">\n                    <div id="c1" onclick="launchDialog.goToStep(1)" class="circle">1</div>\n                    <div id="c2" class="circle inactive">2</div>\n                    <div id="c3" class="circle inactive">3</div>\n                    <div id="c4" class="circle inactive">4</div>\n                </div>\n                <div class="step-1 step">\n                    <label for="template_name">Template name:</label><br>\n                    <input onkeyup="launchDialog.step1Check()" id="template_name" type="text"/>\n                </div>\n                <div class="step-2 step" style="display:none;">\n                    <label for="">Targets:</label><br>\n                    <textarea onkeyup="launchDialog.step2Check()" id="plan_targets" size="10"></textarea>\n                </div>\n                <div class="step-3 step" style="display:none;">\n                    <label for="">Arrivals:</label><br>\n                    <select id="plan_arrivals_select" size="5">\n                    </select>\n                    <input id="plan_arrivals_input" type="datetime-local" type="text"/>\n                    <div>\n                        <button onclick="launchDialog.addArrival()" >add</button>\n                        <button onclick="launchDialog.removeArrival()">remove</button>\n                    </div>\n                </div>\n                <div class="step-4 step" style="display:none;">\n                    <label for="template_select">Templates:</label>\n                    <select onclick="launchDialog.selectTemplate()" id="template_select" size="5"></select>\n                    <label for="temp_name">name:</label>\n                    <input id="temp_name" type="text" />\n                    <label >units:</label>\n                    <table>\n                        <tbody>\n                            <tr>\n                                <td valign="top">\n                                    <table class="vis" width="100%">\n                                            <tbody>\n                                                <tr>\n                                                    <th>Gyalogság</th>\n                                                </tr>\n                                                <tr>\n                                                    <td class="nowrap">\n                                                    <img\n                                                        src="https://dshu.innogamescdn.com/asset/5b5eb006/graphic/unit/unit_spear.png"\n                                                        class="" data-title="Lándzsás">\n                                                        <input value="0" style="width:60px" id="unit_input_spear" type="number" min="0">\n                                                    </td>\n                                                </tr>\n                                                <tr>\n                                                    <td class="nowrap">\n                                                    <img\n                                                        src="https://dshu.innogamescdn.com/asset/5b5eb006/graphic/unit/unit_sword.png"\n                                                        class="" data-title="Lándzsás">\n                                                        <input value="0" style="width:60px" id="unit_input_sword" type="number" min="0">\n                                                    </td>\n                                                </tr> \n                                                <tr>\n                                                    <td class="nowrap">\n                                                    <img\n                                                        src="https://dshu.innogamescdn.com/asset/5b5eb006/graphic/unit/unit_axe.png"\n                                                        class="" data-title="Lándzsás">\n                                                        <input value="0" style="width:60px" id="unit_input_axe" type="number" min="0">\n                                                    </td>\n                                                </tr> \n                                                <tr>\n                                                    <td class="nowrap">\n                                                    <img\n                                                        src="https://dshu.innogamescdn.com/asset/5b5eb006/graphic/unit/unit_archer.png"\n                                                        class="" data-title="Lándzsás">\n                                                        <input value="0" style="width:60px" id="unit_input_archer" type="number" min="0">\n                                                    </td>\n                                                </tr> \n                                            </tbody>\n                                    </table>\n                                </td>\n                                <td valign="top">\n                                    <table class="vis" width="100%">\n                                            <tbody>\n                                                <tr>\n                                                    <th>Lovasság</th>\n                                                </tr>\n                                                <tr>\n                                                    <td class="nowrap">\n                                                    <img\n                                                        src="https://dshu.innogamescdn.com/asset/5b5eb006/graphic/unit/unit_spy.png"\n                                                        class="" data-title="Lándzsás">\n                                                        <input value="0" style="width:60px" id="unit_input_spy" type="number" min="0">\n                                                    </td>\n                                                </tr>\n                                                <tr>\n                                                    <td class="nowrap">\n                                                    <img\n                                                        src="https://dshu.innogamescdn.com/asset/5b5eb006/graphic/unit/unit_light.png"\n                                                        class="" data-title="Lándzsás">\n                                                        <input value="0" style="width:60px" id="unit_input_light" type="number" min="0">\n                                                    </td>\n                                                </tr> \n                                                <tr>\n                                                    <td class="nowrap">\n                                                    <img\n                                                        src="https://dshu.innogamescdn.com/asset/5b5eb006/graphic/unit/unit_marcher.png"\n                                                        class="" data-title="Lándzsás">\n                                                        <input value="0" style="width:60px" id="unit_input_marcher" type="number" min="0">\n                                                    </td>\n                                                </tr> \n                                                <tr>\n                                                    <td class="nowrap">\n                                                    <img\n                                                        src="https://dshu.innogamescdn.com/asset/5b5eb006/graphic/unit/unit_heavy.png"\n                                                        class="" data-title="Lándzsás">\n                                                        <input value="0" style="width:60px" id="unit_input_heavy" type="number" min="0">\n                                                    </td>\n                                                </tr> \n                                            </tbody>\n                                    </table>\n                                </td>\n                            <tr>\n                            <tr>\n                                <td valign="top">\n                                    <table class="vis" width="100%">\n                                            <tbody>\n                                                <tr>\n                                                    <th>Hadászat</th>\n                                                </tr>\n                                                <tr>\n                                                    <td class="nowrap">\n                                                    <img\n                                                        src="https://dshu.innogamescdn.com/asset/5b5eb006/graphic/unit/unit_ram.png"\n                                                        class="" data-title="Lándzsás">\n                                                        <input value="0" style="width:60px" id="unit_input_ram" type="number" min="0">\n                                                    </td>\n                                                </tr>\n                                                <tr>\n                                                    <td class="nowrap">\n                                                    <img\n                                                        src="https://dshu.innogamescdn.com/asset/5b5eb006/graphic/unit/unit_catapult.png"\n                                                        class="" data-title="Lándzsás">\n                                                        <input value="0" style="width:60px" id="unit_input_catapult" type="number" min="0">\n                                                    </td>\n                                                </tr> \n                                            </tbody>\n                                    </table>\n                                </td>\n                                <td valign="top">\n                                    <table class="vis" width="100%">\n                                            <tbody>\n                                                <tr>\n                                                    <th>Egyéb</th>\n                                                </tr>\n                                                <tr>\n                                                    <td class="nowrap">\n                                                    <img\n                                                        src="https://dshu.innogamescdn.com/asset/5b5eb006/graphic/unit/unit_knight.png"\n                                                        class="" data-title="Lándzsás">\n                                                        <input value="0" style="width:60px" id="unit_input_knight" type="number" min="0">\n                                                    </td>\n                                                </tr>\n                                                <tr>\n                                                    <td class="nowrap">\n                                                    <img\n                                                        src="https://dshu.innogamescdn.com/asset/5b5eb006/graphic/unit/unit_snob.png"\n                                                        class="" data-title="Lándzsás">\n                                                        <input value="0" style="width:60px" id="unit_input_snob" type="number" min="0">\n                                                    </td>\n                                                </tr> \n                                            </tbody>\n                                    </table>\n                                </td>\n                            </tr>\n                        <tbody>\n                    </table>\n                    <div>\n                        <button onclick="launchDialog.addTemplate()">add</button>\n                        <button onclick="launchDialog.removeTemplate()">remove</button>\n                    </div>\n                </div>\n                <button id="nextBtn" onclick="launchDialog.goNext(2)" class="btn" disabled>Next</button>\n                <button style="display:none;" id="createPlan" onclick="launchDialog.createPlan()" class="btn" disabled>Create Plan</button>\n                <button onclick="launchDialog.cancelNewPlan()" class="btn">Cancel</button>\n            </div>\n        </div>\n    `);window.launchDialog={step1Check:()=>{let n=$("#template_name").val().toString();n.length>3&&null==(0,t.findPlan)((a=>a.name==n))?($("#nextBtn").prop("disabled",!1),window.launchDialog.plan.name=n):$("#nextBtn").prop("disabled",!0)},step2Check:()=>{let n=$("#plan_targets").val().toString();console.log(n),window.launchDialog.plan.targetPool=[];let a=Array.from(n.matchAll(/([0-9]{1,3}).([0-9]{1,3})/g));console.log(a),a.forEach((n=>{let a=n[1]+"|"+n[2],e=window.Villages.find((n=>n.coord.text==a));console.log(a,e),e&&window.launchDialog.plan.targetPool.push({booster:0,launchers:[],village:e})})),window.launchDialog.plan.targetPool.length>0?$("#nextBtn").prop("disabled",!1):$("#nextBtn").prop("disabled",!0)},step3Check:()=>{window.launchDialog.plan.arrivals.length>0?$("#nextBtn").prop("disabled",!1):$("#nextBtn").prop("disabled",!0)},step4Check:()=>{window.launchDialog.plan.templates.length>0?$("#createPlan").prop("disabled",!1):$("#createPlan").prop("disabled",!0)},goToStep:n=>{$(".step-1").hide(),$(".step-2").hide(),$(".step-3").hide(),$(".step-4").hide(),$(".step-"+n).show(),n<4?($("#nextBtn").attr("onclick","launchDialog.goNext("+(n+1)+")"),$("#createPlan").hide(),$("#nextBtn").show()):($("#createPlan").show(),$("#nextBtn").hide())},goNext:n=>{console.log(n,n>=4),$(".step-1").hide(),$(".step-2").hide(),$(".step-3").hide(),$(".step-4").hide(),$("#c"+n).attr("onclick","launchDialog.goToStep("+n+")"),n>3?($(".step-4").show(),$("#nextBtn").hide(),$("#createPlan").show(),$("#c"+n).removeClass("inactive")):($("#nextBtn").prop("disabled",!0),$(".step-"+n).show(),$("#c"+n).removeClass("inactive"),n++,$("#nextBtn").attr("onclick","launchDialog.goNext("+n+")"))},newplan:()=>{$(".new-plan").show(),$(".launch-dialog-selector").hide(),window.launchDialog.plan={arrivals:[],boosters:[],launchPool:[],id:(new Date).getTime().toString(),name:"",targetPool:[],templates:[]}},cancelNewPlan:()=>{$(".step-1").show(),$(".step-2").hide(),$(".step-3").hide(),$(".step-4").hide(),$("#nextBtn").attr("onclick","launchDialog.goNext(2)"),$(".new-plan").hide(),$(".launch-dialog-selector").show(),$("#c2").addClass("inactive"),$("#c3").addClass("inactive"),$("#c4").addClass("inactive"),$("#createPlan").hide(),$("#nextBtn").show(),$("#template_name").val(""),$("#c2").attr("onclick",""),$("#c3").attr("onclick",""),$("#c4").attr("onclick",""),$("#plan_arrivals_select").html(""),$("#plan_targets").val(""),$("#template_select").html(""),$("#temp_name").val(""),$("#unit_input_spear").val("0"),$("#unit_input_sword").val("0"),$("#unit_input_archer").val("0"),$("#unit_input_axe").val("0"),$("#unit_input_spy").val("0"),$("#unit_input_light").val("0"),$("#unit_input_marcher").val("0"),$("#unit_input_heavy").val("0"),$("#unit_input_ram").val("0"),$("#unit_input_catapult").val("0"),$("#unit_input_knight").val("0"),$("#unit_input_snob").val("0")},createPlan:()=>{window.launchDialog.plan.launchPool=window.LaunchVillages.get(),window.attackPlan=window.launchDialog.plan,(0,t.addPlan)(window.attackPlan)?window.UI.SuccessMessage("Plan successfully created!"):window.UI.SuccessMessage("Plan with this name already exist!"),$("#dialog-loading").css("display","inline-flex"),$(".launch-dialog").hide(),setTimeout((()=>{window.Dialog.show("PlannerMainWindow",(0,i.mainWindow)()),$(".popup_box_container").append('<div style="position: fixed;width: 100%;height: 100%;top:0;left:0;z-index:12001"></div>')}),1e3)},addArrival:()=>{let n=$("#plan_arrivals_input").val().toString().replace("T"," ");if(console.log(n),""==n)return;window.launchDialog.plan.arrivals.includes(n)||window.launchDialog.plan.arrivals.push(n);let a="";window.launchDialog.plan.arrivals.forEach((n=>{a+=`<option value="${n}">${n}</option>`})),$("#plan_arrivals_select").html(a),window.launchDialog.step3Check()},removeArrival:()=>{let n=$("#plan_arrivals_select").val().toString().replace("T"," ");if(console.log(n),""==n)return;let a=window.launchDialog.plan.arrivals.findIndex((a=>a==n));a>-1&&window.launchDialog.plan.arrivals.splice(a,1);let e="";window.launchDialog.plan.arrivals.forEach((n=>{e+=`<option value="${n}">${n}</option>`})),$("#plan_arrivals_select").html(e),window.launchDialog.step3Check()},addTemplate:()=>{let n={name:$("#temp_name").val().toString(),units:{spear:parseInt($("#unit_input_spear").val().toString()),sword:parseInt($("#unit_input_sword").val().toString()),archer:parseInt($("#unit_input_archer").val().toString()),axe:parseInt($("#unit_input_axe").val().toString()),spy:parseInt($("#unit_input_spy").val().toString()),light:parseInt($("#unit_input_light").val().toString()),marcher:parseInt($("#unit_input_marcher").val().toString()),heavy:parseInt($("#unit_input_heavy").val().toString()),ram:parseInt($("#unit_input_ram").val().toString()),catapult:parseInt($("#unit_input_catapult").val().toString()),knight:parseInt($("#unit_input_knight").val().toString()),snob:parseInt($("#unit_input_snob").val().toString())}};if(console.log(n),""==n.name)return;let a=window.launchDialog.plan.templates.findIndex((a=>a.name==n.name));a>-1?window.launchDialog.plan.templates[a]=n:window.launchDialog.plan.templates.push(n),$("#temp_name").val(""),$("#unit_input_spear").val("0"),$("#unit_input_sword").val("0"),$("#unit_input_archer").val("0"),$("#unit_input_axe").val("0"),$("#unit_input_spy").val("0"),$("#unit_input_light").val("0"),$("#unit_input_marcher").val("0"),$("#unit_input_heavy").val("0"),$("#unit_input_ram").val("0"),$("#unit_input_catapult").val("0"),$("#unit_input_knight").val("0"),$("#unit_input_snob").val("0");let e="";window.launchDialog.plan.templates.forEach((n=>{e+=`<option value="${n.name}">${n.name}</option>`})),$("#template_select").html(e),window.launchDialog.step4Check()},removeTemplate:()=>{let n=$("#template_select").val(),a=window.launchDialog.plan.templates.findIndex((a=>a.name==n));a>-1&&window.launchDialog.plan.templates.splice(a,1);let e="";window.launchDialog.plan.templates.forEach((n=>{e+=`<option value="${n.name}">${n.name}</option>`})),$("#template_select").html(e),window.launchDialog.step4Check()},selectTemplate:()=>{let n=$("#template_select").val(),a=window.launchDialog.plan.templates.findIndex((a=>a.name==n));if(a>-1){let n=window.launchDialog.plan.templates[a];$("#temp_name").val(n.name),$("#unit_input_spear").val(n.units.spear),$("#unit_input_sword").val(n.units.sword),$("#unit_input_archer").val(n.units.archer),$("#unit_input_axe").val(n.units.axe),$("#unit_input_spy").val(n.units.spy),$("#unit_input_light").val(n.units.light),$("#unit_input_marcher").val(n.units.marcher),$("#unit_input_heavy").val(n.units.heavy),$("#unit_input_ram").val(n.units.ram),$("#unit_input_catapult").val(n.units.catapult),$("#unit_input_knight").val(n.units.knight),$("#unit_input_snob").val(n.units.snob)}},loadPlan:()=>{let n=$("#launchDialogSelect").val().toString();""!=n&&($("#dialog-loading").css("display","inline-flex"),$(".launch-dialog").hide(),setTimeout((()=>{window.attackPlan=(0,t.findPlan)((a=>a.id==n)),window.Dialog.show("PlannerMainWindow",(0,i.mainWindow)()),$(".popup_box_container").append('<div style="position: fixed;width: 100%;height: 100%;top:0;left:0;z-index:12001"></div>')}),1e3))},removePlan:()=>{let n=$("#launchDialogSelect").val().toString();if(""==n)return;(0,t.removePlan)(n);let a=(0,t.loadPlans)();$("#launchDialogSelect").html(`${a.map((n=>`<option value="${n.id}">${n.name}</option>`))}`)},plan:void 0}},"./src/view/launchItem.tsx":(n,a,e)=>{e.r(a),e.d(a,{launchItem:()=>t});const t=n=>{let a=document.createElement("div");a.className="launch-item";let e=document.createElement("div");e.className="name-field",e.innerText=`${n.name} (${n.coord.text})`,a.appendChild(e);let t=document.createElement("input");t.value=`${n.id}`,t.type="checkbox";let i=document.createElement("img"),l="small";n.popSize>1e3&&n.popSize<=5e3?l="medium":n.popSize>5e3&&(l="large"),i.src=`https://dshu.innogamescdn.com/asset/72737c96/graphic/command/attack_${l}.png`;let o=document.createElement("div");o.className="check-field",o.appendChild(t),o.appendChild(i),a.appendChild(o);let s=Object.keys(n.unitsContain);for(let e=0;e<s.length;e++){const t=s[e];if(0==window.gameConfig.game.archer&&("archer"==t||"marcher"==t))continue;let i=document.createElement("div");i.className=`${t}-field ${0==n.unitsContain[t]?"hidden":""}`,i.innerText=`${n.unitsContain[t]}`,a.appendChild(i)}return a}},"./src/view/mainWindow.tsx":(n,a,e)=>{e.r(a),e.d(a,{mainWindow:()=>i});var t=e("./src/view/launchItem.tsx");const i=()=>`\n    <style>\n        ::-webkit-scrollbar {\n    width: 5px;\n    }\n    \n    /* Track */\n    ::-webkit-scrollbar-track {\n        box-shadow: inset 0 0 5px grey;\n        border-radius: 10px;\n    }\n    \n    /* Handle */\n    ::-webkit-scrollbar-thumb {\n        background: grey;\n        border-radius: 10px;\n    }\n\n        .mainWindow{\n            width: 100%;\n            height:85vh;\n        }\n        .popup_box_container{\n            height:100% !important;\n        }\n        #popup_box_PlannerMainWindow{\n            width: 95vw !important;\n        }\n        html{\n            overflow: hidden !important;\n        }\n        .container {\n            height: calc(100% - 10px);\n            border: solid 2px #6c4824;\n            border-radius:20px;\n            display: grid;\n            grid-template-columns: 0.5fr 1.3fr 1.3fr;\n            grid-template-rows: 26px 3fr [option] 0.1fr;\n            gap: 0px 0px;\n            grid-auto-flow: row;\n        }\n\n        .options-title { \n            grid-area: 1 / 1 / 2 / 2; \n            border-top-left-radius: 20px;\n            border-right: solid 2px #6c4824;\n            border-bottom: solid 2px #6c4824;\n        }\n\n        .options-panel {\n            border-right: solid 2px #6c4824;\n            display: table;\n        }\n\n        .target-title { \n            grid-area: 1 / 2 / 2 / 3; \n            border-right: solid 1px #6c4824;\n            border-bottom: solid 2px #6c4824;\n        }\n\n        .target-panel { \n            grid-area: 2 / 2 / 4 / 3; \n            border-right: solid 1px #6c4824;\n\n            display: grid; \n            grid-template-columns: 1fr; \n            grid-template-rows: 30px 1fr; \n            gap: 0px 0px; \n            grid-template-areas: \n                "launch-header"\n                "launch-list";\n        }\n\n        .traget-header {\n            grid-area: traget-header; \n        }\n        .target-list { grid-area: target-list; }\n\n        .launch-title { \n            grid-area: 1 / 3 / 2 / 4;\n            border-top-right-radius: 20px;\n            border-left: solid 1px #6c4824;\n            border-bottom: solid 2px #6c4824;\n            display: flex;\n            flex-wrap: nowrap;\n            justify-content: space-evenly;\n            align-items: flex-start;\n            align-content: flex-start;\n            flex-direction: row;\n        }\n\n        .launch-panel { \n            grid-area: 2 / 3 / 4 / 4; \n            border-left: solid 1px #6c4824;\n            display: grid; \n            grid-template-columns: 1fr; \n            grid-template-rows: 30px 1fr; \n            gap: 0px 0px; \n            grid-template-areas: \n                "launch-header"\n                "launch-list"; \n        }\n\n        .launch-list {\n            overflow-y:scroll;\n            border-bottom-right-radius: 20px;\n            grid-area: launch-list; \n            display: grid;\n        }\n        .launch-header { \n            padding-right:5px;\n            background: linear-gradient(to bottom,#e2c07c 0%,#dab874 44%,#c1a264 100%);\n            grid-area: launch-header;\n            display: grid;\n            grid-template-columns:  1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr; \n            grid-template-rows: 30px;\n            gap: 0px;\n            grid-template-areas: \n                "size-icon spear-icon sword-icon axe-icon archer-icon spy-icon light-icon marcher-icon heavy-icon ram-icon catapult-icon pala-icon snob-icon"\n        }\n\n        .launch-filter-bar{\n           \n        }\n\n        .credits { grid-area: option / 1 / 4 / 2; border-right: solid 2px #6c4824; padding:10px;}\n\n        .header {\n            background: linear-gradient(to bottom,#e2c07c 0%,#dab874 44%,#c1a264 100%);\n            text-align: center;\n            padding:3px;\n        }\n\n        .launch-header div{\n            padding: 5px;\n        }\n        .launch-header img{\n            margin: 0 auto;\n            display: block;\n            cursor: pointer;\n        }\n\n        .size-icon { grid-area: size-icon; }\n        .spear-icon { grid-area: spear-icon; }\n        .sword-icon { grid-area: sword-icon; }\n        .axe-icon { grid-area: axe-icon; }\n        .archer-icon { grid-area: archer-icon; }\n        .spy-icon { grid-area: spy-icon; }\n        .light-icon { grid-area: light-icon; }\n        .marcher-icon { grid-area: marcher-icon; }\n        .heavy-icon { grid-area: heavy-icon; }\n        .ram-icon { grid-area: ram-icon; }\n        .catapult-icon { grid-area: catapult-icon; }\n        .pala-icon { grid-area: pala-icon; }\n        .snob-icon { grid-area: snob-icon; }\n\n        .option-item{\n            width:100%;\n            margin: 15px 0;\n        }\n        .option-item button{\n            height: 30px;\n            margin: 0 auto;\n            display: block;\n            min-width: 85%;\n        }\n        .option-item h2{\n            text-align:center;\n        }\n    </style>\n     <style>\n            .launch-item{\n            height: max-content;\n            border-top: solid 1px #6c4824;\n            border-bottom: solid 1px #6c4824;\n            margin-top:3px;\n            text-align:center;\n            display: grid; \n            grid-template-columns:  1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr;;\n            grid-template-rows: 30px 30px ;\n            gap: 0px 0px; \n            grid-template-areas:\n                "check-field name-field name-field name-field ${1==window.gameConfig.game.archer&&"name-field"} name-field name-field ${1==window.gameConfig.game.archer&&"name-field"} name-field name-field name-field name-field name-field"\n                "check-field spear-field sword-field axe-field ${1==window.gameConfig.game.archer&&"archer-field"} spy-field light-field ${1==window.gameConfig.game.archer&&"marcher-field"}  heavy-field ram-field catapult-field knight-field snob-field";\n            }\n\n            .check-field input{\n                height:16px;\n                width:16px;\n                float:left;\n            }\n\n            .check-field img{\n                height: 16px;\n                float:right;\n                padding-right:3px;\n            }\n\n            .check-field { grid-area: check-field; padding: 20px 0; background-color:#fff5dc; border-right:1px solid #6c4824}\n            .spear-field { grid-area: spear-field; padding: 5px 0;background-color:#fff5dc}\n            .sword-field { grid-area: sword-field; padding: 5px 0;background-color:#fff5dc}\n            .axe-field { grid-area: axe-field; padding: 5px 0;background-color:#fff5dc}\n            .archer-field { grid-area: archer-field; padding: 5px 0;background-color:#fff5dc}\n            .spy-field { grid-area: spy-field; padding: 5px 0;background-color:#fff5dc}\n            .light-field { grid-area: light-field; padding: 5px 0;background-color:#fff5dc}\n            .marcher-field { grid-area: marcher-field; padding: 5px 0;background-color:#fff5dc}\n            .heavy-field { grid-area: heavy-field; padding: 5px 0;background-color:#fff5dc}\n            .ram-field { grid-area: ram-field; padding: 5px 0;background-color:#fff5dc}\n            .catapult-field { grid-area: catapult-field; padding: 5px 0;background-color:#fff5dc}\n            .knight-field { grid-area: knight-field; padding: 5px 0;background-color:#fff5dc}\n            .snob-field { grid-area: snob-field; padding: 5px 0;background-color:#fff5dc}\n            .name-field { \n                grid-area: name-field;\n                color: #603000;\n                font-weight: bold;\n                background-color:#ecd8b2;\n                padding: 5px 0;\n            }\n        </style>\n    <div class="mainWindow">\n        <div class="container">\n            <div class="options-title header">\n                <h3>Options</h3>\n            </div>\n            <div class="options-panel">\n                <div class="option-item">\n                    <h2>${window.attackPlan.name}</h2>\n                </div>\n                <div class="option-item">\n                    <button class="btn">Add targets</button>\n                </div>\n                <div class="option-item">\n                    <button class="btn">Edit arrivals</button>\n                </div>\n                <div class="option-item">\n                    <button class="btn">Edit Templates</button>\n                </div>\n                <div class="option-item">\n                    <button class="btn">Edit player buffs</button>\n                </div>\n                <div class="option-item">\n                    <button class="btn">Auto assigner</button>\n                </div>\n                <div class="option-item">\n                    <button class="btn">Calculate</button>\n                </div>\n                <div class="option-item">\n                    <button class="btn">Reset assignments</button>\n                </div>\n            </div>\n            <div class="target-title header">\n                <h3>Targets</h3>\n            </div>\n            <div class="target-panel">\n                <div class="traget-header">\n                </div>\n                <div class="target-list">\n                </div>\n            </div>\n            <div class="launch-title header">\n                <div class="launch-filter-bar">\n                    <button onclick="window.oderLaunchVillages('coord')" class="btn">XY</button>\n                    <button onclick="window.oderLaunchVillages('name')" class="btn">Name</button>\n                    \n                </div>\n                <h3>Launch villages</h3>\n                <div class="launch-filter-bar">\n                    <button onclick="window.oderLaunchVillages('size')" class="btn">Size</button>\n                    <button onclick="window.oderLaunchVillages('reset')" class="btn">Reset</button>\n                </div>\n            </div>\n            <div class="launch-panel">\n                <div class="launch-header">\n                    <div class="size-icon">\n                        <button class="btn"><---</button>\n                    </div>\n                    <div class="spear-icon">\n                        <img onclick="window.oderLaunchVillages('spear')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_spear.png">\n                    </div>\n                    <div class="sword-icon">\n                        <img onclick="window.oderLaunchVillages('sword')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_sword.png">\n                    </div>\n                    <div class="axe-icon">\n                        <img onclick="window.oderLaunchVillages('axe')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_axe.png">\n                    </div>\n                    ${1==window.gameConfig.game.archer&&'<div class="archer-icon">\n                        <img onclick="window.oderLaunchVillages(\'archer\')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_archer.png">\n                    </div>'}\n                    <div class="spy-icon">\n                        <img onclick="window.oderLaunchVillages('spy')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_spy.png">\n                    </div>\n                    <div class="light-icon">\n                        <img onclick="window.oderLaunchVillages('light')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_light.png">\n                    </div>\n                    ${1==window.gameConfig.game.archer&&'<div class="marcher-icon">\n                            <img onclick="window.oderLaunchVillages(\'marcher\')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_marcher.png">\n                        </div>'}\n                    <div class="heavy-icon">\n                        <img onclick="window.oderLaunchVillages('heavy')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_heavy.png">\n                    </div>\n                    <div class="ram-icon">\n                        <img onclick="window.oderLaunchVillages('ram')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_ram.png">\n                    </div>\n                    <div class="catapult-icon">\n                        <img onclick="window.oderLaunchVillages('catapult')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_catapult.png">\n                    </div>\n                    <div class="pala-icon">\n                        <img onclick="window.oderLaunchVillages('pala')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_knight.png">\n                    </div>\n                    <div class="snob-icon">\n                        <img onclick="window.oderLaunchVillages('snob')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_snob.png">\n                    </div>\n                </div>\n                <div class="launch-list">\n                </div>\n            </div>\n            <div class="credits">\n                v0.1.0-alpha; by: toldi26\n            </div>\n        </div>\n    </div>\n    <script>\n        window.mainInit();\n    <\/script>\n    `;var l;window.mainInit=()=>{window.launchVillagesStep=25,window.launchVillagesPaging=0,window.launchVillagesWay=1,window.launchVillagesOrder="name",window.renderLaunchVillages()},window.oderLaunchVillages=n=>{n==window.launchVillagesOrder&&(window.launchVillagesWay*=-1),window.launchVillagesOrder=n,clearTimeout(l),l=setTimeout((()=>{let a=null;switch(n){case"name":a=(n,a)=>n.name<a.name?-1*window.launchVillagesWay:1*window.launchVillagesWay;break;case"coord":a=(n,a)=>n.coord.text<a.coord.text?-1*window.launchVillagesWay:1*window.launchVillagesWay;break;case"size":a=(n,a)=>n.popSize>a.popSize?-1*window.launchVillagesWay:1*window.launchVillagesWay;break;case"spear":a=(n,a)=>n.unitsContain.spear>a.unitsContain.spear?-1*window.launchVillagesWay:1*window.launchVillagesWay;break;case"sword":a=(n,a)=>n.unitsContain.sword>a.unitsContain.sword?-1*window.launchVillagesWay:1*window.launchVillagesWay;break;case"axe":a=(n,a)=>n.unitsContain.axe>a.unitsContain.axe?-1*window.launchVillagesWay:1*window.launchVillagesWay;break;case"archer":a=(n,a)=>n.unitsContain.archer>a.unitsContain.archer?-1*window.launchVillagesWay:1*window.launchVillagesWay;break;case"light":a=(n,a)=>n.unitsContain.light>a.unitsContain.light?-1*window.launchVillagesWay:1*window.launchVillagesWay;break;case"spy":a=(n,a)=>n.unitsContain.spy>a.unitsContain.spy?-1*window.launchVillagesWay:1*window.launchVillagesWay;break;case"marcher":a=(n,a)=>n.unitsContain.marcher>a.unitsContain.marcher?-1*window.launchVillagesWay:1*window.launchVillagesWay;break;case"heavy":a=(n,a)=>n.unitsContain.heavy>a.unitsContain.heavy?-1*window.launchVillagesWay:1*window.launchVillagesWay;break;case"ram":a=(n,a)=>n.unitsContain.ram>a.unitsContain.ram?-1*window.launchVillagesWay:1*window.launchVillagesWay;break;case"catapult":a=(n,a)=>n.unitsContain.catapult>a.unitsContain.catapult?-1*window.launchVillagesWay:1*window.launchVillagesWay;break;case"snob":a=(n,a)=>n.unitsContain.snob>a.unitsContain.snob?-1*window.launchVillagesWay:1*window.launchVillagesWay;break;case"knight":a=(n,a)=>n.unitsContain.knight>a.unitsContain.knight?-1*window.launchVillagesWay:1*window.launchVillagesWay;break;default:a=(n,a)=>n.name<a.name?-1:1,window.launchVillagesStep=25,window.launchVillagesPaging=0,window.launchVillagesWay=1}window.attackPlan.launchPool.sort(a),$(".launch-list").html(""),$(".launch-list").scrollTop(0),window.launchVillagesPaging=0,window.renderLaunchVillages()}),500)},window.renderLaunchVillages=async()=>{if(window.attackPlan.launchPool.length<window.launchVillagesPaging)return;var n=document.getElementsByClassName("launch-list")[0];console.log(window.launchVillagesPaging,window.launchVillagesPaging+window.launchVillagesStep);let a=window.launchVillagesPaging+window.launchVillagesStep;window.launchVillagesPaging+window.launchVillagesStep>window.attackPlan.launchPool.length&&(a=window.attackPlan.launchPool.length);for(let e=window.launchVillagesPaging;e<a;e++){const a=window.attackPlan.launchPool[e];n.appendChild((0,t.launchItem)(a))}window.launchVillagesPaging+=window.launchVillagesStep,n.addEventListener("scroll",(function(a){let e=!1;n.scrollHeight-100<=n.clientHeight+n.scrollTop&&!e&&(e=!0,window.renderLaunchVillages())}))}}},a={};function e(t){var i=a[t];if(void 0!==i)return i.exports;var l=a[t]={exports:{}};return n[t](l,l.exports,e),l.exports}e.d=(n,a)=>{for(var t in a)e.o(a,t)&&!e.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:a[t]})},e.o=(n,a)=>Object.prototype.hasOwnProperty.call(n,a),e.r=n=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};var t={};(()=>{e.r(t);var n=e("./src/core/Api.tsx"),a=e("./src/core/LaunchVillagesModel.tsx"),i=e("./src/core/PlayersModel.tsx"),l=e("./src/core/VillageModel.tsx"),o=e("./src/view/launchDialog.tsx");(async()=>{window.gameConfig=await(0,n.getServerConifg)(),window.unitConfig=await(0,n.getUnitConfig)(),window.Villages=await l.VillageModel.init(),window.Players=await i.PlayersModel.init(),window.LaunchVillages=await a.LaunchVillagesModel.init(),function(){let a=(0,n.loadPlans)();window.Dialog.show("launchDialog",(0,o.launchDialog)(a)),$(".popup_box_container").append('<div style="position: fixed;width: 100%;height: 100%;top:0;left:0;z-index:12001"></div>')}()})()})()})();