/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var e={"./src/core/Api.ts":(e,n,a)=>{a.r(n),a.d(n,{TroopTransaction:()=>L,calcUnitPop:()=>S,coordDistance:()=>I,fetchGroups:()=>y,formatDate:()=>N,formatDateTime:()=>R,game:()=>o,getAllPlayer:()=>k,getAllVillages:()=>b,getGameConfig:()=>h,getSlowestUnit:()=>M,getUnitConfig:()=>m,hasAvailableTroops:()=>D,loadPages:()=>P,loadScriptOptions:()=>v,loadWorldApi:()=>f,savePlan:()=>z,saveScriptOptions:()=>w,storeName:()=>u});var t=a("./src/core/Language.ts"),i=a("./src/core/xml2json.ts");const l="https://"+window.location.hostname,o=game_data,s="/map/village.txt",r="/map/player.txt",d="/interface.php?func=get_unit_info",c="/interface.php?func=get_config",g="screen=accountmanager",p="screen=overview_villages&mode=combined",u="TW_ATTACK_PLANNER";async function h(){let e=await $.ajax({url:l+c});return(0,i.xml2json)(e,"")}async function m(){let e=await $.ajax({url:l+d});return(0,i.xml2json)(e,"")}function v(){const e=localStorage.getItem(u);return null==e?{latestApiUpdate:0}:JSON.parse(e)}function w(){localStorage.setItem(u,JSON.stringify(window.scriptOptions))}async function f(){let e,n,a=[],t=[];const i=(new Date).getTime()-36e5;if(window.scriptOptions.latestApiUpdate>i)a=await window.DB.getAllData("villages"),t=await window.DB.getAllData("players"),window.gameConfig=window.scriptOptions.gameConfig,window.unitConfig=window.scriptOptions.unitConfig;else{e=await h(),n=await m(),a=await b(),t=await k();for(const e of t)await window.DB.setData("players",e);for(const e of a)await window.DB.setData("villages",e);window.scriptOptions.latestApiUpdate=(new Date).getTime(),window.scriptOptions.gameConfig=e,window.scriptOptions.unitConfig=n,window.gameConfig=e,window.unitConfig=n,w(),window.Villages=a,window.Players=t}}async function b(){let e=await $.ajax({url:l+s});e=e.trim();let n=[],a=e.split("\n");for(let e=0;e<a.length;e++){let t=a[e].split(","),i=parseInt(t[2]),l=parseInt(t[3]);n.push({id:parseInt(t[0]),name:decodeURIComponent(t[1]).replaceAll("+"," "),owner:parseInt(t[4]),kontinent:10*Math.floor(l/100)+Math.floor(i/100),coord:{text:t[2]+"|"+t[3],x:i,y:l},popRemain:null,unitsContain:null,popSize:null})}return n}async function k(){let e=await $.ajax({url:l+r});e=e.trim();let n=[],a=e.split("\n");for(let e=0;e<a.length;e++){let t=a[e].split(",");n.push({id:parseInt(t[0]),name:decodeURIComponent(t[1]).replaceAll("+"," "),allyId:parseInt(t[2]),villageCnt:parseInt(t[3]),pionts:parseInt(t[4]),rank:parseInt(t[5])})}return n}function x(e=1,n=0){return`/game.php?${0!=o.player.sitter?"t="+o.player.id+"&":""}village=${o.village.id}&group=${n}&page=${e}&screen=overview_villages&mode=units`}async function y(){let e=await $.ajax({url:l+`/game.php?${0!=o.player.sitter?"t="+o.player.id+"&":""}village=${o.village.id}& ${window.game_data.features.AccountManager.active?g:p}`}),n=[],a=$(e).find(".group-menu-item").get();return a.length>0?a.forEach((e=>{n.push({id:parseInt($(e).attr("data-group-id")),name:$(e).text().trim().slice(1,-1)})})):$($(e).find("#paged_view_content").find("select").get()[0]).find("option").get().forEach((e=>{if(!$(e).is(":disabled")){let a=new URLSearchParams($(e).attr("value"));console.log(a,$(e).attr("value")),n.push({id:parseInt(a.get("group")),name:$(e).text()})}})),n}async function P(e){let n=[];for(const a of e){const e=await A(x(0,a.id),a.all);n=[...n,...e.villages],await _(200);for(let t=0;t<e.pageCnt;t++){const e=await A(x(t+1,a.id),a.all);n=[...n,...e.villages],await _(200)}}return n}async function _(e){return new Promise((async(n,a)=>{setTimeout((()=>{n()}),e)}))}function A(e,n){return new Promise((async(a,t)=>{let i=await $.ajax({url:e}),l=await async function(e,n){let a=[],t=$(e).find("#units_table");$(t).find("thead th").get().forEach(((e,n)=>{let t=$(e).find("img");if(t.length>0){let e=$(t).attr("src");e.includes("graphic/unit/unit_")&&!e.includes("unit_militia")&&a.push({index:n,name:T(e)})}}));let i=$(t).find("tbody").get(),l=[];for(const e of i){let t=$(e).find("tr").get(),i=$(t[0]).find("td"),o=$(t[3]).find("td"),s=parseInt($(i).find(".quickedit-vn").attr("data-id")),r={spear:0,sword:0,axe:0,archer:0,spy:0,light:0,marcher:0,heavy:0,ram:0,catapult:0,knight:0,snob:0},d=0;a.forEach((e=>{let a=parseInt($(i[e.index]).text()),t=parseInt($(o[e.index-1]).text()),l=n?a+t:a;r[e.name]=l,d+=window.unitConfig[e.name].pop*l}));let c=window.Villages.find((e=>e.id==s)),g=0;c.unitsContain=r,c.popRemain=g,c.popSize=d,l.push(c)}return l}(i,n);a({pageCnt:C(i),villages:l})}))}function C(e){let n=$($(e).find(".paged-nav-item").get()[0]).parent().find("select"),a=0;return a=1==n.length?n.find("option").length-1:$(e).find(".paged-nav-item").length-1,a}function T(e){let n=e.split("/");return n[n.length-1].split(".")[0].replace("unit_","").replace("@2x","")}function L(e,n,a){return Object.keys(a).forEach((t=>{[e[t],n[t]]=function(e,n,a){return a<0&&(a=n+a)<0&&(a=0),n-a<0?(e=n,n=0):(e+=a,n-=a),[e,n]}(e[t],n[t],a[t])})),[e,n]}function S(e){let n=0;return Object.keys(e).forEach((a=>{(0!=window.gameConfig.game.archer||"archer"!=a&&"marcher"!=a)&&(n+=window.unitConfig[a].pop*e[a])})),n}function M(e,n){var a=Object.keys(e).map((e=>{if(0!=window.gameConfig.game.archer||"archer"!=e&&"marcher"!=e)return{key:e,value:window.unitConfig[e].speed}})).sort(((e,n)=>e.value>n.value?-1:1));if(!n&&e.knight>0)return{key:"knight",value:window.unitConfig.knight.speed};for(let n=0;n<a.length;n++)if(e[a[n].key]>0)return a[n]}function I(e,n){return e&&n?Math.sqrt(Math.pow(n.coord.x-e.coord.x,2)+Math.pow(n.coord.y-e.coord.y,2)):null}function D(e,n){let a=Object.keys(n);for(let t=0;t<a.length;t++){const i=a[t];if("snob"==i&&e.unitsContain[i]>0&&0==n[i])return console.log("ide"),!1;if(0!=n[i]){if(n[i]<0&&e.unitsContain[i]+n[i]<0)return!1;if(0==e.unitsContain[i]&&99999==n[i])return!1;if(e.unitsContain[i]<n[i]&&99999!=n[i]&&n[i]>0)return!1}}return!0}async function z(){await window.DB.setData("plans",window.attackPlan)}function R(e){const n=(0,t.getLangFormat)();return new Intl.DateTimeFormat(n,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format(e)}function N(e){const n=(0,t.getLangFormat)();return new Intl.DateTimeFormat(n,{year:"numeric",month:"2-digit",day:"2-digit"}).format(e)}},"./src/core/IndexedDBhandler.ts":(e,n,a)=>{a.r(n),a.d(n,{IndexedDBHandler:()=>t});class t{constructor(e,n,a,t){this.db=e,this.dbName=n,this.stores=a,this.version=t,console.log(`loaded ${this.dbName} DB ðŸš€`)}static async init(e,n,a){return new Promise(((i,l)=>{let o=indexedDB.open(e,a);o.onupgradeneeded=()=>{n.forEach((e=>{o.result.objectStoreNames.contains(e.keyName)||o.result.createObjectStore(e.name,{keyPath:e.keyName,autoIncrement:e.AI})})),o.onsuccess=()=>{i(new t(o.result,e,n,a))}},o.onsuccess=()=>{i(new t(o.result,e,n,a))},o.onerror=()=>{throw console.error("Error",o.error),new Error(o.error.message)}}))}getTransaction(e){let n=this.stores.findIndex((n=>n.name==e));return-1==n?null:(this.stores[n].transaction||this.openTransaction(this.stores[n],e),this.stores[n].isOpen||this.openTransaction(this.stores[n],e),this.stores[n].transaction)}openTransaction(e,n){e.transaction=this.db.transaction(n,"readwrite"),e.isOpen=!0,e.transaction.oncomplete=()=>{e.isOpen=!1},e.transaction.onabort=()=>{e.isOpen=!1},e.transaction.onerror=()=>{e.isOpen=!1},e.transaction.durability}async getAllData(e){return new Promise((async(n,a)=>{if(!this.db.objectStoreNames.contains(e))return void n([]);let t=this.getTransaction(e),i=await t.objectStore(e).getAll();i.onsuccess=()=>{n(i.result)}}))}async getData(e,n){return new Promise((async(a,t)=>{if(!this.db.objectStoreNames.contains(e))return void a(null);let i=this.getTransaction(e),l=await i.objectStore(e).get(n);l.onsuccess=()=>{l.result?a(l.result):a(null)}}))}async setData(e,n){return new Promise((async(a,t)=>{if(!this.db.objectStoreNames.contains(e))return void a(null);let i=this.getTransaction(e),l=await i.objectStore(e).put(n);l.onsuccess=()=>{a(l.result)}}))}async removeData(e,n){return new Promise((async(a,t)=>{if(!this.db.objectStoreNames.contains(e))return void a(null);let i=this.getTransaction(e),l=await i.objectStore(e).delete(n);l.onsuccess=()=>{a(l.result)}}))}async clearStore(e){return new Promise((async(n,a)=>{if(!this.db.objectStoreNames.contains(e))return void n(null);let t=this.getTransaction(e),i=await t.objectStore(e).clear();i.onsuccess=()=>{n(i.result)}}))}}},"./src/core/Language.ts":(e,n,a)=>{a.r(n),a.d(n,{Lang:()=>l,determineLang:()=>s,getLangFormat:()=>o});var t=a("./src/view/language/en.ts"),i=a("./src/view/language/hu.ts");function l(e){let n=i.hu;switch(window.Lang){case"hu":n=i.hu;break;case"en":n=t.en}return n.hasOwnProperty(e)?n[e]:`lang.${window.Lang}.${e}`}function o(){switch(window.Lang){case"hu":return"hu-HU";case"en":return"en-US"}}function s(){const e=navigator.language.split("-")[0];return["hu","en"].includes(e)?e:"en"}},"./src/core/Query.ts":(e,n,a)=>{a.r(n),a.d(n,{Query:()=>t});class t{constructor(e,n,a,t,i){this.objectCopy=[],this.way=1,this.field="",this.from=0,this.to=0,this.draw=50,this.CanScroll=!1,this.searchField=null,this.field=i,this.objectRef=e,this.objectCopy=structuredClone(this.objectRef),this.controlledOrder(this.field,this.way),this.funcRef=t,this.targetHtml=n,this.targetCnt=a;let l=this;n.addEventListener("scroll",(function(e){let a=!1;n.scrollHeight-100<=n.clientHeight+n.scrollTop&&!a&&l.CanScroll&&(a=!0,l.pull())})),addEventListener("wheel",(e=>{l.CanScroll=!0,clearTimeout(l.To),l.To=setTimeout((()=>{l.CanScroll=!1}),500)}))}search(e){this.searchField=e,this.reset(),this.objectCopy=this.objectCopy.filter((e=>`${e.name} (${e.coord.text}) K${e.kontinent}`.includes(this.searchField.value))),this.render()}setDraw(e){this.draw=e}calcPaging(){this.to=this.from+this.draw,this.to>this.objectCopy.length&&(this.to=this.objectCopy.length)}reset(){$(this.targetHtml).html(""),$(this.targetHtml).scrollTop(0),this.objectCopy=structuredClone(this.objectRef),this.controlledOrder(this.field,1),this.from=0,this.to=0}resetAll(){this.reset(),this.render(),this.searchField&&(this.searchField.value="")}controlledOrder(e,n){let a=this;this.objectCopy.sort(((n,t)=>a.getProp(e,n)<a.getProp(e,t)?-1*this.way:1*this.way))}order(e){this.reset(),this.field==e?this.way*=-1:this.way=-1,this.controlledOrder(e,this.way),this.field=e,this.render()}getProp(e,n){let a=e.split(".");return 1==a.length?n[a[0]]:(n=n[a.shift()],this.getProp(a.join("."),n))}pull(){this.from+this.draw>this.objectCopy.length||(this.from+=this.draw,this.to=this.from+this.draw,this.render())}render(){this.calcPaging();for(let e=this.from;e<this.to;e++)$(this.targetHtml).append(this.funcRef(this.objectCopy[e]));$(this.targetCnt).text(this.objectCopy.length)}partialRender(e,n){e.forEach((e=>{$(this.targetHtml).find(`#${this.getProp(n,e)}`).replaceWith(this.funcRef(e))}))}}},"./src/core/xml2json.ts":(e,n,a)=>{function t(e,n){var a={toObj:function(e){var n={};if(1==e.nodeType){if(e.attributes.length)for(var t=0;t<e.attributes.length;t++)n["@"+e.attributes[t].nodeName]=(e.attributes[t].nodeValue||"").toString();if(e.firstChild){for(var i=0,l=0,o=!1,s=e.firstChild;s;s=s.nextSibling)1==s.nodeType?o=!0:3==s.nodeType&&s.nodeValue.match(/[^ \f\n\r\t\v]/)?i++:4==s.nodeType&&l++;if(o)if(i<2&&l<2)for(a.removeWhite(e),s=e.firstChild;s;s=s.nextSibling)3==s.nodeType?n["#text"]=a.escape(s.nodeValue):4==s.nodeType?n["#cdata"]=a.escape(s.nodeValue):n[s.nodeName]?n[s.nodeName]instanceof Array?n[s.nodeName][n[s.nodeName].length]=a.toObj(s):n[s.nodeName]=[n[s.nodeName],a.toObj(s)]:n[s.nodeName]=a.toObj(s);else e.attributes.length?n["#text"]=a.escape(a.innerXml(e)):n=a.escape(a.innerXml(e));else if(i)e.attributes.length?n["#text"]=a.escape(a.innerXml(e)):(n=a.escape(a.innerXml(e)),isNaN(n)||(n=parseFloat(n)));else if(l)if(l>1)n=a.escape(a.innerXml(e));else for(s=e.firstChild;s;s=s.nextSibling)n["#cdata"]=a.escape(s.nodeValue)}e.attributes.length||e.firstChild||(n=null)}else 9==e.nodeType?n=a.toObj(e.documentElement):alert("unhandled node type: "+e.nodeType);return n},toJson:function(e,n,t){var i=n?'"'+n+'"':"";if(e instanceof Array){for(var l=0,o=e.length;l<o;l++)e[l]=a.toJson(e[l],"",t+"\t");i+=(n?":[":"[")+(e.length>1?"\n"+t+"\t"+e.join(",\n"+t+"\t")+"\n"+t:e.join(""))+"]"}else if(null==e)i+=(n&&":")+"null";else if("object"==typeof e){var s=[];for(var r in e)s[s.length]=a.toJson(e[r],r,t+"\t");i+=(n?":{":"{")+(s.length>1?"\n"+t+"\t"+s.join(",\n"+t+"\t")+"\n"+t:s.join(""))+"}"}else i+="string"==typeof e?(n&&":")+'"'+e.toString()+'"':(n&&":")+e.toString();return i},innerXml:function(e){var n="";if("innerHTML"in e)n=e.innerHTML;else for(var a=function(e){var n="";if(1==e.nodeType){n+="<"+e.nodeName;for(var t=0;t<e.attributes.length;t++)n+=" "+e.attributes[t].nodeName+'="'+(e.attributes[t].nodeValue||"").toString()+'"';if(e.firstChild){n+=">";for(var i=e.firstChild;i;i=i.nextSibling)n+=a(i);n+="</"+e.nodeName+">"}else n+="/>"}else 3==e.nodeType?n+=e.nodeValue:4==e.nodeType&&(n+="<![CDATA["+e.nodeValue+"]]>");return n},t=e.firstChild;t;t=t.nextSibling)n+=a(t);return n},escape:function(e){return e.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(e){e.normalize();for(var n=e.firstChild;n;)if(3==n.nodeType)if(n.nodeValue.match(/[^ \f\n\r\t\v]/))n=n.nextSibling;else{var t=n.nextSibling;e.removeChild(n),n=t}else 1==n.nodeType?(a.removeWhite(n),n=n.nextSibling):n=n.nextSibling;return e}};return 9==e.nodeType&&(e=e.documentElement),a.toObj(a.removeWhite(e))}a.r(n),a.d(n,{xml2json:()=>t})},"./src/view/ConfirmVillageSpeedRemoveModal.ts":(e,n,a)=>{a.r(n),a.d(n,{ConfirmVillageSpeedRemoveModal:()=>i});var t=a("./src/core/Language.ts");const i=e=>`<div class="modal-input-inline"><h2>${(0,t.Lang)("removeQuestion")}</h2></div><div class="modal-input-inline"><button class="btn" onclick="window.targetItem.confirmRemoveVillageBooster(${e})">${(0,t.Lang)("yes")}</button> <button class="btn" onclick="window.closeModal()">${(0,t.Lang)("cancel")}</button></div>`},"./src/view/addAttackModal.ts":(e,n,a)=>{a.r(n),a.d(n,{addAttackModal:()=>l});var t=a("./src/core/Api.ts"),i=a("./src/core/Language.ts");const l=()=>`<div class="modal-input-inline"><label for="attack">${(0,i.Lang)("attack")}:</label><input type="radio" value="attack" name="planner-operation" checked><label for="reinforce">${(0,i.Lang)("support")}:</label><input type="radio" value="reinforce" name="planner-operation"></div><div class="modal-input-group"><label for="planner-template">${(0,i.Lang)("template")}:</label><select id="planner-template" placeholder="${(0,i.Lang)("notSelected")}"><option value="temp_all">${(0,i.Lang)("allUnit")}</option>${window.attackPlan.templates.map((e=>`<option value="${e.name}" ${window.latestTemplate==e.name?"selected":""}>${e.name}</option>`))}</select></div><div class="modal-input-group"><label for="planner-arrival">${(0,i.Lang)("arrival")}:</label><select id="planner-arrival" placeholder="${(0,i.Lang)("notSelected")}">${window.attackPlan.arrivals.map((e=>`<option value="${e}" ${window.latestArrival==e?"selected":""}>${e}</option>`))}</select></div><div class="modal-input-group"><label for="planner-notes">${(0,i.Lang)("note")}:</label><input id="planner-notes" placeholder="${(0,i.Lang)("noNote")}"></div><div class="modal-input-inline"><button class="btn" onclick="window.addAttackConfirm()">${(0,i.Lang)("add")}</button> <button class="btn" onclick="window.closeModal()">${(0,i.Lang)("cancel")}</button></div>`;window.addAttackConfirm=()=>{let e=[],n=[];if(0==$('input[name="target"]:checked').get().length)return void window.UI.ErrorMessage((0,i.Lang)("noTargetSelected"));if(0==$(".launch-list").find("input:checked").get().length)return void window.UI.ErrorMessage((0,i.Lang)("noLauncherSelected"));let a=parseInt($('input[name="target"]:checked').val().toString()),l=$("#planner-template").val().toString(),o=$('input[name="planner-operation"]:checked').val().toString(),s=$("#planner-arrival").val().toString(),r=$("#planner-notes").val().toString();window.latestTemplate=l,window.latestArrival=s,console.log($(".launch-list").find("input:checked").get().length,a,l,o,s,r);let d=window.attackPlan.targetPool.findIndex((e=>e.village.id==a)),c=window.attackPlan.templates.findIndex((e=>e.name==l));$(".launch-list").find("input:checked").get().forEach((n=>{let a=parseInt($(n).val().toString()),t=window.attackPlan.launchPool.findIndex((e=>e.id==a)),i=null;c>-1&&(i=window.attackPlan.templates[c].units),"temp_all"==l&&(i=window.attackPlan.launchPool[t].unitsContain);let g=window.attackPlan.launchPool[t].id,p=window.addLauncher(d,t,i,o,s,r);console.log(p),p?$(".launch-list").find(`#${g}`).remove():e.push(window.attackPlan.launchPool[t])})),n.push(window.attackPlan.targetPool[d]),window.targetPoolQuery.partialRender(n,"village.id"),window.launchVillagesQuery.partialRender(e,"id"),$(".planner-modal").hide(),(0,t.savePlan)()},window.addLauncher=(e,n,a,i,l,o)=>{let s={...window.attackPlan.launchPool[n]};return s.unitsContain={spear:0,sword:0,axe:0,archer:0,spy:0,light:0,marcher:0,heavy:0,ram:0,catapult:0,knight:0,snob:0},[s.unitsContain,window.attackPlan.launchPool[n].unitsContain]=(0,t.TroopTransaction)(s.unitsContain,window.attackPlan.launchPool[n].unitsContain,a),s.popSize=(0,t.calcUnitPop)(s.unitsContain),window.attackPlan.launchPool[n].popSize=(0,t.calcUnitPop)(window.attackPlan.launchPool[n].unitsContain),s.popSize>0&&window.attackPlan.targetPool[e].launchers.push({arrival:l,isAttack:"attack"==i,notes:o,unitSpeed:(0,t.getSlowestUnit)(s.unitsContain,"attack"==i),village:s}),0==window.attackPlan.launchPool[n].popSize&&(window.attackPlan.launchPool.splice(n,1),!0)}},"./src/view/addPlayerSpeedModal.ts":(e,n,a)=>{a.r(n),a.d(n,{addPlayerSpeedModal:()=>l});var t=a("./src/core/Api.ts"),i=a("./src/core/Language.ts");const l=()=>{let e=[];window.attackPlan.targetPool.forEach((n=>{e.includes(n.village.owner)||e.push(n.village.owner)}));let n=[];return e.forEach((e=>{let a=window.Players.find((n=>n.id==e));a&&-1==window.attackPlan.boosters.findIndex((e=>e.playerId==a.id))&&n.push(a)})),`<div class="modal-input-group"><select id="planner-player-boosts" size="5">${window.attackPlan.boosters.map((e=>`<option value="${e.playerId}">${e.player} (${e.value}%)</option>`))}</select><button class="btn" onclick="window.removePlayerBoost()">${(0,i.Lang)("remove")}</button></div>\n<div class="modal-input-group"><select id="planner-player-select">${n.map((e=>`<option value="${e.id}">${e.name}</option>`))}</select><label for="planner-player-boost">${(0,i.Lang)("boosterPct")}:</label><input id="planner-player-boost" type="number" max="60" min="1" placeholder="%"><button class="btn" onclick="window.addPlayerBoost()">${(0,i.Lang)("add")}</button></div>`};window.addPlayerBoost=()=>{if(""==$("#planner-player-boost").val())return;let e=parseInt($("#planner-player-select").val().toString()),n=parseInt($("#planner-player-boost").val().toString());if(0==n)return;let a=window.Players.find((n=>n.id==e));window.attackPlan.boosters.push({player:a,playerId:e,value:n}),(0,t.savePlan)(),$(".planner-modal-content").html(l())},window.removePlayerBoost=()=>{if(null==$("#planner-player-boosts").val())return;let e=parseInt($("#planner-player-boosts").val().toString()),n=window.attackPlan.boosters.findIndex((n=>n.playerId==e));window.attackPlan.boosters.splice(n,1),$(".planner-modal-content").html(l())}},"./src/view/addVillageSpeedModal.ts":(e,n,a)=>{a.r(n),a.d(n,{addVillageBoosterModal:()=>i});var t=a("./src/core/Language.ts");const i=e=>`<div class="modal-input-group"><label for="planner-notes">${(0,t.Lang)("boosterPct")}:</label><input id="planner-village-boost" type="number" max="60" min="1" placeholder="%"></div><div class="modal-input-inline"><button class="btn" onclick="window.targetItem.confirmAddVillageBooster(${e})">${(0,t.Lang)("yes")}</button> </div>`},"./src/view/autoAssignModal.ts":(e,n,a)=>{a.r(n),a.d(n,{autoAssignModal:()=>l});var t=a("./src/core/Api.ts"),i=a("./src/core/Language.ts");const l=()=>{let e="";return window.attackPlan.templates.forEach((n=>{e+=`<option value='${n.name}'>${n.name}</option>`})),`<style>.assigner-row {  display: grid;display: grid;grid-template-columns: 200px repeat(auto-fill, 80px) 10px;}\n.assigner-row input{width:30px;}\n.item{padding:5px;}\n.add-assignment{width: 130px;}\n.add-assignment input{width: 50px;}\n.assigner-target-villages{width:1100px;max-height:250px;overflow-y:auto;border: solid 1px #6c4824;border-radius: 5px;background-color:#fff5dc;}\n.assigner-target-villages .item{border: solid 1px #6c4824;}\n.assigner-counter .item{border: solid 1px #6c4824;}\n.assigner-counter .item:first-of-type{border: none !important;}\n.assigner-counter .item:last-of-type{border: none !important;}\n\n.assigner-target-btn{display:block;width: 20px;height: 20px;background: url(https://dshu.innogamescdn.com/asset/80b013af/graphic/login_close.png) top left no-repeat;cursor: pointer;background-size: 20px;margin-right: 10px;}\n.assigner-date div{transform: rotate(290deg) translateX(20px);text-wrap: nowrap;}\n.assignment-alg{margin:15px 0;display: flex;justify-content: center;}\n.add-assignment-input{margin-bottom:5px;display:grid;}</style><div class="assigner"><div class="add-assignment"><div class="add-assignment-input"><label>${(0,i.Lang)("date")}:</label><select id="assignmentArrival">${window.attackPlan.arrivals.map((e=>`<option value='${e}'>${e}</option>`)).join("")}</select></div><div class="add-assignment-input"><label>${(0,i.Lang)("template")}:</label><select id="assignmentTemplates">${e}</select></div><div class="add-assignment-input"><label>${(0,i.Lang)("qntt")}:</label><input min="1" value="1" id="assigner-number-filter" type="number" disabled><input id="assigner-max-filter" onclick="$('#assigner-number-filter').prop('disabled', (i, v) => !v);" type="checkbox" checked></div><button class="btn" onclick="autoAssign.addAssignment()">+ ${(0,i.Lang)("add")}</button></div><div class="assigner-header"><div class="assigner-row assigner-date"><div class="item"></div><div class="item checkbox"></div></div><div class="assigner-row assigner-remover"><div class="item"></div><div class="item checkbox"></div></div><div class="assigner-row assigner-loader"><div class="item"></div><div class="item checkbox"></div></div><div class="assigner-row assigner-name"><div class="item">${(0,i.Lang)("village")} (${window.attackPlan.targetPool.length})</div><div class="item checkbox"><input id="assigner-main-checkbox" onclick="autoAssign.checkAll()" type="checkbox"></div></div>  </div><div class="assigner-target-villages">${window.attackPlan.targetPool.map((e=>`<div class="assigner-row" id="assigner-row-${e.village.id}"><div class="item"><a target="_blank" href="/game.php?village=${t.game.village.id}&screen=info_village&id=${e.village.id}">${e.village.name}(${e.village.coord.text}) K${e.village.kontinent}</a></div><div class="item checkbox"><input class="assigner-target-check" value="${e.village.id}" type="checkbox"></div></div>`)).join("")}</div><div class="assigner-row assigner-counter"><div class="item"></div><div class="item checkbox"></div></div><div class="assignment-alg"><input id="evenDistributeClosest" value="1" type="radio" name="assignmentAlg"><label for="evenDistributeClosest">${(0,i.Lang)("even")}</label><input id="oneByOneQ" value="2" type="radio" name="assignmentAlg"><label for="oneByOneQ">${(0,i.Lang)("oneByOne")}</label><input id="oneByOneClosest" value="3"  type="radio" name="assignmentAlg"><label for="oneByOneClosest">${(0,i.Lang)("oneByOneClosest")}</label><input id="closestToTarget" value="4" type="radio" name="assignmentAlg"><label for="closestToTarget">${(0,i.Lang)("closestToTarget")}</label></div><div><button style="margin: 0 auto; display: block;" onclick="autoAssign.startAssignment()" class="btn">${(0,i.Lang)("startAssignment")}</button></div></div><div id="dialog-loading" style="display: none;justify-content: center;width: 100%;"><img style="height:25px" src="https://dshu.innogamescdn.com/asset/6389cdba/graphic/loading.gif"><span style="padding:5px">${(0,i.Lang)("assigningAttacks")}...</span></div>`};function o(e,n){let a=[];for(let i=0;i<window.autoAssign.launchPoolCopy.length;i++){const l=window.autoAssign.launchPoolCopy[i];if(a.length>=n)break;if((0,t.hasAvailableTroops)(l,e.units)){let n={...l};n.unitsContain={spear:0,sword:0,axe:0,archer:0,spy:0,light:0,marcher:0,heavy:0,ram:0,catapult:0,knight:0,snob:0},[n.unitsContain,l.unitsContain]=(0,t.TroopTransaction)(n.unitsContain,l.unitsContain,e.units),e.units.snob>0&&(e.units.marcher<0&&(l.unitsContain.marcher=0),e.units.light<0&&(l.unitsContain.light=0),e.units.axe<0&&(l.unitsContain.axe=0)),n.popSize=(0,t.calcUnitPop)(n.unitsContain),l.popSize=(0,t.calcUnitPop)(l.unitsContain),a.push(n),0==l.popSize&&(console.log("removed"),window.autoAssign.launchPoolCopy.splice(i,1))}}return a}window.autoAssign={assignTypes:[],launchPoolCopy:[],removeAssignment:e=>{let n=window.autoAssign.assignTypes.findIndex((n=>n.id==e.toString()));-1!=n&&(window.autoAssign.assignTypes[n].filtered.forEach((e=>{let a=window.autoAssign.launchPoolCopy.findIndex((n=>n.id==e.id));-1==a?window.autoAssign.launchPoolCopy.push(e):(window.autoAssign.assignTypes[n].template.units.snob>0&&(window.autoAssign.assignTypes[n].template.units.marcher<0&&(e.unitsContain.marcher-=window.autoAssign.assignTypes[n].template.units.marcher),window.autoAssign.assignTypes[n].template.units.light<0&&(e.unitsContain.light-=window.autoAssign.assignTypes[n].template.units.light),window.autoAssign.assignTypes[n].template.units.axe<0&&(e.unitsContain.axe-=window.autoAssign.assignTypes[n].template.units.axe)),[window.autoAssign.launchPoolCopy[a].unitsContain,e.unitsContain]=(0,t.TroopTransaction)(window.autoAssign.launchPoolCopy[a].unitsContain,e.unitsContain,e.unitsContain))})),window.autoAssign.assignTypes.splice(n,1),$(".ar-"+e).remove())},fillAssignment:e=>{$(".assigner-target-villages .assigner-target-check").get().forEach((n=>{if(!$(n).is(":checked"))return;let a=$(`.assigner-loader .ar-${e}`).find(".ass-inp").val();$(n).parent().parent().find(`.ar-${e} .ass-inp`).val(a)})),window.autoAssign.updateCount(e)},addAssignment:()=>{if(window.autoAssign.assignTypes.length>=10)return;let e=$("#assignmentArrival").val().toString(),n=99999;$("#assigner-max-filter").is(":checked")||(n=parseInt($("#assigner-number-filter").val().toString()));let a=$("#assignmentTemplates").val().toString(),t=window.attackPlan.templates.find((e=>e.name==a)),i={id:(new Date).getTime().toString(),arrival:e,filtered:o(t,n),required:0,template:t,max:n};window.autoAssign.assignTypes.push(i),$(".assigner-header .assigner-loader .checkbox").before(`<div class="item ar-${i.id}" ><input class="ass-inp" value="0" type="number" min="0"><button onclick="autoAssign.fillAssignment(${i.id})">â†“</button></div>`),$(".assigner-header .assigner-name .checkbox").before(`<div class="item ar-${i.id}" >${i.template.name}</div>`),$(".assigner-header .assigner-remover .checkbox").before(`<div class="item ar-${i.id}" ><a onclick="autoAssign.removeAssignment(${i.id})" class="assigner-target-btn"></a></div>`),$(".assigner-header .assigner-date .checkbox").before(`<div class="item ar-${i.id}" >${i.arrival}</div>`),$(".assigner-target-villages").find(".assigner-row").get().forEach((e=>{$(e).find(".checkbox").before(`<div class="item ar-${i.id}" ><input class="ass-inp" onchange="autoAssign.updateCount(${i.id})" onkeyup="autoAssign.updateCount(${i.id})" value="0" type="number" min="0"></div>`)})),$(".assigner-counter .checkbox").before(`<div class="item ar-${i.id}" ><span class="cnt-actual">0</span>/${i.filtered.length}</div>`),console.log(window.autoAssign.assignTypes)},startAssignment:()=>{let e=$('input[name="assignmentAlg"]:checked').val();e?0!=window.autoAssign.assignTypes.length?($("#dialog-loading").show(),$("#plannerCloseBtn").hide(),$(".assigner").hide(),setTimeout((()=>{switch(e){case"1":window.autoAssign.assignTypes.forEach(((e,n)=>{let a=0;for(;e.filtered.length>0&&e.required>a;)for(let i=0;i<window.attackPlan.targetPool.length;i++){const l=window.attackPlan.targetPool[i];let o=0;for(let e=0;e<n+1;e++)o+=parseInt($(`#assigner-row-${l.village.id} .ar-${window.autoAssign.assignTypes[e].id} .ass-inp`).val().toString());if(console.log(o),l.launchers.length<o){let n=-1,o=999999;if(e.filtered.forEach(((e,a)=>{let i=(0,t.coordDistance)(e,l.village);i<o&&(n=a,o=i)})),n>-1){a++,console.log(a,e.required);let t=window.attackPlan.launchPool.findIndex((a=>a.id==e.filtered[n].id));window.addLauncher(i,t,e.template.units,"attack",e.arrival,""),e.filtered.splice(n,1)}}}}));break;case"2":!function(){for(let e=0;e<window.attackPlan.targetPool.length;e++){const n=window.attackPlan.targetPool[e];for(let a=0;a<window.autoAssign.assignTypes.length;a++){const i=window.autoAssign.assignTypes[a];if(0==i.filtered.length)continue;let l=parseInt($(`#assigner-row-${n.village.id} .ar-${i.id} .ass-inp`).val().toString());for(let a=0;a<l;a++){let a=-1,l=999999;if(i.filtered.forEach(((e,i)=>{let o=(0,t.coordDistance)(e,n.village);o<l&&(a=i,l=o)})),a>-1){let n=window.attackPlan.launchPool.findIndex((e=>e.id==i.filtered[a].id));window.addLauncher(e,n,i.template.units,"attack",i.arrival,""),i.filtered.splice(a,1)}}}}}();break;case"3":!function(){for(let e=0;e<window.attackPlan.targetPool.length;e++){const n=window.attackPlan.targetPool[e];for(let a=0;a<window.autoAssign.assignTypes.length;a++){const t=window.autoAssign.assignTypes[a];if(0==t.filtered.length)continue;let i=parseInt($(`#assigner-row-${n.village.id} .ar-${t.id} .ass-inp`).val().toString());for(let n=0;n<i;n++){let n=window.attackPlan.launchPool.findIndex((e=>e.id==t.filtered[0].id));window.addLauncher(e,n,t.template.units,"attack",t.arrival,""),t.filtered.splice(0,1)}}}}();break;case"4":!function(){let e=[];for(let n=0;n<window.autoAssign.assignTypes.length;n++){const a=window.autoAssign.assignTypes[n];if(0!=a.filtered.length)for(let i=0;i<a.filtered.length;i++){const l=a.filtered[i];let o=-1,s=999999;for(let a=0;a<window.attackPlan.targetPool.length;a++){const i=window.attackPlan.targetPool[a];let r=e.findIndex((e=>e.id==i.village.id)),d=0;for(let e=0;e<n+1;e++)d+=parseInt($(`#assigner-row-${i.village.id} .ar-${window.autoAssign.assignTypes[e].id} .ass-inp`).val().toString());if(console.log(d),r>-1&&e[r].cnt>=d)continue;let c=(0,t.coordDistance)(l,i.village);c<s&&(o=a,s=c)}if(o>-1){let n=e.findIndex((e=>e.id==window.attackPlan.targetPool[o].village.id));-1==n?e.push({id:window.attackPlan.targetPool[o].village.id,cnt:1}):e[n].cnt++;let t=window.attackPlan.launchPool.findIndex((e=>e.id==a.filtered[i].id));window.addLauncher(o,t,a.template.units,"attack",a.arrival,""),a.filtered.splice(i,1)}}}}()}window.targetPoolQuery.resetAll(),window.launchVillagesQuery.resetAll(),window.closeModal(),(0,t.savePlan)()}),200)):window.UI.ErrorMessage((0,i.Lang)("noAttackAssigned")):window.UI.ErrorMessage((0,i.Lang)("noAlgSelected"))},checkAll:()=>{$(".assigner-target-villages").find("input[type=checkbox]").get().forEach((e=>{$(e).prop("checked",$("#assigner-main-checkbox").prop("checked"))}))},updateCount:e=>{let n=0;$(`.assigner-target-villages .ar-${e} .ass-inp`).get().forEach((e=>{let a=$(e).val();n+=parseInt(a.toString().split("x")[0])})),console.log(e,n);let a=window.autoAssign.assignTypes.findIndex((n=>n.id==e.toString()));window.autoAssign.assignTypes[a].required=n,$(`.assigner-counter .ar-${e} .cnt-actual`).text(n)}}},"./src/view/calculatedAttackModal.ts":(e,n,a)=>{a.r(n),a.d(n,{calculatedAttackModal:()=>l,generateLaunchText:()=>o});var t=a("./src/core/Api.ts"),i=a("./src/core/Language.ts");const l=()=>{const e=["spear","sword","axe","archer","spy","light","marcher","heavy","ram","catapult","knight","snob"];return setTimeout((()=>{!function(){let n=[];window.attackPlan.targetPool.forEach((a=>{let i=window.attackPlan.boosters.findIndex((e=>e.playerId==a.village.owner));a.launchers.forEach((l=>{let o=1;i>-1&&(a.booster=window.attackPlan.boosters[i].value),l.isAttack||(o+=a.booster/100);let r=60*l.unitSpeed.value,d=new Date(l.arrival),c=new Date(d.valueOf()-Math.round(1e3*r/window.gameConfig.speed/(window.gameConfig.unit_speed*o)*(0,t.coordDistance)(l.village,a.village))),g=(0,t.formatDateTime)(c),p="",u="";Object.keys(window.unitConfig).forEach(((n,a)=>{l.village.unitsContain.hasOwnProperty(n)&&l.village.unitsContain[n]>0&&(p+=`&${n}=${l.village.unitsContain[n]}`,u+=`${e.indexOf(n).toString(16)}:${l.village.unitsContain[n].toString(16)},`)})),n.push({launchDate:g,launchLink:`https://${window.location.host}/game.php?village=${l.village.id}&screen=place&target=${a.village.id}${p}`,qrdata:(l.isAttack?1:0)+","+`${e.indexOf(l.unitSpeed.key).toString(16)},`+`${new Date(g).getTime().toString(16)},`+`${l.village.id.toString(16)},`+`${a.village.id.toString(16)},`+`${s(a.village.name)},`+`${u.slice(0,-1)};`,unitSpeed:l.unitSpeed,villageFrom:l.village,villageTo:a.village,note:l.notes,isAttack:l.isAttack})}))})),n.sort(((e,n)=>e.launchDate>n.launchDate?1:-1));let{bbcode:a,html:i,QRhtml:l}=o(n);console.log(l),$(".bb-field").html(a),$(".inApp-field").html(i),$(".qr-field").html(l),$("#dialog-loading").hide(),$(".modal-input-inline").show()}()}),2e3),`<div id="dialog-loading"><img style="height:25px" src="https://dshu.innogamescdn.com/asset/6389cdba/graphic/loading.gif"><span style="padding:5px">${(0,i.Lang)("calculaing")}...</span></div><div class="modal-input-inline" style="display:none"><label for="bb">${(0,i.Lang)("bbCode")}:</label><input onclick="window.changeDisplayType()" type="radio" id="bb" value="bb" name="showType" ><label for="inapp">In-app:</label><input onclick="window.changeDisplayType()" type="radio" id="inapp" value="inapp" name="showType" checked><label for="inapp">mobile-app:</label><input onclick="window.changeDisplayType()" type="radio" id="mobile" value="mobile" name="showType" ><div class="bb-field" style="display:none;max-height:600px; overflow-y: auto;"></div><div class="inApp-field" style="max-height:600px; overflow-y: auto;"></div><div class="qr-field" style="display:none;max-height:650px; overflow-y: auto;"></div></div>`};function o(e){let n=0,a=1,l=`<textarea style="resize:none;overflow: hidden;height:100px;width:400px;">[table][**] [||][building]barracks[/building][||]${(0,i.Lang)("launch")}[||]${(0,i.Lang)("target")}[||]${(0,i.Lang)("command")}[||]${(0,i.Lang)("note")}[/**]`,o="",r="",d=1,c=`twla://${d.toString(16)}:-pageCnt-,${window.location.hostname},${s(window.attackPlan.name)}/`,g=`<table class="vis"><tr><th></th><th></th><th>${(0,i.Lang)("launch")}</th><th>${(0,i.Lang)("target")}</th><th>${(0,i.Lang)("command")}</th><th>${(0,i.Lang)("note")}</th></tr>`;for(let s=0;s<e.length;s++){let p=`[*]#${s+1}[|][unit]${e[s].unitSpeed.key}[/unit][|][b]${e[s].launchDate}[/b][|] ${e[s].villageTo.coord.text} [|][url=${e[s].launchLink}]${e[s].isAttack?(0,i.Lang)("attack"):(0,i.Lang)("support")}[/url][|]${e[s].note}`;n+p.length+23>=6e4&&(n=0,a++,o+="[/table]</textarea><br>"),0==n&&(o+=`${a}.${(0,i.Lang)("page")}<br>`+l,n+=l.length),c.length+e[s].qrdata.length>1e3&&(r+=`<h3>${d}.Oldal</h3><div><p><img src="https://api.qrserver.com/v1/create-qr-code/?size=600x600&data=${c}"></p></div>`,d++,c=`twla://${d.toString(16)}/`),c+=e[s].qrdata,s==e.length-1&&(r+=`<h3>${d}.Oldal</h3><div><p><img src="https://api.qrserver.com/v1/create-qr-code/?size=600x600&data=${c}"></p></div>`),o+=p,n+=p.length,g+=`<tr><td>#${s+1}</td><td><img src="/graphic/unit/unit_${e[s].unitSpeed.key}.png"></td><td>${e[s].launchDate}</td><td><a target="_blank" href="/game.php?village=${t.game.village.id}&screen=info_village&id=${e[s].villageTo.id}">${e[s].villageTo.name} (${e[s].villageTo.coord.text}) </a></td><td><a href="${e[s].launchLink}">${e[s].isAttack?(0,i.Lang)("attack"):(0,i.Lang)("support")}</a></td><td>${e[s].note}</td></tr>`}return g+="</table>",r=r.replace("-pageCnt-",d.toString(16)),{bbcode:o,html:g,QRhtml:r}}function s(e){return[";","/",",",":"].forEach((n=>{e=e.replaceAll(n," ")})),e}window.changeDisplayType=()=>{let e=$("input[name=showType]:checked").val();switch($(".inApp-field").hide(),$(".bb-field").hide(),$(".qr-field").hide(),e){case"bb":$(".bb-field").show();break;case"inapp":$(".inApp-field").show();break;case"mobile":$(".qr-field").show(),$(".qr-field").accordion()}}},"./src/view/confirmCalculateAttackModal.ts":(e,n,a)=>{a.r(n),a.d(n,{confirmCalculateAttackModal:()=>i});var t=a("./src/core/Language.ts");const i=()=>`<div class="modal-input-inline"><h2>${(0,t.Lang)("calculateQuestion")}</h2></div><div class="modal-input-inline"><button class="btn" onclick="window.confirmCalculateAttack()">${(0,t.Lang)("yes")}</button> <button class="btn" onclick="window.closeModal()">${(0,t.Lang)("cancel")}</button></div>`},"./src/view/confirmRemoveModal.ts":(e,n,a)=>{a.r(n),a.d(n,{confirmRemoveModal:()=>i});var t=a("./src/core/Language.ts");const i=(e,n)=>`<div class="modal-input-inline"><h2>${(0,t.Lang)("removeQuestion")}</h2></div><div class="modal-input-inline"><button class="btn" onclick="window.targetItem.confirmRemoveTargetLauncherItem(${e},${n})">${(0,t.Lang)("yes")}</button> <button class="btn" onclick="window.closeModal()">${(0,t.Lang)("cancel")}</button></div>`},"./src/view/confirmRemoveTargetModal.ts":(e,n,a)=>{a.r(n),a.d(n,{confirmRemoveTargetModal:()=>i});var t=a("./src/core/Language.ts");const i=e=>`<div class="modal-input-inline"><h2>${(0,t.Lang)("removeQuestion")}</h2></div><div class="modal-input-inline"><button class="btn" onclick="window.targetItem.confirmRemoveTargetItem(${e})">${(0,t.Lang)("yes")}</button> <button class="btn" onclick="window.closeModal()">${(0,t.Lang)("cancel")}</button></div>`},"./src/view/confirmResetAssignmentsModal.ts":(e,n,a)=>{a.r(n),a.d(n,{confirmResetAssignmentsModal:()=>l});var t=a("./src/core/Api.ts"),i=a("./src/core/Language.ts");const l=()=>`<div class="modal-input-inline"><h2>${(0,i.Lang)("resetAttackQuestion")}</h2></div><div class="modal-input-inline"><button class="btn" onclick="window.finalResetAssignments()">${(0,i.Lang)("yes")}</button></div>`;window.finalResetAssignments=()=>{window.attackPlan.targetPool.forEach((e=>{e.isSelected=!1,e.isOpen=!1,e.launchers.forEach((e=>{let n=window.attackPlan.launchPool.findIndex((n=>n.id==e.village.id));-1==n?window.attackPlan.launchPool.push({...e.village}):[window.attackPlan.launchPool[n].unitsContain,e.village.unitsContain]=(0,t.TroopTransaction)(window.attackPlan.launchPool[n].unitsContain,e.village.unitsContain,e.village.unitsContain)})),e.launchers=[]})),window.closeModal(),window.launchVillagesQuery.resetAll(),window.targetPoolQuery.resetAll(),(0,t.savePlan)()}},"./src/view/editArrivalsModal.ts":(e,n,a)=>{a.r(n),a.d(n,{editArrivalsModal:()=>l});var t=a("./src/core/Api.ts"),i=a("./src/core/Language.ts");const l=e=>(window.editArrivalsModal.arrivalsRef=e,`<div class="modal-input-group"><label for="">${(0,i.Lang)("arrivals")}:</label><select id="plan_arrivals_select" size="5">${e.map((e=>`<option value="${e}">${e}</option>`)).join("")}</select><input id="plan_arrivals_input" type="datetime-local" type="text" step="1"/></div><div class="modal-input-inline"><button class="btn" onclick="editArrivalsModal.addArrival()" >${(0,i.Lang)("add")}</button><button class="btn" onclick="editArrivalsModal.removeArrival()">${(0,i.Lang)("remove")}</button></div>`);window.editArrivalsModal={addArrival:()=>{let e=$("#plan_arrivals_input").val().toString().replace("T"," ");if(""==e)return;window.editArrivalsModal.arrivalsRef.includes(e)||window.editArrivalsModal.arrivalsRef.push(e),window.editArrivalsModal.arrivalsRef.sort(((e,n)=>e>n?1:-1));let n="";window.editArrivalsModal.arrivalsRef.forEach((e=>{n+=`<option value="${e}">${e}</option>`})),$("#plan_arrivals_select").html(n),1==$(".mainWindow").get().length?(0,t.savePlan)():window.launchDialog.stepCheck()},removeArrival:()=>{let e=$("#plan_arrivals_select").val().toString().replace("T"," ");if(""==e)return;let n=window.editArrivalsModal.arrivalsRef.findIndex((n=>n==e));n>-1&&window.editArrivalsModal.arrivalsRef.splice(n,1);let a="";window.editArrivalsModal.arrivalsRef.forEach((e=>{a+=`<option value="${e}">${e}</option>`})),$("#plan_arrivals_select").html(a),1==$(".mainWindow").get().length?(0,t.savePlan)():window.launchDialog.stepCheck()}}},"./src/view/editLaunchVillagesModal.ts":(e,n,a)=>{a.r(n),a.d(n,{editLaunchVillagesModal:()=>i});var t=a("./src/core/Language.ts");const i=e=>`<label for="">${(0,t.Lang)("launchers")}:</label><br><select id="plan_launcher_list" size="5"></select><label for="">${(0,t.Lang)("groups")}:</label><br><select id="plan_launcher_select" style="font-size:16px" >${window.Groups.map((e=>`<option value="${e.id}">${e.name}</option>`)).join("")}</select><label for="">${(0,t.Lang)("available")}:</label><br><select id="plan_launcher_select_state" style="font-size:16px" ><option value="home">${(0,t.Lang)("home")}</option><option value="all">${(0,t.Lang)("all")}</option></select><div><button class="btn" onclick="editLaunchVillagesModal.addGroup()" >${(0,t.Lang)("add")}</button><button class="btn" onclick="editLaunchVillagesModal.removeGroup()" >${(0,t.Lang)("remove")}</button></div>`;window.editLaunchVillagesModal={addGroup:()=>{let e=parseInt($("#plan_launcher_select").val().toString()),n=$("#plan_launcher_select_state").val().toString();if(window.launchDialog.groupIDs.findIndex((n=>n.id==e))>-1)return;window.launchDialog.groupIDs.push({id:e,name:$("#plan_launcher_select option:selected").text(),all:"all"===n});let a="";window.launchDialog.groupIDs.forEach((e=>{a+=`<option value="${e.id}">${e.name} (${e.all?(0,t.Lang)("all"):(0,t.Lang)("home")})</option>`})),$("#plan_launcher_list").html(a),window.launchDialog.stepCheck()},removeGroup:()=>{let e=parseInt($("#plan_launcher_list").val().toString()),n=window.launchDialog.groupIDs.findIndex((n=>n.id==e));window.launchDialog.groupIDs.splice(n,1);let a="";window.launchDialog.groupIDs.forEach((e=>{a+=`<option value="${e.id}">${e.name}</option>`})),$("#plan_launcher_list").html(a),window.launchDialog.stepCheck()}}},"./src/view/editPlanNameModal.ts":(e,n,a)=>{a.r(n),a.d(n,{editPlanNameModal:()=>l});var t=a("./src/core/Api.ts"),i=a("./src/core/Language.ts");const l=e=>(window.editPlanNameModal.planRef=e,`<label for="plan_name_input" >${(0,i.Lang)("planName")}:</label><br><input maxlength="20" value="${window.editPlanNameModal.planRef.name}" onkeyup="window.editPlanNameModal.saveName()" id="plan_name_input" type="text"/>`);window.editPlanNameModal={saveName:()=>{let e=$("#plan_name_input").val().toString();e=e.substring(0,20).trim(),window.editPlanNameModal.planRef.name=e,$("#open-plan-name").get().length>0&&$("#open-plan-name").text(e),1==$(".mainWindow").get().length?(0,t.savePlan)():window.launchDialog.stepCheck()}}},"./src/view/editTargetModal.ts":(e,n,a)=>{a.r(n),a.d(n,{editTargetModal:()=>l});var t=a("./src/core/Api.ts"),i=a("./src/core/Language.ts");const l=e=>(window.editTargetModal.targetRef=e,`<div class="modal-input-group"><label for="target-select">${(0,i.Lang)("targets")} (<span id="modal-targets-cnt">${e.length}</span>):</label><select id="target-select" size="5" multiple>${e.map((e=>`<option value="${e.village.id}">${e.village.name} (${e.village.coord.text}) K${e.village.kontinent}</option>`)).join("")}</select></div><div class="modal-input-group"><label for="">${(0,i.Lang)("newTargets")}:</label><br><textarea id="plan_targets" size="10"></textarea></div><div class="modal-input-inline"><button class="btn" onclick="editTargetModal.addTargets()">${(0,i.Lang)("add")}</button><button class="btn" onclick="editTargetModal.removeTargets()">${(0,i.Lang)("remove")}</button></div>`);window.editTargetModal={addTargets:()=>{let e=$("#plan_targets").val().toString();console.log(e);let n=Array.from(e.matchAll(/([0-9]{1,3}).([0-9]{1,3})/g));console.log(n),n.forEach((e=>{let n=e[1]+"|"+e[2],a=window.Villages.find((e=>e.coord.text==n)),t=window.editTargetModal.targetRef.findIndex((e=>e.village.coord.text==n));a&&-1==t&&window.editTargetModal.targetRef.push({booster:0,launchers:[],village:a,isOpen:!1,isSelected:!1})})),$("#plan_targets").val(""),$("#modal-targets-cnt").text(window.editTargetModal.targetRef.length),$("#target-select").html(window.editTargetModal.targetRef.map((e=>`<option value="${e.village.id}">${e.village.name} (${e.village.coord.text}) K${e.village.kontinent}</option>`)).join("")),1==$(".mainWindow").get().length?((0,t.savePlan)(),window.targetPoolQuery.resetAll()):window.launchDialog.stepCheck()},removeTargets:()=>{$("#target-select").val().toString().split(",").forEach((e=>{let n=window.editTargetModal.targetRef.findIndex((n=>n.village.id==parseInt(e)));1==$(".mainWindow").get().length&&window.editTargetModal.targetRef[n].launchers.forEach((e=>{let n=window.attackPlan.launchPool.findIndex((n=>n.id==e.village.id));-1==n?window.attackPlan.launchPool.push({...e.village}):[window.attackPlan.launchPool[n].unitsContain,e.village.unitsContain]=(0,t.TroopTransaction)(window.attackPlan.launchPool[n].unitsContain,e.village.unitsContain,e.village.unitsContain)})),window.editTargetModal.targetRef.splice(n,1)})),$("#target-select").html(window.editTargetModal.targetRef.map((e=>`<option value="${e.village.id}">${e.village.name} (${e.village.coord.text}) K${e.village.kontinent}</option>`)).join("")),1==$(".mainWindow").get().length&&(window.targetPoolQuery.resetAll(),window.launchVillagesQuery.resetAll())},targetRef:[]}},"./src/view/editTemplatesModal.ts":(e,n,a)=>{a.r(n),a.d(n,{editTemplatesModal:()=>l});var t=a("./src/core/Api.ts"),i=a("./src/core/Language.ts");const l=e=>(window.templateModal.templateRef=e,`<style>.template-editor {  margin: 0 auto;display: grid;grid-template-columns: 100px 100px;grid-template-rows: max-content 35px max-content max-content;text-align:center;gap: 10px 0px;grid-auto-flow: row;grid-template-areas:"template-select-box template-select-box""template-buttons template-buttons""template-infantry template-calvary""template-machines template-other";}.template-select-box { grid-area: template-select-box; display:grid; }.template-calvary { grid-area: template-calvary; }.template-machines { grid-area: template-machines; }.template-other { grid-area: template-other; }.template-buttons{ grid-area: template-buttons; }.template-infantry { grid-area: template-infantry; }.template-input-group{margin-top:5px;}\n.template-editor option {font-size: 16px;padding: 2px 5px;text-align: center;}.template-unitsInput {width: 45px;}\n</style><div class="template-editor"><div class="template-select-box"><label for="template_select">${(0,i.Lang)("templates")}:</label><select onclick="templateModal.selectTemplate()" id="template_select" size="5">${e.map((e=>`<option value="${e.name}">${e.name}</option>`))}</select><label for="temp_name">${(0,i.Lang)("name")}:</label><input id="temp_name" type="text" /></div><div class="template-infantry"><div class="template-input-group"><img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_spear.png" ><input id="palnner_unit_input_spear" type="number" tabindex="1" value="0" class="template-unitsInput"><br><input onclick="templateModal.selectAll('spear')" id="max_spear" type="checkbox"> ${(0,i.Lang)("all")}</div><div class="template-input-group"><img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_sword.png" ><input id="palnner_unit_input_sword" type="number" tabindex="1" value="0" class="template-unitsInput"><br><input onclick="templateModal.selectAll('sword')" id="max_sword" type="checkbox"> ${(0,i.Lang)("all")}</div><div class="template-input-group"><img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_axe.png" ><input id="palnner_unit_input_axe" type="number" tabindex="1" value="0" class="template-unitsInput"><br><input onclick="templateModal.selectAll('axe')" id="max_axe" type="checkbox"> ${(0,i.Lang)("all")}</div><div class="template-input-group" ${0==window.gameConfig.game.archer&&'style="display:none;"'} ><img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_archer.png" ><input id="palnner_unit_input_archer" type="number" tabindex="1" value="0" class="template-unitsInput"><br><input onclick="templateModal.selectAll('archer')" id="max_archer" type="checkbox"> ${(0,i.Lang)("all")}</div></div><div class="template-calvary"><div class="template-input-group"><img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_spy.png" ><input id="palnner_unit_input_spy" type="number" tabindex="1" value="0" class="template-unitsInput"><br><input onclick="templateModal.selectAll('spy')" id="max_spy" type="checkbox"> ${(0,i.Lang)("all")}</div><div class="template-input-group"><img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_light.png" ><input id="palnner_unit_input_light" type="number" tabindex="1" value="0" class="template-unitsInput"><br><input onclick="templateModal.selectAll('light')" id="max_light" type="checkbox"> ${(0,i.Lang)("all")}</div><div class="template-input-group" ${0==window.gameConfig.game.archer&&'style="display:none;"'}><img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_marcher.png" ><input id="palnner_unit_input_marcher" type="number" tabindex="1" value="0" class="template-unitsInput"><br><input onclick="templateModal.selectAll('marcher')" id="max_marcher" type="checkbox"> ${(0,i.Lang)("all")}</div><div class="template-input-group"><img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_heavy.png" ><input id="palnner_unit_input_heavy" type="number" tabindex="1" value="0" class="template-unitsInput"><br><input onclick="templateModal.selectAll('heavy')" id="max_heavy" type="checkbox"> ${(0,i.Lang)("all")}</div>    </div><div class="template-machines"><div class="template-input-group"><img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_ram.png" ><input id="palnner_unit_input_ram" type="number" tabindex="1" value="0" class="template-unitsInput"><br><input onclick="templateModal.selectAll('ram')" id="max_ram" type="checkbox"> ${(0,i.Lang)("all")}</div><div class="template-input-group"><img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_catapult.png" ><input id="palnner_unit_input_catapult"  type="number" tabindex="1" value="0" class="template-unitsInput"><br><input onclick="templateModal.selectAll('catapult')" id="max_catapult" type="checkbox"> ${(0,i.Lang)("all")}</div></div><div class="template-other"><div class="template-input-group"><img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_knight.png" ><input id="palnner_unit_input_knight" type="number" tabindex="1" value="0" class="template-unitsInput"><br><input onclick="templateModal.selectAll('knight')" id="max_knight" type="checkbox"> ${(0,i.Lang)("all")}</div><div class="template-input-group"><img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_snob.png" ><input id="palnner_unit_input_snob" type="number" tabindex="1" value="0" class="template-unitsInput"><br><input onclick="templateModal.selectAll('snob')" id="max_snob" type="checkbox"> ${(0,i.Lang)("all")}</div></div><div class="template-buttons"><button class="btn" onclick="templateModal.addTemplate()">${(0,i.Lang)("add")}</button><button class="btn" onclick="templateModal.removeTemplate()">${(0,i.Lang)("remove")}</button></div></div>`);window.templateModal={templateRef:[],addTemplate:()=>{if($("#temp_name").val().toString().length>10)return;let e={name:$("#temp_name").val().toString(),units:{spear:0,sword:0,archer:0,axe:0,spy:0,light:0,marcher:0,heavy:0,ram:0,catapult:0,knight:0,snob:0}};if(Object.keys(e.units).forEach((n=>{let a=parseInt($(`#palnner_unit_input_${n}`).val().toString());console.log($(`#max_${n}`).is(":checked")),$(`#max_${n}`).is(":checked")&&(a=99999),null==a&&(a=0),e.units[n]=a})),console.log(e),""==e.name)return;let n=window.templateModal.templateRef.findIndex((n=>n.name==e.name));n>-1?window.templateModal.templateRef[n]=e:window.templateModal.templateRef.push(e),$("#temp_name").val(""),Object.keys(e.units).forEach((e=>{$(`#palnner_unit_input_${e}`).val("0"),$(`#palnner_unit_input_${e}`).prop("disabled",!1),$(`#max_${e}`).prop("checked",!1)}));let a="";window.templateModal.templateRef.forEach((e=>{a+=`<option value="${e.name}">${e.name}</option>`})),$("#template_select").html(a),1==$(".mainWindow").get().length?(0,t.savePlan)():window.launchDialog.stepCheck()},removeTemplate:()=>{let e=$("#template_select").val(),n=window.templateModal.templateRef.findIndex((n=>n.name==e));n>-1&&window.templateModal.templateRef.splice(n,1);let a="";window.templateModal.templateRef.forEach((e=>{a+=`<option value="${e.name}">${e.name}</option>`})),$("#template_select").html(a),1==$(".mainWindow").get().length?(0,t.savePlan)():window.launchDialog.stepCheck()},selectTemplate:()=>{let e=$("#template_select").val(),n=window.templateModal.templateRef.findIndex((n=>n.name==e));if(console.log(n,e,window.templateModal.templateRef),n>-1){let e=window.templateModal.templateRef[n];console.log(e),$("#temp_name").val(e.name),Object.keys(e.units).forEach((n=>{let a=e.units[n];99999==a?($(`#max_${n}`).prop("checked",!0),$(`#palnner_unit_input_${n}`).prop("disabled",!0),$(`#palnner_unit_input_${n}`).val("")):($(`#palnner_unit_input_${n}`).val(a),$(`#palnner_unit_input_${n}`).prop("disabled",!1),$(`#max_${n}`).prop("checked",!1))}))}},selectAll:e=>{$(`#max_${e}`).prop("checked")?$(`#palnner_unit_input_${e}`).val(""):$(`#palnner_unit_input_${e}`).val("0"),$(`#palnner_unit_input_${e}`).prop("disabled",$(`#max_${e}`).prop("checked"))}}},"./src/view/language/en.ts":(e,n,a)=>{a.r(n),a.d(n,{en:()=>t});const t={plans:"Plans",loadPlan:"Load plan",removePlan:"Remove plan",newPlan:"New plan",cancel:"Cancel",next:"Next",loading:"Loading...",createPlan:"Create plan",PlanSuccessfullyCreated:"Plan successfully created!",attack:"Attack",support:"Strengthen",template:"Template",templates:"Templates",allUnit:"All units",arrival:"Arrival",arrivals:"Arrivals",notSelected:"---Not selected---",noNote:"---No note---",add:"Add",note:"Note",noTargetSelected:"No targets selected",noLauncherSelected:"No launchers selected",remove:"Remove",boosterPct:"Booster in percent",yes:"Yes",date:"Date",qntt:"Quantity",village:"Village",even:"Even distribution",oneByOne:"One by one",oneByOneClosest:"One by one closest",closestToTarget:"Closest to target",assigningAttacks:"Assigning attacks",startAssignment:"Start assignment",noAlgSelected:"The distribution algorithm is not selected!",noAttackAssigned:"No attack assigned!",bbCode:"BB Code",calculaing:"Calculating",calculateAttack:"Calculate attack",launch:"Launch",target:"Target",targets:"Targets",command:"Command",calculateQuestion:"Are you sure you want to calculate?",removeQuestion:"Are you sure you want to remove?",resetAttackQuestion:"Are you sure you want to reset all attacks?",launchers:"Launching village",planName:"Plan name",newTargets:"New targets",all:"All",name:"Name",editTargets:"Edit targets",editArrivals:"Edit arrivals",editTemplates:"Edit templates",editPalyerBoosters:"Booster boosters",autoAssigner:"Automatic assignment",resetAssigments:"Reset assignments",size:"Size",reset:"Reset",addAtatck:"Add attack",noLauncherSel:"No launcher village(s) selected!",noTargetSel:"No target selected!",close:"Close",renamePlan:"Rename plan",editTargetsText:"Edit targets",editArrivalsText:"Edit arrivals",editTemplatesText:"Edit templates",editBoostersText:"Edit boosters",attackPlan:"Attack Plan",removeTarget:"Remove target",removeAttack:"Remove attack",addVillageBoost:"Add booster to village",removeVillageBoost:"Remove booster from village",options:"Settings",rename:"Rename",launchVillages:"Starting villages",page:"Page",search:"Search",PlanNotSelected:"No plans have been selected!",needPremiumFeature:"A premium account is required to run the script!",home:"Home",available:"Available",groups:"Groups"}},"./src/view/language/hu.ts":(e,n,a)=>{a.r(n),a.d(n,{hu:()=>t});const t={plans:"Tervek",loadPlan:"Terv betÃ¶ltÃ©se",removePlan:"Terv tÃ¶rlÃ©se",newPlan:"Ãšj terv",cancel:"MÃ©gse",next:"KÃ¶vetkezÅ‘",loading:"BetÃ¶ltÃ©s...",createPlan:"Terv lÃ©trehozÃ¡sa",PlanSuccessfullyCreated:"A terv sikeresen lÃ©tre lett hozva!",attack:"TÃ¡madÃ¡s",support:"ErÅ‘sÃ­tÃ©s",template:"Sablon",templates:"Sablonok",allUnit:"Ã–sszes egysÃ©g",arrival:"Ã‰rkezÃ©s",arrivals:"Ã‰rkezÃ©sek",notSelected:"---Nincs kivÃ¡lasztva---",noNote:"---Nincs megjegyzÃ©s---",add:"HozzÃ¡adÃ¡s",note:"MegjegyzÃ©s",noTargetSelected:"Nincsenek cÃ©lpontok kivÃ¡lasztva",noLauncherSelected:"Nincsenek inulÃ³faluk kivÃ¡lasztva",remove:"EltÃ¡volÃ­tÃ¡s",boosterPct:"GyorsÃ­tÃ³ szÃ¡zalÃ©kban",yes:"Igen",date:"DÃ¡tum",qntt:"MennyisÃ©g",village:"Falu",even:"Egyenletes",oneByOne:"EgyenkÃ©nt sorban",oneByOneClosest:"EgyenkÃ©nt legkÃ¶zelebb",closestToTarget:"CÃ©lpothoz legkÃ¶zelebb",assigningAttacks:"TÃ¡madÃ¡sok kiosztÃ¡sa",startAssignment:"KiosztÃ¡s indÃ­tÃ¡sa",noAlgSelected:"Nincs az elosztÃ³ algoritmus kivÃ¡lasztva!",noAttackAssigned:"Nincs egy tÃ¡madÃ¡s se kiosztva!",bbCode:"BB kÃ³d",calculaing:"SzÃ¡molÃ¡s",calculateAttack:"TÃ¡madÃ¡s kiszÃ¡mÃ­tÃ¡sa",launch:"IndÃ­tÃ¡s",target:"CÃ©lpont",targets:"CÃ©lpontok",command:"Parancs",calculateQuestion:"Biztosan szeretnÃ©d kiszÃ¡mÃ­tani?",removeQuestion:"Biztosan szeretnÃ©d eltÃ¡volÃ­tani?",resetAttackQuestion:"Biztosan szeretnÃ©d visszaÃ¡llÃ­tani az Ã¶sszes tÃ¡madÃ¡st?",launchers:"IdulÃ³ faluk",planName:"Terv neve",newTargets:"Ãšj cÃ©lpontok",all:"Ã–sszes",name:"NÃ©v",editTargets:"CÃ©lpontok szerkesztÃ©se",editArrivals:"Ã‰rkezÃ©sek szerkesztÃ©se",editTemplates:"Sablonok szerkesztÃ©se",editPalyerBoosters:"ErÅ‘sÃ­tÃ©s gyorsÃ­tÃ³k",autoAssigner:"Automata hozzÃ¡rrendelÃ©s",resetAssigments:"KiosztÃ¡sok visszaÃ¡llÃ­tÃ¡sa",size:"MÃ©ret",reset:"Vissza Ã¡ll.",addAtatck:"TÃ¡madÃ¡s hozzÃ¡adÃ¡sa",noLauncherSel:"Nincs indÃ­tÃ³falu(k) kivÃ¡lasztva!",noTargetSel:"Nincs cÃ©lpont kivÃ¡lasztva!",close:"BezÃ¡r",renamePlan:"Terv Ã¡tnevezÃ©se",editTargetsText:"CÃ©lpontok szerkesztÃ©se",editArrivalsText:"Ã‰rkezÃ©sek szerkesztÃ©se",editTemplatesText:"Sablonok szerkesztÃ©se",editBoostersText:"GyorsÃ­tÃ³k szerkesztÃ©se",attackPlan:"TÃ¡madÃ¡si terv",removeTarget:"CÃ©lpont eltÃ¡volÃ­tÃ¡sa",removeAttack:"TÃ¡madÃ¡s eltÃ¡volÃ­tÃ¡sa",addVillageBoost:"GyorsÃ­tÃ³ hozzÃ¡adÃ¡sa faluhoz",removeVillageBoost:"GyorsÃ­tÃ³ eltÃ¡volÃ­tÃ¡sa falurÃ³l",options:"BeÃ¡llÃ­tÃ¡sok",rename:"Ãtnevez",launchVillages:"IndulÃ³ faluk",page:"Oldal",search:"KeresÃ©s",PlanNotSelected:"Nincs egy terv se kivÃ¡laszva!",needPremiumFeature:"A script futtatÃ¡sÃ¡hoz prÃ©mium fiÃ³k szÃ¼ksÃ©ges!",home:"Otthon",available:"ElÃ©rhetÅ‘",groups:"Csoportok"}},"./src/view/launchDialog.ts":(e,n,a)=>{a.r(n),a.d(n,{launchDialog:()=>g});var t=a("./src/core/Api.ts"),i=a("./src/view/editArrivalsModal.ts"),l=a("./src/view/editLaunchVillagesModal.ts"),o=a("./src/view/editPlanNameModal.ts"),s=a("./src/view/editTargetModal.ts"),r=a("./src/view/editTemplatesModal.ts"),d=a("./src/view/mainWindow.ts"),c=a("./src/core/Language.ts");const g=()=>`<style>.launch-dialog{display:grid;text-align:center;}.launch-dialog option {font-size:16px;padding:2px 5px;text-align:center;}\n.launch-dialog button{margin: 10px auto;width: max-content;}\n.launch-dialog-selector{display:grid;}\n.new-plan{display:none;}\n.steps{width:100%;display:inline-flex;justify-content: space-evenly;width: 100%;padding: 10px 0;}\n.step{display:grid;}\n.circle{border-radius:50%;background: linear-gradient(to bottom, #947a62 0%,#7b5c3d 22%,#6c4824 30%,#6c4824 100%);color:white;padding: 4px 10px;font-size: 20px;cursor:pointer;z-index:2;}\n.inactive{background: linear-gradient(to bottom, #b1a397 0%, #645d56 22%, #635f5a 30%, #6c6763 100%) !important}\n.modal-input-group{display:inline-grid;text-align:center;border-bottom: solid 1px #603000;padding: 5px 0;}\n.modal-input-inline{display:block;text-align:center;border-bottom: solid 1px #603000;padding: 5px 0;}\n.modal-input-group label{margin-bottom:10px;}\n.modal-input-group input{margin-bottom:10px;}\n.modal-input-group textarea{margin-bottom:10px;}\n.modal-input-group button{margin-bottom:10px;}\n.modal-input-group input{text-align:center;font-size: 14px;}\n.modal-input-group select{text-align:center;font-size: 14px;margin-bottom:10px;}.progress-field{width:88%; position:absolute;height: 5px;background-color: black;margin-top: 13px;z-index:1;background: linear-gradient(to bottom, #b1a397 0%, #645d56 22%, #635f5a 30%, #6c6763 100%);}#progress-bar{height:100%;background: linear-gradient(to bottom, #947a62 0%,#7b5c3d 22%,#6c4824 30%,#6c4824 100%);z-index:1;}.confirm-remove button{margin:0 5px;}</style><div id="dialog-loading" style="display: none;justify-content: center;width: 100%;"><img style="height:25px" src="https://dshu.innogamescdn.com/asset/6389cdba/graphic/loading.gif"><span style="padding:5px">${(0,c.Lang)("loading")}</span></div><div class="launch-dialog"><div><h1>TW Attack Planner</h1></div><div class="launch-dialog-selector"><h3>${(0,c.Lang)("plans")}:</h3><select id="launchDialogSelect" size="5" onDblClick="launchDialog.loadPlan()">${window.Plans.map((e=>`<option value="${e.id}">${e.name}</option>`)).join("")}</select><button onclick="launchDialog.loadPlan()" class="btn">${(0,c.Lang)("loadPlan")}</button><button id="removePlan" onclick="launchDialog.confirmRemovePlan()" class="btn">${(0,c.Lang)("removePlan")}</button><div class="confirm-remove" style="display:none;"><button onclick="launchDialog.removePlan()" class="btn">${(0,c.Lang)("remove")}</button><button onclick="launchDialog.cancelRemovePlan()" class="btn">${(0,c.Lang)("cancel")}</button></div><button onclick="launchDialog.newplan()" class="btn">+ ${(0,c.Lang)("newPlan")}</button></div>\n<div class="new-plan"><div class="steps"><div class="progress-field"><div id="progress-bar" style="width:0%"></div></div><div id="c1" onclick="launchDialog.goToStep(1)" class="circle">1</div><div id="c2" class="circle inactive">2</div><div id="c3" class="circle inactive">3</div><div id="c4" class="circle inactive">4</div><div id="c5" class="circle inactive">5</div></div><div class="step-1 step"></div><div class="step-2 step" style="display:none;"></div><div class="step-3 step" style="display:none;"></div><div class="step-4 step" style="display:none;"></div><div class="step-5 step" style="display:none;"></div><button id="nextBtn" onclick="launchDialog.goNext(2)" class="btn" disabled>${(0,c.Lang)("next")}</button><button style="display:none;" id="createPlan" onclick="launchDialog.createPlan()" class="btn" disabled>${(0,c.Lang)("createPlan")}</button><button onclick="launchDialog.cancelNewPlan()" class="btn">${(0,c.Lang)("cancel")}</button></div></div>`;window.launchDialog={groupIDs:[],currentStep:0,stepCheck:()=>{if(0==$("#dialog-loading").get().length)return;let e=window.launchDialog.currentStep;switch(window.launchDialog.currentStep){case 0:if(!(window.launchDialog.plan.name.length>3&&-1==window.Plans.findIndex((e=>e.name==window.launchDialog.plan.name))))break;window.launchDialog.currentStep++;case 1:if(!(window.launchDialog.plan.targetPool.length>0))break;window.launchDialog.currentStep++;case 2:if(!(window.launchDialog.groupIDs.length>0))break;window.launchDialog.currentStep++;case 3:if(!(window.launchDialog.plan.arrivals.length>0))break;window.launchDialog.currentStep++;case 4:if(!(window.launchDialog.plan.templates.length>0))break;window.launchDialog.currentStep++}e<window.launchDialog.currentStep&&$("#nextBtn").prop("disabled",!1),5==window.launchDialog.currentStep&&$("#createPlan").prop("disabled",!1)},goToStep:e=>{$(".step-1").hide(),$(".step-2").hide(),$(".step-3").hide(),$(".step-4").hide(),$(".step-5").hide(),$(".step-"+e).show(),e<5?($("#nextBtn").attr("onclick","launchDialog.goNext("+(e+1)+")"),$("#createPlan").hide(),$("#nextBtn").show()):($("#createPlan").show(),$("#nextBtn").hide()),window.launchDialog.stepCheck()},goNext:e=>{$(".step-1").hide(),$(".step-2").hide(),$(".step-3").hide(),$(".step-4").hide(),$(".step-5").hide(),$("#c"+e).attr("onclick","launchDialog.goToStep("+e+")"),e>4?($(".step-5").show(),$("#nextBtn").hide(),$("#createPlan").show(),$("#c"+e).removeClass("inactive"),$("#progress-bar").css("width",25*(e-1)+"%")):($("#nextBtn").prop("disabled",!0),$(".step-"+e).show(),$("#c"+e).removeClass("inactive"),$("#progress-bar").css("width",25*(e-1)+"%"),e++,$("#nextBtn").attr("onclick","launchDialog.goNext("+e+")"))},newplan:()=>{$(".new-plan").show(),$(".launch-dialog-selector").hide(),window.launchDialog.currentStep=0,window.launchDialog.plan={arrivals:[],boosters:[],launchPool:[],id:(new Date).getTime().toString(),name:"",targetPool:[],templates:[]},$(".step-1").html((0,o.editPlanNameModal)(window.launchDialog.plan)),$(".step-2").html((0,s.editTargetModal)(window.launchDialog.plan.targetPool)),$(".step-3").html((0,l.editLaunchVillagesModal)(window.launchDialog.plan.launchPool)),$(".step-4").html((0,i.editArrivalsModal)(window.launchDialog.plan.arrivals)),$(".step-5").html((0,r.editTemplatesModal)(window.launchDialog.plan.templates))},cancelNewPlan:()=>{$(".step-1").show(),$(".step-2").hide(),$(".step-3").hide(),$(".step-4").hide(),$(".step-5").hide(),$("#nextBtn").attr("onclick","launchDialog.goNext(2)"),$(".new-plan").hide(),$(".launch-dialog-selector").show(),$("#c2").addClass("inactive"),$("#c3").addClass("inactive"),$("#c4").addClass("inactive"),$("#c5").addClass("inactive"),$("#createPlan").hide(),$("#nextBtn").show(),$("#template_name").val(""),$("#c2").attr("onclick",""),$("#c3").attr("onclick",""),$("#c4").attr("onclick",""),$("#c5").attr("onclick",""),$("#plan_arrivals_select").html(""),$("#plan_targets").val(""),$("#template_select").html(""),$("#temp_name").val(""),window.launchDialog.groupIDs=[],$("#plan_launcher_list").html("")},createPlan:async()=>{$("#dialog-loading").css("display","inline-flex"),$(".launch-dialog").hide(),setTimeout((async()=>{window.attackPlan=window.launchDialog.plan,window.attackPlan.launchPool=await(0,t.loadPages)(window.launchDialog.groupIDs),await window.DB.setData("plans",window.attackPlan),window.UI.SuccessMessage((0,c.Lang)("PlanSuccessfullyCreated")),setTimeout((()=>{window.Dialog.close("launchDialog"),window.Dialog.show("PlannerMainWindow",(0,d.mainWindow)()),$(".popup_box_container").append('<div style="position: fixed;width: 100%;height: 100%;top:0;left:0;z-index:12001"></div>')}),1e3)}),1e3)},loadPlan:()=>{if(null==$("#launchDialogSelect").val())return void window.UI.ErrorMessage((0,c.Lang)("PlanNotSelected"));let e=$("#launchDialogSelect").val().toString(),n=window.Plans.findIndex((n=>n.id==e));-1!=n&&($("#dialog-loading").css("display","inline-flex"),$(".launch-dialog").hide(),setTimeout((()=>{window.Dialog.close("launchDialog"),window.attackPlan=window.Plans[n],window.Dialog.show("PlannerMainWindow",(0,d.mainWindow)()),$(".popup_box_container").append('<div style="position: fixed;width: 100%;height: 100%;top:0;left:0;z-index:12001"></div>')}),1e3))},removePlan:async()=>{if(null==$("#launchDialogSelect").val())return void window.UI.ErrorMessage((0,c.Lang)("PlanNotSelected"));let e=$("#launchDialogSelect").val().toString();window.DB.removeData("plans",e);let n=await window.DB.getAllData("plans");$("#launchDialogSelect").html(`${n.map((e=>`<option value="${e.id}">${e.name}</option>`))}`),$(".confirm-remove").hide(),$("#removePlan").show()},confirmRemovePlan:()=>{null!=$("#launchDialogSelect").val()?($(".confirm-remove").show(),$("#removePlan").hide()):window.UI.ErrorMessage((0,c.Lang)("PlanNotSelected"))},cancelRemovePlan:()=>{$(".confirm-remove").hide(),$("#removePlan").show()},plan:void 0}},"./src/view/launchItem.ts":(e,n,a)=>{a.r(n),a.d(n,{launchItem:()=>i});var t=a("./src/core/Api.ts");const i=e=>{e.popSize=(0,t.calcUnitPop)(e.unitsContain);let n="small";e.popSize>1e3&&e.popSize<=5e3?n="medium":e.popSize>5e3&&(n="large");let a=Object.keys(e.unitsContain);return`<div class="launch-item" id="${e.id}"><div class="name-field"><a href="/game.php?village=${t.game.village.id}&screen=info_village&id=${e.id}" target="_blank">${e.name} (${e.coord.text}) K${e.kontinent}</a></div><div class="check-field"><input type="checkbox" value="${e.id}"><img src="https://dshu.innogamescdn.com/asset/72737c96/graphic/command/attack_${n}.png"></div>${a.map((n=>{if(0!=window.gameConfig.game.archer||"archer"!=n&&"marcher"!=n)return`<div class="${n}-field ${0==e.unitsContain[n]?"hidden":""}">${e.unitsContain[n]}</div>`})).join("")}</div>`}},"./src/view/mainWindow.ts":(e,n,a)=>{a.r(n),a.d(n,{mainWindow:()=>f});var t=a("./src/core/Api.ts"),i=a("./src/core/Language.ts"),l=a("./src/core/Query.ts"),o=a("./src/view/addAttackModal.ts"),s=a("./src/view/addPlayerSpeedModal.ts"),r=a("./src/view/autoAssignModal.ts"),d=a("./src/view/calculatedAttackModal.ts"),c=a("./src/view/confirmCalculateAttackModal.ts"),g=a("./src/view/confirmResetAssignmentsModal.ts"),p=a("./src/view/editArrivalsModal.ts"),u=a("./src/view/editPlanNameModal.ts"),h=a("./src/view/editTargetModal.ts"),m=a("./src/view/editTemplatesModal.ts"),v=a("./src/view/launchItem.ts"),w=a("./src/view/targetItem.ts");const f=()=>`<style>::-webkit-scrollbar {width: 5px;}/* Track */::-webkit-scrollbar-track {box-shadow: inset 0 0 5px grey;border-radius: 10px;}/* Handle */::-webkit-scrollbar-thumb {background: grey;border-radius: 10px;}\n.mainWindow{width: 100%;height:85vh;}.popup_box_container{height:100% !important;}#popup_box_PlannerMainWindow{width: 95vw !important;}html{overflow: hidden !important;}.container {height: calc(100% - 10px);border: solid 2px #6c4824;border-radius:20px;display: grid;grid-template-columns: 260px 1.3fr 1.3fr;grid-template-rows: 30px 3fr [option] 0.1fr;gap: 0px 0px;grid-auto-flow: row;}\n.options-title { grid-area: 1 / 1 / 2 / 2; border-top-left-radius: 20px;border-right: solid 2px #6c4824;border-bottom: solid 2px #6c4824;}\n.options-panel {border-right: solid 2px #6c4824;display: table;}\n.target-title { grid-area: 1 / 2 / 2 / 3; border-right: solid 1px #6c4824;border-bottom: solid 2px #6c4824;}\n.target-panel { grid-area: 2 / 2 / 4 / 3; border-right: solid 1px #6c4824;\ndisplay: grid; grid-template-columns: 1fr; grid-template-rows: 30px 1fr; gap: 0px 0px; grid-template-areas: "target-header""target-list";}\n.target-header {grid-area: target-header; }.target-list { grid-area: target-list; overflow-y:auto; }\n.launch-title { grid-area: 1 / 3 / 2 / 4;border-top-right-radius: 20px;border-left: solid 1px #6c4824;border-bottom: solid 2px #6c4824;display: flex;flex-wrap: nowrap;justify-content: space-evenly;align-items: flex-start;align-content: flex-start;flex-direction: row;}\n.launch-panel { grid-area: 2 / 3 / 4 / 4; border-left: solid 1px #6c4824;display: grid; grid-template-columns: 1fr; grid-template-rows: 30px 1fr; gap: 0px 0px; grid-template-areas: "launch-header""launch-list"; }\n.launch-list {overflow-y:scroll;border-bottom-right-radius: 20px;grid-area: launch-list; display: block;}.launch-header { padding-right:5px;background: linear-gradient(to bottom,#e2c07c 0%,#dab874 44%,#c1a264 100%);grid-area: launch-header;display: grid;grid-template-columns:  1fr 1fr 1fr 1fr${1==window.gameConfig.game.archer?" 1fr":""} 1fr 1fr${1==window.gameConfig.game.archer?"1fr":""} 1fr 1fr 1fr 1fr 1fr; grid-template-rows: 30px;gap: 0px;grid-template-areas: "size-icon spear-icon sword-icon axe-icon${1==window.gameConfig.game.archer?" archer-icon":""} spy-icon light-icon${1==window.gameConfig.game.archer?" marcher-icon":""} heavy-icon ram-icon catapult-icon pala-icon snob-icon"}\n.target-launch-header { background: linear-gradient(to bottom,#e2c07c 0%,#dab874 44%,#c1a264 100%);grid-area: launch-header;display: grid;grid-template-columns:  30px 1fr 1fr 1fr${1==window.gameConfig.game.archer?" 1fr":""} 1fr 1fr${1==window.gameConfig.game.archer?" 1fr":""} 1fr 1fr 1fr 1fr 1fr 30px; grid-template-rows: 30px;gap: 0px;grid-template-areas: "size-icon spear-icon sword-icon axe-icon${1==window.gameConfig.game.archer?" archer-icon":""} spy-icon light-icon${1==window.gameConfig.game.archer?" marcher-icon":""} heavy-icon ram-icon catapult-icon pala-icon snob-icon del-icon"}\n.target-launch-header div {padding: 5px;}\n.target-launch-header img {margin: 0 auto;display: block;}\n\n.credits { grid-area: option / 1 / 4 / 2; border-right: solid 2px #6c4824; padding:10px;}\n.header {background: linear-gradient(to bottom,#e2c07c 0%,#dab874 44%,#c1a264 100%);text-align: center;padding:3px;}\n.launch-header div{padding: 5px;}.launch-header img{margin: 0 auto;display: block;cursor: pointer;}\n.size-icon { grid-area: size-icon; }.spear-icon { grid-area: spear-icon; }.sword-icon { grid-area: sword-icon; }.axe-icon { grid-area: axe-icon; }.archer-icon { grid-area: archer-icon; }.spy-icon { grid-area: spy-icon; }.light-icon { grid-area: light-icon; }.marcher-icon { grid-area: marcher-icon; }.heavy-icon { grid-area: heavy-icon; }.ram-icon { grid-area: ram-icon; }.catapult-icon { grid-area: catapult-icon; }.pala-icon { grid-area: pala-icon; }.snob-icon { grid-area: snob-icon; }.del-icon { grid-area: del-icon; }\n.option-item{width:100%;margin: 15px 0;}.option-item button{height: 30px;margin: 0 auto;display: block;min-width: 85%;}.option-item h2{text-align:center;}\n.header-count{margin-left:10px;display: inline;}\n.header-count span{font-weight: bold;padding: 0 2px;}\n.btn-add-attack{font-size: 30px !important;padding: 0;line-height: 20px;}</style><style>.targetsLauncher-item{height: max-content;border-top: solid 1px #6c4824;border-bottom: solid 1px #6c4824;margin-top:3px;text-align:center;display: grid; grid-template-columns:  30px 1fr 1fr 1fr${1==window.gameConfig.game.archer?" 1fr":""} 1fr 1fr${1==window.gameConfig.game.archer?" 1fr":""} 1fr 1fr 1fr 1fr 1fr 30px; grid-template-rows: 35px 30px ;gap: 0px 0px; grid-template-areas: "size-field name-field name-field name-field${1==window.gameConfig.game.archer?" name-field":""} name-field name-field${1==window.gameConfig.game.archer?" name-field":""} name-field name-field name-field name-field name-field del-field""size-field spear-field sword-field axe-field${1==window.gameConfig.game.archer?" archer-field":""} spy-field light-field${1==window.gameConfig.game.archer?" marcher-field":""} heavy-field ram-field catapult-field knight-field snob-field del-field";}.del-field{ grid-area: del-field; padding: 20px 5px;background-color:#fff5dc;border-left: 1px solid #6c4824;}.size-field{ grid-area: size-field; padding: 5px 8px;background-color:#fff5dc;border-right: 1px solid #6c4824;}\n.launch-item{height: max-content;border-top: solid 1px #6c4824;border-bottom: solid 1px #6c4824;margin-top:3px;text-align:center;display: grid; grid-template-columns:  1fr 1fr 1fr 1fr${1==window.gameConfig.game.archer?" 1fr":""} 1fr 1fr${1==window.gameConfig.game.archer?" 1fr":""} 1fr 1fr 1fr 1fr 1fr;grid-template-rows: 30px 30px ;gap: 0px 0px; grid-template-areas:"check-field name-field name-field name-field${1==window.gameConfig.game.archer?"name-field":""} name-field name-field${1==window.gameConfig.game.archer?" name-field":""} name-field name-field name-field name-field name-field""check-field spear-field sword-field axe-field${1==window.gameConfig.game.archer?" archer-field":""} spy-field light-field${1==window.gameConfig.game.archer?" marcher-field":""}  heavy-field ram-field catapult-field knight-field snob-field";}\n.check-field input{height:16px;width:16px;float:left;}\n.check-field img{height: 16px;float:right;padding-right:3px;}\n.size-field img{height: 16px;float:right;padding: 15px 0;}\n.del-field .remove-target-btn{margin: 0 !important;}\n.check-field { grid-area: check-field; padding: 20px 0; background-color:#fff5dc; border-right:1px solid #6c4824}.spear-field { grid-area: spear-field; padding: 5px 0;background-color:#fff5dc}.sword-field { grid-area: sword-field; padding: 5px 0;background-color:#fff5dc}.axe-field { grid-area: axe-field; padding: 5px 0;background-color:#fff5dc}.archer-field { grid-area: archer-field; padding: 5px 0;background-color:#fff5dc}.spy-field { grid-area: spy-field; padding: 5px 0;background-color:#fff5dc}.light-field { grid-area: light-field; padding: 5px 0;background-color:#fff5dc}.marcher-field { grid-area: marcher-field; padding: 5px 0;background-color:#fff5dc}.heavy-field { grid-area: heavy-field; padding: 5px 0;background-color:#fff5dc}.ram-field { grid-area: ram-field; padding: 5px 0;background-color:#fff5dc}.catapult-field { grid-area: catapult-field; padding: 5px 0;background-color:#fff5dc}.knight-field { grid-area: knight-field; padding: 5px 0;background-color:#fff5dc}.snob-field { grid-area: snob-field; padding: 5px 0;background-color:#fff5dc}.name-field { display:grid;grid-area: name-field;color: #603000;font-weight: bold;background-color:#ecd8b2;padding: 5px 0;}.target-item{overflow-x:hidden;display: block;width:100%;margin: 5px 0;border-top: solid 1px #6c4824;border-bottom: solid 1px #6c4824;}.target-header{height:35px;width:100%;display: flex;\n\t            justify-content: space-around;background-color: #ecd8b2;cursor: pointer;}\n.target-header div{padding-top: 9px;padding-bottom: 9px;}\n.target-village-name{color: #603000;font-weight: bold;}.target-extras{flex-grow: 1;}\n.target-launchers{display:none;width:100%;min-height:20px;background-color: #fff5dc;}\n.remove-target-btn {float: right;z-index: 2;width: 20px;height: 20px;background: url(https://dshu.innogamescdn.com/asset/80b013af/graphic/login_close.png) top left no-repeat;cursor: pointer;background-size: 20px;margin-right: 10px;}.add-village-booster{background: url(https://klanhaboru.hu/graphic/plus.png) top left no-repeat;height: 16px;width: 16px;margin-left: 5px;cursor: pointer;display: inline-block;vertical-align: middle;}\n.indicator{font-size: 16px;padding-left: 5px;padding-right: 5px;transform: translateY(-2px);}\n.indicator-open{transform: rotate(90deg);}\n.planner-modal {background: transparent url(https://dshu.innogamescdn.com/asset/fd86cac8/graphic/index/contentbg.png) scroll left top repeat;filter: drop-shadow(0 0 0.75rem rgb(88, 88, 88));width: max-content;height: fit-content;max-height: calc(100vh - 120px);border: 2px solid #6c4824;position: absolute;top: 0;bottom: 0;left: 0;right: 0;margin: auto;border-radius: 10px;z-index: 100001;display: grid;align-content: space-evenly;grid-template-areas:'header''content';grid-template-rows: 30px calc(100% - 30px);}\n.planner-modal-header {font-size:16px;border-top-left-radius: 10px;border-top-right-radius: 10px;padding: 5px;grid-area: header;text-align: center;background: linear-gradient(to bottom,#e2c07c 0%,#dab874 44%,#c1a264 100%);}\n.planner-modal-content {display:grid;grid-area: content;padding: 10px;}\n.modal-input-group{display:inline-grid;text-align:center;border-bottom: solid 1px #603000;padding: 5px 0;}\n.modal-input-inline{display:block;text-align:center;border-bottom: solid 1px #603000;padding: 5px 0;}\n.modal-input-group label{margin-bottom:10px;}\n.modal-input-group input{margin-bottom:10px;}\n.modal-input-group textarea{margin-bottom:10px;}\n.modal-input-group button{margin-bottom:10px;}\n.modal-input-group input{text-align:center;font-size: 14px;}\n.modal-input-group select{text-align:center;font-size: 14px;margin-bottom:10px;}.del-boost {background: url(https://klanhaboru.hu/graphic/minus.png) top left no-repeat;height: 16px;width: 16px;margin-left: 5px;cursor: pointer;display: inline-block;vertical-align: middle;}\n.booster-button {display: inline;}\n.launch-search-bar{display: inline-block;\n}\n.launch-search-bar input{width:60px;font-size:12px;}\n.remove-search-btn {float: right;z-index: 2;width: 20px;height: 20px;background: url(https://dshu.innogamescdn.com/asset/80b013af/graphic/login_close.png) top left no-repeat;cursor: pointer;background-size: 20px;}.qr-row{height:fit-content}\n</style><link rel="stylesheet" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css"><script>$.widget("ui.accordion",{version:"1.12.1",options:{active:0,animate:{},classes:{"ui-accordion-header":"ui-corner-top","ui-accordion-header-collapsed":"ui-corner-all","ui-accordion-content":"ui-corner-bottom"},collapsible:!1,event:"click",header:"> li > :first-child, > :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var a=this.options;this.prevShow=this.prevHide=$(),this._addClass("ui-accordion","ui-widget ui-helper-reset"),this.element.attr("role","tablist"),a.collapsible|| !1!==a.active&&null!=a.active||(a.active=0),this._processPanels(),a.active<0&&(a.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():$()}},_createIcons:function(){var b,c,a=this.options.icons;a&&(b=$("<span>"),this._addClass(b,"ui-accordion-header-icon","ui-icon "+a.header),b.prependTo(this.headers),c=this.active.children(".ui-accordion-header-icon"),this._removeClass(c,a.header)._addClass(c,null,a.activeHeader)._addClass(this.headers,"ui-accordion-icons"))},_destroyIcons:function(){this._removeClass(this.headers,"ui-accordion-icons"),this.headers.children(".ui-accordion-header-icon").remove()},_destroy:function(){var a;this.element.removeAttr("role"),this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId(),this._destroyIcons(),a=this.headers.next().css("display","").removeAttr("role aria-hidden aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&a.css("height","")},_setOption:function(a,b){if("active"===a){this._activate(b);return}"event"===a&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(b)),this._super(a,b),"collapsible"!==a||b|| !1!==this.options.active||this._activate(0),"icons"===a&&(this._destroyIcons(),b&&this._createIcons())},_setOptionDisabled:function(a){this._super(a),this.element.attr("aria-disabled",a),this._toggleClass(null,"ui-state-disabled",!!a),this._toggleClass(this.headers.add(this.headers.next()),null,"ui-state-disabled",!!a)},_keydown:function(b){if(!b.altKey&&!b.ctrlKey){var a=$.ui.keyCode,d=this.headers.length,e=this.headers.index(b.target),c=!1;switch(b.keyCode){case a.RIGHT:case a.DOWN:c=this.headers[(e+1)%d];break;case a.LEFT:case a.UP:c=this.headers[(e-1+d)%d];break;case a.SPACE:case a.ENTER:this._eventHandler(b);break;case a.HOME:c=this.headers[0];break;case a.END:c=this.headers[d-1]}c&&($(b.target).attr("tabIndex",-1),$(c).attr("tabIndex",0),$(c).trigger("focus"),b.preventDefault())}},_panelKeyDown:function(a){a.keyCode===$.ui.keyCode.UP&&a.ctrlKey&&$(a.currentTarget).prev().trigger("focus")},refresh:function(){var a=this.options;this._processPanels(),(!1!==a.active|| !0!==a.collapsible)&&this.headers.length?!1===a.active?this._activate(0):this.active.length&&!$.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(a.active=!1,this.active=$()):this._activate(Math.max(0,a.active-1)):a.active=this.headers.index(this.active):(a.active=!1,this.active=$()),this._destroyIcons(),this._refresh()},_processPanels:function(){var b=this.headers,a=this.panels;this.headers=this.element.find(this.options.header),this._addClass(this.headers,"ui-accordion-header ui-accordion-header-collapsed","ui-state-default"),this.panels=this.headers.next().filter(":not(.ui-accordion-content-active)").hide(),this._addClass(this.panels,"ui-accordion-content","ui-helper-reset ui-widget-content"),a&&(this._off(b.not(this.headers)),this._off(a.not(this.panels)))},_refresh:function(){var a,b=this.options,c=b.heightStyle,d=this.element.parent();this.active=this._findActive(b.active),this._addClass(this.active,"ui-accordion-header-active","ui-state-active")._removeClass(this.active,"ui-accordion-header-collapsed"),this._addClass(this.active.next(),"ui-accordion-content-active"),this.active.next().show(),this.headers.attr("role","tab").each(function(){var a=$(this),c=a.uniqueId().attr("id"),b=a.next(),d=b.uniqueId().attr("id");a.attr("aria-controls",d),b.attr("aria-labelledby",c)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(b.event),"fill"===c?(a=d.height(),this.element.siblings(":visible").each(function(){var b=$(this),c=b.css("position");"absolute"!==c&&"fixed"!==c&&(a-=b.outerHeight(!0))}),this.headers.each(function(){a-=$(this).outerHeight(!0)}),this.headers.next().each(function(){$(this).height(Math.max(0,a-$(this).innerHeight()+$(this).height()))}).css("overflow","auto")):"auto"===c&&(a=0,this.headers.next().each(function(){var b=$(this).is(":visible");b||$(this).show(),a=Math.max(a,$(this).css("height","").height()),b||$(this).hide()}).height(a))},_activate:function(b){var a=this._findActive(b)[0];a!==this.active[0]&&(a=a||this.active[0],this._eventHandler({target:a,currentTarget:a,preventDefault:$.noop}))},_findActive:function(a){return"number"==typeof a?this.headers.eq(a):$()},_setupEvents:function(a){var b={keydown:"_keydown"};a&&$.each(a.split(" "),function(c,a){b[a]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,b),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(e){var f,g,a=this.options,c=this.active,b=$(e.currentTarget),d=b[0]===c[0],h=d&&a.collapsible,j=h?$():b.next(),k=c.next(),i={oldHeader:c,oldPanel:k,newHeader:h?$():b,newPanel:j};e.preventDefault(),(!d||a.collapsible)&& !1!==this._trigger("beforeActivate",e,i)&&(a.active=!h&&this.headers.index(b),this.active=d?$():b,this._toggle(i),this._removeClass(c,"ui-accordion-header-active","ui-state-active"),a.icons&&(f=c.children(".ui-accordion-header-icon"),this._removeClass(f,null,a.icons.activeHeader)._addClass(f,null,a.icons.header)),d||(this._removeClass(b,"ui-accordion-header-collapsed")._addClass(b,"ui-accordion-header-active","ui-state-active"),a.icons&&(g=b.children(".ui-accordion-header-icon"),this._removeClass(g,null,a.icons.header)._addClass(g,null,a.icons.activeHeader)),this._addClass(b.next(),"ui-accordion-content-active")))},_toggle:function(c){var b=c.newPanel,a=this.prevShow.length?this.prevShow:c.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=b,this.prevHide=a,this.options.animate?this._animate(b,a,c):(a.hide(),b.show(),this._toggleComplete(c)),a.attr({"aria-hidden":"true"}),a.prev().attr({"aria-selected":"false","aria-expanded":"false"}),b.length&&a.length?a.prev().attr({tabIndex:-1,"aria-expanded":"false"}):b.length&&this.headers.filter(function(){return 0===parseInt($(this).attr("tabIndex"),10)}).attr("tabIndex",-1),b.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(a,e,j){var h,b,c,k=this,l=0,m=a.css("box-sizing"),i=a.length&&(!e.length||a.index()<e.index()),f=this.options.animate||{},d=i&&f.down||f,g=function(){k._toggleComplete(j)};return("number"==typeof d&&(c=d),"string"==typeof d&&(b=d),b=b||d.easing||f.easing,c=c||d.duration||f.duration,e.length)?a.length?void(h=a.show().outerHeight(),e.animate(this.hideProps,{duration:c,easing:b,step:function(a,b){b.now=Math.round(a)}}),a.hide().animate(this.showProps,{duration:c,easing:b,complete:g,step:function(b,a){a.now=Math.round(b),"height"!==a.prop?"content-box"===m&&(l+=a.now):"content"!==k.options.heightStyle&&(a.now=Math.round(h-e.outerHeight()-l),l=0)}})):e.animate(this.hideProps,c,b,g):a.animate(this.showProps,c,b,g)},_toggleComplete:function(b){var a=b.oldPanel,c=a.prev();this._removeClass(a,"ui-accordion-content-active"),this._removeClass(c,"ui-accordion-header-active")._addClass(c,"ui-accordion-header-collapsed"),a.length&&(a.parent()[0].className=a.parent()[0].className),this._trigger("activate",null,b)}});<\/script><div class="mainWindow"><div class="container"><div class="options-title header"><h3>${(0,i.Lang)("options")}</h3></div><div class="options-panel"><div class="option-item"><h2 style="font-size: 1rem;"><span id="open-plan-name">${window.attackPlan.name}</span><a onclick="window.editName()" class="rename-icon" href="#" data-title="rename"></a></h2></div><div class="option-item"><button onclick="window.editTargets()" class="btn">${(0,i.Lang)("editTargets")}</button></div><div class="option-item"><button onclick="window.editArrivals()" class="btn">${(0,i.Lang)("editArrivals")}</button></div><div class="option-item"><button onclick="window.editTemplates()" class="btn">${(0,i.Lang)("editTemplates")}</button></div><div class="option-item"><button onclick="window.editPlayerBoosts()" class="btn">${(0,i.Lang)("editPalyerBoosters")}</button></div><div class="option-item"><button onclick="window.openAutoAssignModal()" class="btn">${(0,i.Lang)("autoAssigner")}</button></div><div class="option-item"><button onclick="window.calculateAttack()" class="btn">${(0,i.Lang)("calculateAttack")}</button></div><div class="option-item"><button onclick="window.resetAssignments()" class="btn">${(0,i.Lang)("resetAssigments")}</button></div></div><div class="target-title header"><h3>${(0,i.Lang)("targets")} (<span id="target-cnt"></span>)</h3></div><div class="target-panel"><div class="target-header"></div><div class="target-list"></div></div><div class="launch-title header"><div class="launch-filter-bar"><button onclick="window.launchVillagesQuery.order('coord.text')" class="btn">XY</button><button onclick="window.launchVillagesQuery.order('name')" class="btn">${(0,i.Lang)("name")}</button></div><h3>${(0,i.Lang)("launchVillages")} (<span id="launch-cnt"></span>)</h3><div class="launch-filter-bar"><button onclick="window.launchVillagesQuery.order('popSize')" class="btn">${(0,i.Lang)("size")}</button><div class="launch-search-bar"><input id="search-bar" onkeyup="window.launchVillagesQuery.search(this)" placeholder="${(0,i.Lang)("search")}" type="text"><button onclick="window.launchVillagesQuery.resetAll()" class="btn">${(0,i.Lang)("reset")}</button></div></div></div><div class="launch-panel"><div class="launch-header"><div class="size-icon"><button onclick="window.openAddLauncherWindow()" class="btn btn-add-attack">â¬…</button></div><div class="spear-icon"><img onclick="window.launchVillagesQuery.order('unitsContain.spear')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_spear.png"></div><div class="sword-icon"><img onclick="window.launchVillagesQuery.order('unitsContain.sword')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_sword.png"></div><div class="axe-icon"><img onclick="window.launchVillagesQuery.order('unitsContain.axe')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_axe.png"></div>${1==window.gameConfig.game.archer?'<div class="archer-icon"><img onclick="window.launchVillagesQuery.order(\'unitsContain.archer\')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_archer.png"></div>':""}<div class="spy-icon"><img onclick="window.launchVillagesQuery.order('unitsContain.spy')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_spy.png"></div><div class="light-icon"><img onclick="window.launchVillagesQuery.order('unitsContain.light')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_light.png"></div>${1==window.gameConfig.game.archer?'<div class="marcher-icon"><img onclick="window.launchVillagesQuery.order(\'unitsContain.marcher\')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_marcher.png"></div>':""}<div class="heavy-icon"><img onclick="window.launchVillagesQuery.order('unitsContain.heavy')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_heavy.png"></div><div class="ram-icon"><img onclick="window.launchVillagesQuery.order('unitsContain.ram')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_ram.png"></div><div class="catapult-icon"><img onclick="window.launchVillagesQuery.order('unitsContain.catapult')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_catapult.png"></div><div class="pala-icon"><img onclick="window.launchVillagesQuery.order('unitsContain.pala')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_knight.png"></div><div class="snob-icon"><img onclick="window.launchVillagesQuery.order('unitsContain.snob')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_snob.png"></div></div><div class="launch-list"></div></div><div class="credits"><b>v0.1.5-beta</b> [${(0,t.formatDate)(1745097678551)}];<br> Dev: toldi26<a href="https://github.com/KincsesBence/TW-attack-planner" target="_blank"><img height="20" width="20" style="padding:0 5px;transform: translateY(5px);" src="https://github.com/fluidicon.png"></a></div></div></div><div class="planner-modal" style="display:none;"><div class="planner-modal-header"><b></b></div><div class="planner-modal-content"> </div></div><script>window.mainInit();<\/script>`;window.mainInit=()=>{console.log(window.attackPlan.launchPool),window.launchVillagesQuery=new l.Query(window.attackPlan.launchPool,$(".launch-list").get()[0],$("#launch-cnt").get()[0],v.launchItem,"name"),window.launchVillagesQuery.render(),window.targetPoolQuery=new l.Query(window.attackPlan.targetPool,$(".target-list").get()[0],$("#target-cnt").get()[0],w.targetItem,"village.name"),window.targetPoolQuery.render()},window.openAddLauncherWindow=()=>{0!=$('input[name="target"]:checked').get().length&&0!=$('input[name="target"]:checked').get().length?0!=$(".launch-list").find("input:checked").get().length?window.createModal((0,o.addAttackModal)(),(0,i.Lang)("addAtatck")):window.UI.ErrorMessage((0,i.Lang)("noLauncherSel")):window.UI.ErrorMessage((0,i.Lang)("noTargetSel"))},window.createModal=(e,n)=>{let a=`<div id="plannerCloseBtn" class="modal-input-inline"><button class="btn" onclick="window.closeModal()">${(0,i.Lang)("close")}</button></div>`;$(".planner-modal-header b").text(n),$(".planner-modal-content").html(e+a),$(".planner-modal").show()},window.closeModal=()=>{$(".planner-modal-header b").text(""),$(".planner-modal-content").html(""),$(".planner-modal").hide()},window.editName=()=>{window.createModal((0,u.editPlanNameModal)(window.attackPlan),(0,i.Lang)("renamePlan"))},window.editTargets=()=>{window.createModal((0,h.editTargetModal)(window.attackPlan.targetPool),(0,i.Lang)("editTargetsText"))},window.editArrivals=()=>{window.createModal((0,p.editArrivalsModal)(window.attackPlan.arrivals),(0,i.Lang)("editArrivalsText"))},window.editTemplates=()=>{window.createModal((0,m.editTemplatesModal)(window.attackPlan.templates),(0,i.Lang)("editTemplatesText"))},window.editPlayerBoosts=()=>{window.createModal((0,s.addPlayerSpeedModal)(),(0,i.Lang)("editBoostersText"))},window.calculateAttack=()=>{let e=0;window.attackPlan.targetPool.forEach((n=>{n.launchers.forEach((n=>{e++}))})),0!=e?window.createModal((0,c.confirmCalculateAttackModal)(),(0,i.Lang)("calculateAttack")):window.UI.ErrorMessage((0,i.Lang)("noAttackAssigned"))},window.confirmCalculateAttack=()=>{window.createModal((0,d.calculatedAttackModal)(),(0,i.Lang)("attackPlan"))},window.openAutoAssignModal=()=>{window.autoAssign.assignTypes=[],window.autoAssign.launchPoolCopy=structuredClone(window.attackPlan.launchPool),window.createModal((0,r.autoAssignModal)(),(0,i.Lang)("autoAssigner"))},window.resetAssignments=()=>{window.createModal((0,g.confirmResetAssignmentsModal)(),(0,i.Lang)("resetAssigments"))}},"./src/view/targetItem.ts":(e,n,a)=>{a.r(n),a.d(n,{targetItem:()=>c});var t=a("./src/core/Api.ts"),i=a("./src/core/Language.ts"),l=a("./src/view/ConfirmVillageSpeedRemoveModal.ts"),o=a("./src/view/addVillageSpeedModal.ts"),s=a("./src/view/confirmRemoveModal.ts"),r=a("./src/view/confirmRemoveTargetModal.ts"),d=a("./src/view/targetsLauncher.ts");const c=e=>{let n=0,a=0,i=0,l=0,o=0;return e.launchers.forEach((e=>{e.village.popSize<=1e3?a++:e.village.popSize>1e3&&e.village.popSize<=5e3?i++:e.village.popSize>5e3&&l++,e.isAttack||o++,n+=e.village.unitsContain.snob})),`<div id="${e.village.id}" class="target-item"><div onclick="targetItem.toggleTargetItem(this)" class="target-header"><div class="target-radio"><input value="${e.village.id}" onclick="targetItem.selectTargetItem(event)" type="radio" name="target" ${e.isSelected?"checked":""}/></div><div class="indicator ${e.isOpen?"indicator-open":""}"><span >â–¶<span></div><div class="target-village-name"><a target="_blank" href="/game.php?village=${t.game.village.id}&screen=info_village&id=${e.village.id}">${e.village.name}(${e.village.coord.text}) K${e.village.kontinent}</a></div><div class="target-extras">${e.booster>0?`<div class="booster-button">( ${e.booster}% <img height="15" src="https://dshu.innogamescdn.com/asset/f9cb54f8/graphic/items/3005.png">) <a class="del-boost" onclick="targetItem.removeVillageBooster(event,${e.village.id})"></a></div>`:`<a onclick="targetItem.addVillageBooster(event,${e.village.id})" class="add-village-booster"></a>`}<div class="header-count">${n>0?`<img height="14px" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_snob.png"><span>${n}<span>`:""}${l>0?`<img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/command/attack_large.png"><span>${l}<span>`:""}${i>0?`<img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/command/attack_medium.png"><span>${i}<span>`:""}${a>0?`<img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/command/attack_small.png"><span>${a}<span>`:""}${o>0?`<img src="https://dshu.innogamescdn.com/asset/69990994/graphic/command/support.png"><span>${o}<span>`:""}</div></div><div><a onclick="targetItem.removeTargetItem(event,${e.village.id})" class="remove-target-btn"></a></div></div><div class="target-launchers" style="display: ${e.isOpen?"block":"none"};"><div class="target-launch-header"><div class="spear-icon"><img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_spear.png"></div><div class="sword-icon"><img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_sword.png"></div><div class="axe-icon"><img  src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_axe.png"></div>${0==window.gameConfig.game.archer?"":'<div class="archer-icon"><img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_archer.png"></div>'}<div class="spy-icon"><img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_spy.png"></div><div class="light-icon"><img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_light.png"></div>${0==window.gameConfig.game.archer?"":'<div class="marcher-icon"><img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_marcher.png"></div>'}<div class="heavy-icon"><img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_heavy.png"></div><div class="ram-icon"><img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_ram.png"></div><div class="catapult-icon"><img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_catapult.png"></div><div class="pala-icon"><img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_knight.png"></div><div class="snob-icon"><img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_snob.png"></div><div class="del-icon"></div> </div>${e.launchers.map((n=>(0,d.targetsLauncher)(n,e.village.id))).join("")}</div></div>`};window.targetItem={toggleTargetItem:e=>{$(e).parent().find(".target-launchers").toggle(),$(e).find(".indicator").toggleClass("indicator-open"),$(e).find("input").prop("checked",!0);let n=parseInt($(e).parent().attr("id")),a=window.attackPlan.targetPool.findIndex((e=>e.village.id==n));window.attackPlan.targetPool[a].isOpen=!window.attackPlan.targetPool[a].isOpen},selectTargetItem:e=>{let n=parseInt($(e.target).parent().parent().parent().attr("id"));window.attackPlan.targetPool.forEach((e=>{e.village.id==n?(e.isSelected=!0,e.isOpen=!0):e.isSelected=!1})),e.stopPropagation(),$(e.target).parent().parent().parent().find(".target-launchers").toggle(),$(e.target).parent().parent().find(".indicator").toggleClass("indicator-open")},removeTargetItem:(e,n)=>{e.stopPropagation(),$(".planner-modal-header b").text((0,i.Lang)("removeTarget")),$(".planner-modal-content").html((0,r.confirmRemoveTargetModal)(n)),$(".planner-modal").show()},confirmRemoveTargetItem:e=>{let n=[],a=window.attackPlan.targetPool.findIndex((n=>n.village.id==e)),i=!1;a<-1||(window.attackPlan.targetPool[a].launchers.forEach((e=>{let a=window.attackPlan.launchPool.findIndex((n=>n.id==e.village.id));if(-1==a){let n={...e.village};window.attackPlan.launchPool.push(n),i=!0}else[window.attackPlan.launchPool[a].unitsContain,e.village.unitsContain]=(0,t.TroopTransaction)(window.attackPlan.launchPool[a].unitsContain,e.village.unitsContain,e.village.unitsContain),n.push(e.village)})),i?window.launchVillagesQuery.resetAll():window.launchVillagesQuery.partialRender(n,"id"),window.attackPlan.targetPool.splice(a,1),window.targetPoolQuery.resetAll(),window.closeModal(),(0,t.savePlan)())},removeTargetLauncherItem:(e,n)=>{$(".planner-modal-header b").text((0,i.Lang)("removeAttack")),$(".planner-modal-content").html((0,s.confirmRemoveModal)(e,n)),$(".planner-modal").show()},confirmRemoveTargetLauncherItem:(e,n)=>{let a=[],i=window.attackPlan.targetPool.findIndex((e=>e.village.id==n));if(i<-1)return;let l=window.attackPlan.targetPool[i].launchers.findIndex((n=>n.village.id==e));if(l<-1)return;let o=window.attackPlan.launchPool.findIndex((n=>n.id==e));if(-1==o){let e={...window.attackPlan.targetPool[i].launchers[l].village};window.attackPlan.launchPool.push(e),window.attackPlan.targetPool[i].launchers.splice(l,1),window.launchVillagesQuery.resetAll()}else[window.attackPlan.launchPool[o].unitsContain,window.attackPlan.targetPool[i].launchers[l].village.unitsContain]=(0,t.TroopTransaction)(window.attackPlan.launchPool[o].unitsContain,window.attackPlan.targetPool[i].launchers[l].village.unitsContain,window.attackPlan.targetPool[i].launchers[l].village.unitsContain),console.log(window.attackPlan.launchPool[o].unitsContain,window.attackPlan.targetPool[i].launchers[l].village.unitsContain),a.push(window.attackPlan.launchPool[o]),window.attackPlan.targetPool[i].launchers.splice(l,1);window.launchVillagesQuery.partialRender(a,"id"),window.targetPoolQuery.partialRender([window.attackPlan.targetPool[i]],"village.id"),window.closeModal(),(0,t.savePlan)()},addVillageBooster:(e,n)=>{e.stopPropagation(),$(".planner-modal-header b").text((0,i.Lang)("addVillageBoost")),$(".planner-modal-content").html((0,o.addVillageBoosterModal)(n)),$(".planner-modal").show()},confirmAddVillageBooster:e=>{let n=window.attackPlan.targetPool.findIndex((n=>n.village.id==e));n<-1||(window.attackPlan.targetPool[n].booster=parseInt($("#planner-village-boost").val().toString()),window.closeModal(),window.targetPoolQuery.partialRender([window.attackPlan.targetPool[n]],"village.id"),(0,t.savePlan)())},removeVillageBooster:(e,n)=>{e.stopPropagation(),$(".planner-modal-header b").text((0,i.Lang)("removeVillageBoost")),$(".planner-modal-content").html((0,l.ConfirmVillageSpeedRemoveModal)(n)),$(".planner-modal").show()},confirmRemoveVillageBooster:e=>{window.closeModal();let n=window.attackPlan.targetPool.findIndex((n=>n.village.id==e));n<-1||(window.attackPlan.targetPool[n].booster=0,window.closeModal(),window.targetPoolQuery.partialRender([window.attackPlan.targetPool[n]],"village.id"),(0,t.savePlan)())}}},"./src/view/targetsLauncher.ts":(e,n,a)=>{a.r(n),a.d(n,{targetsLauncher:()=>i});var t=a("./src/core/Api.ts");const i=(e,n)=>{let a="small";e.village.popSize>1e3&&e.village.popSize<=5e3?a="medium":e.village.popSize>5e3&&(a="large");let i=`https://dshu.innogamescdn.com/asset/72737c96/graphic/command/attack_${a}.png`;e.isAttack||(i="https://dshu.innogamescdn.com/asset/69990994/graphic/command/support.png");let l=Object.keys(e.village.unitsContain),o="";for(let n=0;n<l.length;n++){const a=l[n];(0!=window.gameConfig.game.archer||"archer"!=a&&"marcher"!=a)&&(o+=`<div class="${a}-field ${0==e.village.unitsContain[a]?"hidden":""}">${e.village.unitsContain[a]}</div>`)}return`<div class="targetsLauncher-item" id="${e.village.id}"><div class="name-field"><span><a target="_blank" href="/game.php?village=${t.game.village.id}&screen=info_village&id=${e.village.id}">${e.village.name} (${e.village.coord.text}) K${e.village.kontinent}</a></span><span style="font-size:9px;color:black">(${e.arrival})</span></div><div class="size-field"><img src="${i}"></div>${o}<div class="del-field"><a onclick="window.targetItem.removeTargetLauncherItem(${e.village.id.toString()},${n})" class="remove-target-btn"></a></div></div>`}}},n={};function a(t){var i=n[t];if(void 0!==i)return i.exports;var l=n[t]={exports:{}};return e[t](l,l.exports,a),l.exports}a.d=(e,n)=>{for(var t in n)a.o(n,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},a.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var t={};(()=>{a.r(t);var e=a("./src/core/Api.ts"),n=a("./src/core/IndexedDBhandler.ts"),i=a("./src/core/Language.ts"),l=a("./src/view/launchDialog.ts");(async()=>{window.Lang=(0,i.determineLang)(),window.game_data.features.Premium.active?(window.scriptOptions=(0,e.loadScriptOptions)(),window.DB=await n.IndexedDBHandler.init(e.storeName,[{name:"players",keyName:"id",AI:!1},{name:"villages",keyName:"id",AI:!1},{name:"plans",keyName:"id",AI:!1}],1),await(0,e.loadWorldApi)(),window.Plans=await window.DB.getAllData("plans"),window.Groups=await(0,e.fetchGroups)(),window.Dialog.show("launchDialog",(0,l.launchDialog)()),$(".popup_box_container").append('<div style="position: fixed;width: 100%;height: 100%;top:0;left:0;z-index:12001"></div>')):window.UI.ErrorMessage((0,i.Lang)("needPremiumFeature"))})()})()})();