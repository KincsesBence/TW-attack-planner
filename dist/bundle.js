/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var n={"./src/core/Api.ts":(n,e,t)=>{t.r(e),t.d(e,{TroopTransaction:()=>y,calcUnitPop:()=>P,coordDistance:()=>C,fetchGroups:()=>v,game:()=>o,getAllPlayer:()=>m,getAllVillages:()=>h,getServerConifg:()=>g,getSlowestUnit:()=>_,getUnitConfig:()=>u,hasAvailableTroops:()=>A,loadPages:()=>f});var a=t("./src/core/VillageModel.ts"),i=t("./src/core/xml2json.ts");const l="https://"+window.location.hostname,o=game_data,s="/map/village.txt",r="/map/player.txt",d="/interface.php?func=get_unit_info",c="/interface.php?func=get_config",p="screen=accountmanager";async function g(){let n=await $.ajax({url:l+c});return(0,i.xml2json)(n,"")}async function u(){let n=await $.ajax({url:l+d});return(0,i.xml2json)(n,"")}async function h(){let n=await $.ajax({url:l+s});n=n.trim();let e=[],t=n.split("\n");for(let n=0;n<t.length;n++){let a=t[n].split(","),i=parseInt(a[2]),l=parseInt(a[3]);e.push({id:parseInt(a[0]),name:decodeURIComponent(a[1]).replaceAll("+"," "),owner:parseInt(a[4]),kontinent:10*Math.floor(l/100)+Math.floor(i/100),coord:{text:a[2]+"|"+a[3],x:i,y:l},popRemain:null,unitsContain:null,popSize:null})}return e}async function m(){let n=await $.ajax({url:l+r});n=n.trim();let e=[],t=n.split("\n");for(let n=0;n<t.length;n++){let a=t[n].split(",");e.push({id:parseInt(a[0]),name:decodeURIComponent(a[1]).replaceAll("+"," "),allyId:parseInt(a[2]),villageCnt:parseInt(a[3]),pionts:parseInt(a[4]),rank:parseInt(a[5])})}return e}function w(n=1,e=0){return`/game.php?${0!=o.player.sitter?"t="+o.player.id+"&":""}village=${o.village.id}&group=${e}&page=${n}&screen=overview_villages&mode=combined`}async function v(){let n=await $.ajax({url:l+`/game.php?${0!=o.player.sitter?"t="+o.player.id+"&":""}village=${o.village.id}&`+p}),e=$(n).find(".group-menu-item").get(),t=[];return e.forEach((n=>{t.push({id:parseInt($(n).attr("data-group-id")),name:$(n).text().trim().slice(1,-1)})})),t}async function f(n){let e=[],t=[],a=[];for(let e=0;e<n.length;e++)t.push(b(w(0,n[e]),e,1));await Promise.allSettled(t).then((n=>n.forEach((async n=>{a.push(n.value.pageCnt),n.value.villages.forEach((n=>{-1==e.findIndex((e=>n.id==e.id))&&e.push(n)}))})))),t=[];for(let e=0;e<n.length;e++)for(let i=1;i<a[e];i++)t.push(b(w(i,n[e]),(e+1)*i,i));return await Promise.allSettled(t).then((n=>n.forEach((async n=>{n.value.villages.forEach((n=>{-1==e.findIndex((e=>n.id==e.id))&&e.push(n)}))})))),e}function b(n,e,t){return new Promise((async(i,l)=>{setTimeout((async()=>{let e=await $.ajax({url:n}),l=await async function(n){let e=$(n).find("#combined_table").find("tr"),t=[],i=[];$(e).find("th").get().forEach(((n,e)=>{let t=$(n).find("img");if(t.length>0){let n=$(t).attr("src");n.includes("graphic/unit/unit_")&&!n.includes("unit_militia")&&i.push({index:e,name:k(n)})}}));for(let n=1;n<e.length;n++){const l=e[n];let o=$(l).find("td"),s=parseInt($(l).find(".quickedit-vn").attr("data-id")),r={spear:0,sword:0,axe:0,archer:0,spy:0,light:0,marcher:0,heavy:0,ram:0,catapult:0,knight:0,snob:0},d=0;i.forEach((n=>{let e=parseInt($(o[n.index]).text());r[n.name]=e,d+=window.unitConfig[n.name].pop*e}));let c=(await a.VillageModel.init()).find((n=>n.id==s)),p=parseInt($(o[7]).find("a").text().split(" ")[0]);c.unitsContain=r,c.popRemain=p,c.popSize=d,t.push(c)}return t}(e);i({pageCnt:x(e),pageNum:t-1,villages:l})}),200*e)}))}function x(n){let e=$($(n).find(".paged-nav-item").get()[0]).parent().find("select"),t=0;return t=1==e.length?e.find("option").length-1:$(n).find(".paged-nav-item").length,t}function k(n){let e=n.split("/");return e[e.length-1].split(".")[0].replace("unit_","").replace("@2x","")}function y(n,e,t){return Object.keys(window.unitConfig).forEach((a=>{[n[a],e[a]]=function(n,e,t){return t<0&&(t=e+t)<0&&(t=0),e-t<0?(n=e,e=0):(n+=t,e-=t),[n,e]}(n[a],e[a],t[a])})),[n,e]}function P(n){let e=0;return Object.keys(window.unitConfig).forEach((t=>{e+=window.unitConfig[t].pop*n[t]})),e}function _(n,e){var t=Object.keys(window.unitConfig).map((n=>({key:n,value:window.unitConfig[n].speed}))).sort(((n,e)=>n.value>e.value?-1:1));if(!e&&n.knight>0)return{key:"knight",value:window.unitConfig.knight.speed};for(let e=0;e<t.length;e++)if(n[t[e].key]>0)return t[e]}function C(n,e){return n&&e?Math.sqrt(Math.pow(e.coord.x-n.coord.x,2)+Math.pow(e.coord.y-n.coord.y,2)):null}function A(n,e){let t=Object.keys(window.unitConfig);for(let a=0;a<t.length;a++){const i=t[a];if("snob"==i&&n.unitsContain[i]>0&&0==e[i])return console.log("ide"),!1;if(0!=e[i]){if(e[i]<0&&n.unitsContain[i]+e[i]<0)return!1;if(0==n.unitsContain[i]&&99999==e[i])return!1;if(n.unitsContain[i]<e[i]&&99999!=e[i]&&e[i]>0)return!1}}return!0}},"./src/core/Model.ts":(n,e,t)=>{t.r(e),t.d(e,{Model:()=>a});class a{constructor(n=[]){this.items=[],this.items=n}first(){return this.items.length>0?this.items[0]:null}get(n=this.items.length){return this.items.slice(0,n)}filter(n){let e=this.items.filter(n);return new a(e)}find(n){return this.items.find(n)}sort(n,e){let t=this.items.sort(((t,a)=>t[n]>a[n]?e?1:-1:e?-1:1));return new a(t)}}},"./src/core/PlayersModel.ts":(n,e,t)=>{t.r(e),t.d(e,{PlayersModel:()=>l});var a=t("./src/core/Api.ts"),i=t("./src/core/Model.ts");class l extends i.Model{static init(){return null==l.instance?async function(){return l.instance=new l,await l.instance.loadPlayers(),l.instance}():async function(){return l.instance}()}async loadPlayers(){this.items=await(0,a.getAllPlayer)()}}l.instance=null},"./src/core/Query.ts":(n,e,t)=>{t.r(e),t.d(e,{Query:()=>a});class a{constructor(n,e,t,a){this.objectCopy=[],this.way=1,this.field="",this.from=0,this.to=0,this.draw=50,this.CanScroll=!1,this.objectRef=n,this.objectCopy=[...n],this.funcRef=a,this.targetHtml=e,this.targetCnt=t;let i=this;e.addEventListener("scroll",(function(n){let t=!1;e.scrollHeight-100<=e.clientHeight+e.scrollTop&&!t&&i.CanScroll&&(t=!0,i.pull())})),addEventListener("wheel",(n=>{i.CanScroll=!0,clearTimeout(i.To),i.To=setTimeout((()=>{i.CanScroll=!1}),500)}))}setDraw(n){this.draw=n}calcPaging(){this.to=this.from+this.draw,this.to>this.objectRef.length&&(this.to=this.objectRef.length)}reset(){$(this.targetHtml).html(""),$(this.targetHtml).scrollTop(0),this.objectCopy=[...this.objectRef],this.from=0,this.to=0}resetAll(){this.reset(),this.render()}order(n){this.reset(),this.field==n?this.way*=-1:this.way=-1,console.log(this.way,n);let e=this;this.objectCopy.sort(((t,a)=>e.getProp(n,t)<e.getProp(n,a)?-1*this.way:1*this.way)),this.field=n,this.render()}getProp(n,e){let t=n.split(".");return 1==t.length?e[t[0]]:(e=e[t.shift()],this.getProp(t.join("."),e))}pull(){this.from+this.draw>this.objectCopy.length||(this.from+=this.draw,this.to=this.from+this.draw,this.render())}render(){this.calcPaging(),console.log(this.from,this.to,this.objectCopy);for(let n=this.from;n<this.to;n++)$(this.targetHtml).append(this.funcRef(this.objectCopy[n]));$(this.targetCnt).text(this.objectCopy.length)}partialRender(n,e){n.forEach((n=>{console.log($(this.targetHtml).find(`#${this.getProp(e,n)}`)),$(this.targetHtml).find(`#${this.getProp(e,n)}`).replaceWith(this.funcRef(n))}))}}},"./src/core/VillageModel.ts":(n,e,t)=>{t.r(e),t.d(e,{VillageModel:()=>l});var a=t("./src/core/Api.ts"),i=t("./src/core/Model.ts");class l extends i.Model{static init(){return null==l.instance?async function(){return l.instance=new l,await l.instance.loadVillages(),l.instance}():l.instance}async loadVillages(){this.items=await(0,a.getAllVillages)()}}l.instance=null},"./src/core/planDB.ts":(n,e,t)=>{t.r(e),t.d(e,{planDB:()=>a});class a{async init(){this.db=await this.loadDB(),console.log("loaded plan DB 🚀")}async loadPlans(){return new Promise((async(n,e)=>{if(!this.db.objectStoreNames.contains("plans"))return void n([]);let t=this.db.transaction("plans"),a=await t.objectStore("plans").getAll();a.onsuccess=()=>{n(a.result.map((n=>JSON.parse(n.data))))}}))}async savePlan(n){let e=this.db.transaction("plans","readwrite");await e.objectStore("plans").put({id:n.id,data:JSON.stringify(n)})}async removePlan(n){console.log(n);let e=this.db.transaction("plans","readwrite");await e.objectStore("plans").delete(n)}async loadDB(){return new Promise(((n,e)=>{let t=indexedDB.open("TW_ATTACK_PLANNER_DATA",1);t.onupgradeneeded=function(){let e=t.result;e.objectStoreNames.contains("plans")||e.createObjectStore("plans",{keyPath:"id",autoIncrement:!1}),t.onsuccess=function(){n(t.result)}},t.onsuccess=function(){n(t.result)},t.onerror=function(){throw console.error("Error",t.error),new Error(t.error.message)}}))}}},"./src/core/xml2json.ts":(n,e,t)=>{function a(n,e){var t={toObj:function(n){var e={};if(1==n.nodeType){if(n.attributes.length)for(var a=0;a<n.attributes.length;a++)e["@"+n.attributes[a].nodeName]=(n.attributes[a].nodeValue||"").toString();if(n.firstChild){for(var i=0,l=0,o=!1,s=n.firstChild;s;s=s.nextSibling)1==s.nodeType?o=!0:3==s.nodeType&&s.nodeValue.match(/[^ \f\n\r\t\v]/)?i++:4==s.nodeType&&l++;if(o)if(i<2&&l<2)for(t.removeWhite(n),s=n.firstChild;s;s=s.nextSibling)3==s.nodeType?e["#text"]=t.escape(s.nodeValue):4==s.nodeType?e["#cdata"]=t.escape(s.nodeValue):e[s.nodeName]?e[s.nodeName]instanceof Array?e[s.nodeName][e[s.nodeName].length]=t.toObj(s):e[s.nodeName]=[e[s.nodeName],t.toObj(s)]:e[s.nodeName]=t.toObj(s);else n.attributes.length?e["#text"]=t.escape(t.innerXml(n)):e=t.escape(t.innerXml(n));else if(i)n.attributes.length?e["#text"]=t.escape(t.innerXml(n)):(e=t.escape(t.innerXml(n)),isNaN(e)||(e=parseFloat(e)));else if(l)if(l>1)e=t.escape(t.innerXml(n));else for(s=n.firstChild;s;s=s.nextSibling)e["#cdata"]=t.escape(s.nodeValue)}n.attributes.length||n.firstChild||(e=null)}else 9==n.nodeType?e=t.toObj(n.documentElement):alert("unhandled node type: "+n.nodeType);return e},toJson:function(n,e,a){var i=e?'"'+e+'"':"";if(n instanceof Array){for(var l=0,o=n.length;l<o;l++)n[l]=t.toJson(n[l],"",a+"\t");i+=(e?":[":"[")+(n.length>1?"\n"+a+"\t"+n.join(",\n"+a+"\t")+"\n"+a:n.join(""))+"]"}else if(null==n)i+=(e&&":")+"null";else if("object"==typeof n){var s=[];for(var r in n)s[s.length]=t.toJson(n[r],r,a+"\t");i+=(e?":{":"{")+(s.length>1?"\n"+a+"\t"+s.join(",\n"+a+"\t")+"\n"+a:s.join(""))+"}"}else i+="string"==typeof n?(e&&":")+'"'+n.toString()+'"':(e&&":")+n.toString();return i},innerXml:function(n){var e="";if("innerHTML"in n)e=n.innerHTML;else for(var t=function(n){var e="";if(1==n.nodeType){e+="<"+n.nodeName;for(var a=0;a<n.attributes.length;a++)e+=" "+n.attributes[a].nodeName+'="'+(n.attributes[a].nodeValue||"").toString()+'"';if(n.firstChild){e+=">";for(var i=n.firstChild;i;i=i.nextSibling)e+=t(i);e+="</"+n.nodeName+">"}else e+="/>"}else 3==n.nodeType?e+=n.nodeValue:4==n.nodeType&&(e+="<![CDATA["+n.nodeValue+"]]>");return e},a=n.firstChild;a;a=a.nextSibling)e+=t(a);return e},escape:function(n){return n.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(n){n.normalize();for(var e=n.firstChild;e;)if(3==e.nodeType)if(e.nodeValue.match(/[^ \f\n\r\t\v]/))e=e.nextSibling;else{var a=e.nextSibling;n.removeChild(e),e=a}else 1==e.nodeType?(t.removeWhite(e),e=e.nextSibling):e=e.nextSibling;return n}};return 9==n.nodeType&&(n=n.documentElement),t.toObj(t.removeWhite(n))}t.r(e),t.d(e,{xml2json:()=>a})},"./src/view/ConfirmVillageSpeedRemoveModal.ts":(n,e,t)=>{t.r(e),t.d(e,{ConfirmVillageSpeedRemoveModal:()=>a});const a=n=>`\n    <div class="modal-input-inline">\n        <h2>Biztosan szeretnéd eltávolítani?</h2>\n    </div>\n    <div class="modal-input-inline">\n        <button class="btn" onclick="window.targetItem.confirmRemoveVillageBooster(${n})">Igen</button> \n        <button class="btn" onclick="window.closeModal()">Mégse</button>\n    </div>\n    `},"./src/view/addAttackModal.ts":(n,e,t)=>{t.r(e),t.d(e,{addAttackModal:()=>i});var a=t("./src/core/Api.ts");const i=()=>`\n    <div class="modal-input-inline">\n        <label for="attack">Támadás:</label>\n        <input type="radio" value="attack" name="planner-operation" checked>\n        <label for="reinforce">Erősítés:</label>\n        <input type="radio" value="reinforce" name="planner-operation">\n    </div>\n    <div class="modal-input-group">\n        <label for="planner-template">Template:</label>\n        <select id="planner-template" placeholder="---Nincs kiválasztva---">\n            <option value="temp_all">Összes egység</option>\n            ${window.attackPlan.templates.map((n=>`<option value="${n.name}">${n.name}</option>`))}\n        </select>\n    </div>\n    <div class="modal-input-group">\n        <label for="planner-arrival">Érkezés:</label>\n        <select id="planner-arrival" placeholder="---Nincs kiválasztva---">\n            ${window.attackPlan.arrivals.map((n=>`<option value="${n}">${n}</option>`))}\n        </select>\n    </div>\n    <div class="modal-input-group">\n        <label for="planner-notes">Megjegyzés:</label>\n        <input id="planner-notes" placeholder="---Nincs megjegyzés---">\n    </div>\n    <div class="modal-input-inline">\n        <button class="btn" onclick="window.addAttackConfirm()">Hozzáadás</button> \n        <button class="btn" onclick="window.closeModal()">Mégse</button>\n    </div>\n    `;window.window.addAttackConfirm=()=>{let n=[],e=[];if(0==$('input[name="target"]:checked').get().length)return void window.UI.ErrorMessage("No target selected");if(0==$(".launch-list").find("input:checked").get().length)return void window.UI.ErrorMessage("No launcher selected");let t=parseInt($('input[name="target"]:checked').val().toString()),a=$("#planner-template").val(),i=$('input[name="planner-operation"]:checked').val().toString(),l=$("#planner-arrival").val().toString(),o=$("#planner-notes").val().toString();console.log($(".launch-list").find("input:checked").get().length,t,a,i,l,o);let s=window.attackPlan.targetPool.findIndex((n=>n.village.id==t)),r=window.attackPlan.templates.findIndex((n=>n.name==a));$(".launch-list").find("input:checked").get().forEach((e=>{let t=parseInt($(e).val().toString()),d=window.attackPlan.launchPool.findIndex((n=>n.id==t)),c=null;r>-1&&(c=window.attackPlan.templates[r].units),"temp_all"==a&&(c=window.attackPlan.launchPool[d].unitsContain);let p=window.attackPlan.launchPool[d].id,g=window.addLauncher(s,d,c,i,l,o);console.log(g),g?$(".launch-list").find(`#${p}`).remove():n.push(window.attackPlan.launchPool[d])})),e.push(window.attackPlan.targetPool[s]),window.targetPoolQuery.partialRender(e,"village.id"),window.launchVillagesQuery.partialRender(n,"id"),$(".planner-modal").hide(),window.DB.savePlan(window.attackPlan)},window.addLauncher=(n,e,t,i,l,o)=>{console.log("addLauncher");let s={...window.attackPlan.launchPool[e]};return s.unitsContain={spear:0,sword:0,axe:0,archer:0,spy:0,light:0,marcher:0,heavy:0,ram:0,catapult:0,knight:0,snob:0},[s.unitsContain,window.attackPlan.launchPool[e].unitsContain]=(0,a.TroopTransaction)(s.unitsContain,window.attackPlan.launchPool[e].unitsContain,t),s.popSize=(0,a.calcUnitPop)(s.unitsContain),window.attackPlan.launchPool[e].popSize=(0,a.calcUnitPop)(window.attackPlan.launchPool[e].unitsContain),s.popSize>0&&window.attackPlan.targetPool[n].launchers.push({arrival:l,isAttack:"attack"==i,notes:o,unitSpeed:(0,a.getSlowestUnit)(s.unitsContain,"attack"==i),village:s}),0==window.attackPlan.launchPool[e].popSize&&(window.attackPlan.launchPool.splice(e,1),!0)}},"./src/view/addPlayerSpeedModal.ts":(n,e,t)=>{t.r(e),t.d(e,{addPlayerSpeedModal:()=>a});const a=()=>{let n=[];window.attackPlan.targetPool.forEach((e=>{n.includes(e.village.owner)||n.push(e.village.owner)}));let e=[];return n.forEach((n=>{let t=window.Players.find((e=>e.id==n));t&&-1==window.attackPlan.boosters.findIndex((n=>n.playerId==t.id))&&e.push(t)})),`\n    <div class="modal-input-group">\n        <select id="planner-player-boosts" size="5">\n           ${window.attackPlan.boosters.map((n=>`<option value="${n.playerId}">${n.player} (${n.value}%)</option>`))}\n        </select>\n        <button class="btn" onclick="window.removePlayerBoost()">remove</button>\n    </div>\n\n    <div class="modal-input-group">\n        <select id="planner-player-select">\n           ${e.map((n=>`<option value="${n.id}">${n.name}</option>`))}\n        </select>\n        <label for="planner-player-boost">Gyorsító százalékban:</label>\n        <input id="planner-player-boost" type="number" max="60" min="1" placeholder="%">\n        <button class="btn" onclick="window.addPlayerBoost()">Add</button>\n    </div>\n    `};window.addPlayerBoost=()=>{if(""==$("#planner-player-boost").val())return;let n=parseInt($("#planner-player-select").val().toString()),e=parseInt($("#planner-player-boost").val().toString());if(0==e)return;let t=window.Players.find((e=>e.id==n));window.attackPlan.boosters.push({player:t.name,playerId:n,value:e}),window.DB.savePlan(window.attackPlan),$(".planner-modal-content").html(a())},window.removePlayerBoost=()=>{if(null==$("#planner-player-boosts").val())return;let n=parseInt($("#planner-player-boosts").val().toString()),e=window.attackPlan.boosters.findIndex((e=>e.playerId==n));window.attackPlan.boosters.splice(e,1),$(".planner-modal-content").html(a())}},"./src/view/addVillageSpeedModal.ts":(n,e,t)=>{t.r(e),t.d(e,{addVillageBoosterModal:()=>a});const a=n=>`\n    <div class="modal-input-group">\n        <label for="planner-notes">Gyorsító százalékban:</label>\n        <input id="planner-village-boost" type="number" max="60" min="1" placeholder="%">\n    </div>\n    <div class="modal-input-inline">\n        <button class="btn" onclick="window.targetItem.confirmAddVillageBooster(${n})">Igen</button> \n    </div>\n    `},"./src/view/autoAssignModal.ts":(n,e,t)=>{t.r(e),t.d(e,{autoAssignModal:()=>i});var a=t("./src/core/Api.ts");const i=()=>{let n="";return window.attackPlan.templates.forEach((e=>{n+=`\n            <option value='${e.name}'>${e.name}</option>\n        `})),`\n    <style>\n        .assigner-row {  display: grid;\n            display: grid;\n            grid-template-columns: 200px repeat(auto-fill, 80px) 10px;\n        }\n\n        .assigner-row input{\n            width:30px;\n        }\n\n        .item{\n            padding:5px;\n        }\n\n        .add-assignment{\n            width: 130px;\n        }\n\n        .add-assignment input{\n            width: 50px;\n        }\n\n        .assigner-target-villages{\n            width:1100px;\n            max-height:250px;\n            overflow-y:auto;\n            border: solid 1px #6c4824;\n            border-radius: 5px;\n            background-color:#fff5dc;\n        }\n\n        .assigner-target-villages .item{\n            border: solid 1px #6c4824;\n        }\n\n        .assigner-counter .item{\n            border: solid 1px #6c4824;\n        }\n\n        .assigner-counter .item:first-of-type{\n            border: none !important;\n        }\n\n        .assigner-counter .item:last-of-type{\n            border: none !important;\n        }\n\n\n        .assigner-target-btn{\n            display:block;\n            width: 20px;\n            height: 20px;\n            background: url(https://dshu.innogamescdn.com/asset/80b013af/graphic/login_close.png) top left no-repeat;\n            cursor: pointer;\n            background-size: 20px;\n            margin-right: 10px;\n        }\n\n        .assigner-date div{\n            transform: rotate(290deg) translateX(20px);\n            text-wrap: nowrap;\n        }\n\n        .assignment-alg{\n            margin:15px 0;\n            display: flex;\n            justify-content: center;\n        }\n\n        .add-assignment-input{\n            margin-bottom:5px;\n            display:grid;\n        }\n    </style>\n    \n    <div class="assigner">\n        <div class="add-assignment">\n            <div class="add-assignment-input">\n                <label>Dátum:</label>\n                <select id="assignmentArrival">\n                ${window.attackPlan.arrivals.map((n=>`<option value='${n}'>${n}</option>`)).join("")}\n                </select>\n            </div>\n            <div class="add-assignment-input">\n                <label>Template:</label>\n                <select id="assignmentTemplates">\n                    ${n}\n                </select>\n            </div>\n            <div class="add-assignment-input">\n                <label>Mennyiség:</label>\n                <input min="1" value="1" id="assigner-number-filter" type="number" disabled>\n                <input id="assigner-max-filter" onclick="$('#assigner-number-filter').prop('disabled', (i, v) => !v);" type="checkbox" checked>\n            </div>\n            \n            <button class="btn" onclick="autoAssign.addAssignment()">+ add</button>\n        </div>\n        <div class="assigner-header">\n            <div class="assigner-row assigner-date">\n                    <div class="item"></div>\n                    <div class="item checkbox"></div>\n            </div>\n            <div class="assigner-row assigner-remover">\n                    <div class="item"></div>\n                    <div class="item checkbox"></div>\n            </div>\n            <div class="assigner-row assigner-loader">\n                    <div class="item"></div>\n                    <div class="item checkbox"></div>\n            </div>\n            <div class="assigner-row assigner-name">\n                <div class="item">Falu (${window.attackPlan.targetPool.length})</div>\n                <div class="item checkbox">\n                    <input id="assigner-main-checkbox" onclick="autoAssign.checkAll()" type="checkbox">\n                </div>\n            </div>  \n        </div>\n        <div class="assigner-target-villages">\n            ${window.attackPlan.targetPool.map((n=>`\n                <div class="assigner-row" id="assigner-row-${n.village.id}">\n                    <div class="item"><a target="_blank" href="/game.php?village=${a.game.village.id}&screen=info_village&id=${n.village.id}">${n.village.name}(${n.village.coord.text}) K${n.village.kontinent}</a></div>\n                    <div class="item checkbox">\n                        <input class="assigner-target-check" value="${n.village.id}" type="checkbox">\n                    </div>\n                </div>\n            `)).join("")}\n        </div>\n        <div class="assigner-row assigner-counter">\n            <div class="item"></div>\n            <div class="item checkbox"></div>\n        </div>\n        <div class="assignment-alg">\n            <input id="evenDistributeClosest" value="1" type="radio" name="assignmentAlg"><label for="evenDistributeClosest">Egyenletes</label>\n            <input id="oneByOneQ" value="2" type="radio" name="assignmentAlg"><label for="oneByOneQ">Egyenként sorban</label>\n            <input id="oneByOneClosest" value="3"  type="radio" name="assignmentAlg"><label for="oneByOneClosest">Egyenként legközelebb</label>\n            <input id="closestToTarget" value="4" type="radio" name="assignmentAlg"><label for="closestToTarget">Célpothoz legközelebb</label>\n        </div>\n        <div>\n            <button style="margin: 0 auto; display: block;" onclick="autoAssign.startAssignment()" class="btn">Start Assignment</button>\n        </div>\n        \n    </div>\n    <div id="dialog-loading" style="display: none;justify-content: center;width: 100%;">\n        <img style="height:25px" src="https://dshu.innogamescdn.com/asset/6389cdba/graphic/loading.gif"><span style="padding:5px">Támadások kiosztása...</span>\n    </div>\n    `};function l(n,e){let t=[];for(let i=0;i<window.autoAssign.launchPoolCopy.length;i++){const l=window.autoAssign.launchPoolCopy[i];if(t.length>=e)break;if((0,a.hasAvailableTroops)(l,n.units)){let e={...l};e.unitsContain={spear:0,sword:0,axe:0,archer:0,spy:0,light:0,marcher:0,heavy:0,ram:0,catapult:0,knight:0,snob:0},[e.unitsContain,l.unitsContain]=(0,a.TroopTransaction)(e.unitsContain,l.unitsContain,n.units),n.units.snob>0&&(n.units.marcher<0&&(l.unitsContain.marcher=0),n.units.light<0&&(l.unitsContain.light=0),n.units.axe<0&&(l.unitsContain.axe=0)),e.popSize=(0,a.calcUnitPop)(e.unitsContain),l.popSize=(0,a.calcUnitPop)(l.unitsContain),t.push(e),0==l.popSize&&(console.log("removed"),window.autoAssign.launchPoolCopy.splice(i,1))}}return t}window.autoAssign={assignTypes:[],launchPoolCopy:[],removeAssignment:n=>{let e=window.autoAssign.assignTypes.findIndex((e=>e.id==n.toString()));-1!=e&&(window.autoAssign.assignTypes[e].filtered.forEach((n=>{let t=window.autoAssign.launchPoolCopy.findIndex((e=>e.id==n.id));-1==t?window.autoAssign.launchPoolCopy.push(n):(window.autoAssign.assignTypes[e].template.units.snob>0&&(window.autoAssign.assignTypes[e].template.units.marcher<0&&(n.unitsContain.marcher-=window.autoAssign.assignTypes[e].template.units.marcher),window.autoAssign.assignTypes[e].template.units.light<0&&(n.unitsContain.light-=window.autoAssign.assignTypes[e].template.units.light),window.autoAssign.assignTypes[e].template.units.axe<0&&(n.unitsContain.axe-=window.autoAssign.assignTypes[e].template.units.axe)),[window.autoAssign.launchPoolCopy[t].unitsContain,n.unitsContain]=(0,a.TroopTransaction)(window.autoAssign.launchPoolCopy[t].unitsContain,n.unitsContain,n.unitsContain))})),window.autoAssign.assignTypes.splice(e,1),$(".ar-"+n).remove())},fillAssignment:n=>{$(".assigner-target-villages .assigner-target-check").get().forEach((e=>{if(!$(e).is(":checked"))return;let t=$(`.assigner-loader .ar-${n}`).find(".ass-inp").val();$(e).parent().parent().find(`.ar-${n} .ass-inp`).val(t)})),window.autoAssign.updateCount(n)},addAssignment:()=>{if(window.autoAssign.assignTypes.length>=10)return;let n=$("#assignmentArrival").val().toString(),e=99999;$("#assigner-max-filter").is(":checked")||(e=parseInt($("#assigner-number-filter").val().toString()));let t=$("#assignmentTemplates").val().toString(),a=window.attackPlan.templates.find((n=>n.name==t)),i={id:(new Date).getTime().toString(),arrival:n,filtered:l(a,e),required:0,template:a,max:e};window.autoAssign.assignTypes.push(i),$(".assigner-header .assigner-loader .checkbox").before(`<div class="item ar-${i.id}" >\n        <input class="ass-inp" value="0" type="number" min="0">\n        <button onclick="autoAssign.fillAssignment(${i.id})">↓</button></div>\n        `),$(".assigner-header .assigner-name .checkbox").before(`\n            <div class="item ar-${i.id}" >${i.template.name}</div>\n        `),$(".assigner-header .assigner-remover .checkbox").before(`\n            <div class="item ar-${i.id}" ><a onclick="autoAssign.removeAssignment(${i.id})" class="assigner-target-btn"></a></div>\n        `),$(".assigner-header .assigner-date .checkbox").before(`\n        <div class="item ar-${i.id}" >${i.arrival}</div>\n        `),$(".assigner-target-villages").find(".assigner-row").get().forEach((n=>{$(n).find(".checkbox").before(`<div class="item ar-${i.id}" >\n                <input class="ass-inp" \n                onchange="autoAssign.updateCount(${i.id})" \n                onkeyup="autoAssign.updateCount(${i.id})" \n                value="0" type="number" min="0"></div>`)})),$(".assigner-counter .checkbox").before(`\n        <div class="item ar-${i.id}" ><span class="cnt-actual">0</span>/${i.filtered.length}</div>\n        `),console.log(window.autoAssign.assignTypes)},startAssignment:()=>{$("#dialog-loading").show(),$("#plannerCloseBtn").hide(),$(".assigner").hide(),setTimeout((()=>{switch($('input[name="assignmentAlg"]:checked').val()){case"1":window.autoAssign.assignTypes.forEach(((n,e)=>{let t=0;for(;n.filtered.length>0&&n.required>t;)for(let i=0;i<window.attackPlan.targetPool.length;i++){const l=window.attackPlan.targetPool[i];let o=0;for(let n=0;n<e+1;n++)o+=parseInt($(`#assigner-row-${l.village.id} .ar-${window.autoAssign.assignTypes[n].id} .ass-inp`).val().toString());if(console.log(o),l.launchers.length<o){let e=-1,o=999999;if(n.filtered.forEach(((n,t)=>{let i=(0,a.coordDistance)(n,l.village);i<o&&(e=t,o=i)})),e>-1){t++,console.log(t,n.required);let a=window.attackPlan.launchPool.findIndex((t=>t.id==n.filtered[e].id));window.addLauncher(i,a,n.template.units,"attack",n.arrival,""),n.filtered.splice(e,1)}}}}));break;case"2":!function(){for(let n=0;n<window.attackPlan.targetPool.length;n++){const e=window.attackPlan.targetPool[n];for(let t=0;t<window.autoAssign.assignTypes.length;t++){const i=window.autoAssign.assignTypes[t];if(0==i.filtered.length)continue;let l=parseInt($(`#assigner-row-${e.village.id} .ar-${i.id} .ass-inp`).val().toString());for(let t=0;t<l;t++){let t=-1,l=999999;if(i.filtered.forEach(((n,i)=>{let o=(0,a.coordDistance)(n,e.village);o<l&&(t=i,l=o)})),t>-1){let e=window.attackPlan.launchPool.findIndex((n=>n.id==i.filtered[t].id));window.addLauncher(n,e,i.template.units,"attack",i.arrival,""),i.filtered.splice(t,1)}}}}}();break;case"3":!function(){for(let n=0;n<window.attackPlan.targetPool.length;n++){const e=window.attackPlan.targetPool[n];for(let t=0;t<window.autoAssign.assignTypes.length;t++){const a=window.autoAssign.assignTypes[t];if(0==a.filtered.length)continue;let i=parseInt($(`#assigner-row-${e.village.id} .ar-${a.id} .ass-inp`).val().toString());for(let e=0;e<i;e++){let e=window.attackPlan.launchPool.findIndex((n=>n.id==a.filtered[0].id));window.addLauncher(n,e,a.template.units,"attack",a.arrival,""),a.filtered.splice(0,1)}}}}();break;case"4":!function(){let n=[];for(let e=0;e<window.autoAssign.assignTypes.length;e++){const t=window.autoAssign.assignTypes[e];if(0!=t.filtered.length)for(let i=0;i<t.filtered.length;i++){const l=t.filtered[i];let o=-1,s=999999;for(let t=0;t<window.attackPlan.targetPool.length;t++){const i=window.attackPlan.targetPool[t];let r=n.findIndex((n=>n.id==i.village.id)),d=0;for(let n=0;n<e+1;n++)d+=parseInt($(`#assigner-row-${i.village.id} .ar-${window.autoAssign.assignTypes[n].id} .ass-inp`).val().toString());if(console.log(d),r>-1&&n[r].cnt>=d)continue;let c=(0,a.coordDistance)(l,i.village);c<s&&(o=t,s=c)}if(o>-1){let e=n.findIndex((n=>n.id==window.attackPlan.targetPool[o].village.id));-1==e?n.push({id:window.attackPlan.targetPool[o].village.id,cnt:1}):n[e].cnt++;let a=window.attackPlan.launchPool.findIndex((n=>n.id==t.filtered[i].id));window.addLauncher(o,a,t.template.units,"attack",t.arrival,""),t.filtered.splice(i,1)}}}}()}window.targetPoolQuery.resetAll(),window.launchVillagesQuery.resetAll(),window.closeModal()}),200)},checkAll:()=>{$(".assigner-target-villages").find("input[type=checkbox]").get().forEach((n=>{$(n).prop("checked",$("#assigner-main-checkbox").prop("checked"))}))},updateCount:n=>{let e=0;$(`.assigner-target-villages .ar-${n} .ass-inp`).get().forEach((n=>{let t=$(n).val();e+=parseInt(t.toString().split("x")[0])})),console.log(n,e);let t=window.autoAssign.assignTypes.findIndex((e=>e.id==n.toString()));window.autoAssign.assignTypes[t].required=e,$(`.assigner-counter .ar-${n} .cnt-actual`).text(e)}}},"./src/view/calculatedAttackModal.ts":(n,e,t)=>{t.r(e),t.d(e,{calculatedAttackModal:()=>i,generateLaunchText:()=>l});var a=t("./src/core/Api.ts");const i=()=>(setTimeout((()=>{!function(){let n=[];window.attackPlan.targetPool.forEach((e=>{let t=window.attackPlan.boosters.findIndex((n=>n.playerId==e.village.owner));e.launchers.forEach((i=>{let l=1;t>-1&&(e.booster=window.attackPlan.boosters[t].value),i.isAttack||(l+=e.booster/100);let o=60*i.unitSpeed.value,s=new Date(i.arrival),r=new Date(s.valueOf()-Math.round(1e3*o/window.gameConfig.speed/(window.gameConfig.unit_speed*l)*(0,a.coordDistance)(i.village,e.village))),d=new Intl.DateTimeFormat("hu-hu",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format(r),c="";Object.keys(window.unitConfig).forEach((n=>{i.village.unitsContain[n]>0&&(c+=`&${n}=${i.village.unitsContain[n]}`)})),n.push({launchDate:d,launchLink:`https://${window.location.host}/game.php?village=${i.village.id}&screen=place&target=${e.village.id}${c}`,unitSpeed:i.unitSpeed,villageFrom:i.village,villageTo:e.village,note:i.notes,isAttack:i.isAttack})}))})),console.log(n),n.sort(((n,e)=>n.launchDate>e.launchDate?1:-1));let{bbcode:e,html:t}=l(n);$(".bb-field").html(e),$(".inApp-field").html(t),console.log(e,t),$("#dialog-loading").hide(),$(".modal-input-inline").show()}()}),2e3),'\n    <div id="dialog-loading">\n            <img style="height:25px" src="https://dshu.innogamescdn.com/asset/6389cdba/graphic/loading.gif"><span style="padding:5px">Számolás...</span>\n    </div>\n    <div class="modal-input-inline" style="display:none">\n        <label for="bb">BB kód:</label>\n        <input onclick="window.changeDisplayType()" type="radio" id="bb" value="bb" name="showType" >\n        <label for="inapp">In-app:</label>\n        <input onclick="window.changeDisplayType()" type="radio" id="inapp" value="inapp" name="showType" checked>\n        <div class="bb-field" style="display:none"></div>\n        <div class="inApp-field" style="max-height:600px; overflow-y: auto;">\n        </div>\n    </div>\n    ');function l(n){let e=0,t="",i='<table class="vis"><tr><th></th><th></th><th>indítás</th><th>Célpont</th><th>Parancs</th><th>Jegyzet</th></tr>';for(let l=0;l<n.length;l++){let o=`[*]#${l+1}[|][unit]${n[l].unitSpeed.key}[/unit][|][b]${n[l].launchDate}[/b][|] ${n[l].villageTo.coord.text} [|][url=${n[l].launchLink}]${n[l].isAttack?"Támadás":"Erősítés"}[/url][|]${n[l].note}`;e+o.length+19>=6e4&&(e=0,t+="[/table]</textarea>"),0==e&&(t+='1.page<br><textarea style="resize: none;height:100px;width:400px;">[table][**] [||][building]barracks[/building][||]indítás[||]Célpont[||]Parancs[||]Jegyzet[/**]',e+=151),t+=o,e+=o.length,i+=`<tr><td>#${l+1}</td><td><img src="/graphic/unit/unit_${n[l].unitSpeed.key}.png"></td><td>${n[l].launchDate}</td><td><a target="_blank" href="/game.php?village=${a.game.village.id}&screen=info_village&id=${n[l].villageTo.id}">${n[l].villageTo.name} (${n[l].villageTo.coord.text}) </a></td><td><a href="${n[l].launchLink}">${n[l].isAttack?"Támadás":"Erősítés"}</a></td><td>${n[l].note}</td></tr>`}return i+="</table>",console.log(t,i),{bbcode:t,html:i}}window.changeDisplayType=()=>{"bb"==$("input[name=showType]:checked").val()?($(".bb-field").show(),$(".inApp-field").hide()):($(".bb-field").hide(),$(".inApp-field").show())}},"./src/view/confirmCalculateAttackModal.ts":(n,e,t)=>{t.r(e),t.d(e,{confirmCalculateAttackModal:()=>a});const a=()=>'\n    <div class="modal-input-inline">\n        <h2>Biztosan szeretnéd kiszámítani?</h2>\n    </div>\n    <div class="modal-input-inline">\n        <button class="btn" onclick="window.confirmCalculateAttack()">Igen</button> \n        <button class="btn" onclick="window.closeModal()">Mégse</button>\n    </div>\n    '},"./src/view/confirmRemoveModal.ts":(n,e,t)=>{t.r(e),t.d(e,{confirmRemoveModal:()=>a});const a=(n,e)=>`\n    <div class="modal-input-inline">\n        <h2>Biztosan szeretnéd eltávolítani?</h2>\n    </div>\n    <div class="modal-input-inline">\n        <button class="btn" onclick="window.targetItem.confirmRemoveTargetLauncherItem(${n},${e})">Igen</button> \n        <button class="btn" onclick="window.closeModal()">Mégse</button>\n    </div>\n    `},"./src/view/confirmRemoveTargetModal.ts":(n,e,t)=>{t.r(e),t.d(e,{confirmRemoveTargetModal:()=>a});const a=n=>`\n    <div class="modal-input-inline">\n        <h2>Biztosan szeretnéd eltávolítani?</h2>\n    </div>\n    <div class="modal-input-inline">\n        <button class="btn" onclick="window.targetItem.confirmRemoveTargetItem(${n})">Igen</button> \n        <button class="btn" onclick="window.closeModal()">Mégse</button>\n    </div>\n    `},"./src/view/confirmResetAssignmentsModal.ts":(n,e,t)=>{t.r(e),t.d(e,{confirmResetAssignmentsModal:()=>i});var a=t("./src/core/Api.ts");const i=()=>'\n    <div class="modal-input-inline">\n        <h2>Biztosan szeretnéd visszaállítani az összes támadást?</h2>\n    </div>\n    <div class="modal-input-inline">\n        <button class="btn" onclick="window.finalResetAssignments()">Igen</button>\n    </div>\n    ';window.finalResetAssignments=()=>{window.attackPlan.targetPool.forEach((n=>{n.isSelected=!1,n.isOpen=!1,n.launchers.forEach((n=>{let e=window.attackPlan.launchPool.findIndex((e=>e.id==n.village.id));-1==e?window.attackPlan.launchPool.push({...n.village}):[window.attackPlan.launchPool[e].unitsContain,n.village.unitsContain]=(0,a.TroopTransaction)(window.attackPlan.launchPool[e].unitsContain,n.village.unitsContain,n.village.unitsContain)})),n.launchers=[]})),window.closeModal(),window.launchVillagesQuery.resetAll(),window.targetPoolQuery.resetAll(),window.DB.savePlan(window.attackPlan)}},"./src/view/editArrivalsModal.ts":(n,e,t)=>{t.r(e),t.d(e,{editArrivalsModal:()=>a});const a=n=>(window.editArrivalsModal.arrivalsRef=n,`\n    <div class="modal-input-group">\n        <label for="">Arrivals:</label>\n        <select id="plan_arrivals_select" size="5">\n        ${n.map((n=>`\n            <option value="${n}">${n}</option>\n            `)).join("")}\n        </select>\n        <input id="plan_arrivals_input" type="datetime-local" type="text" step="1"/>\n    </div>\n    <div class="modal-input-inline">\n        <button class="btn" onclick="editArrivalsModal.addArrival()" >add</button>\n        <button class="btn" onclick="editArrivalsModal.removeArrival()">remove</button>\n    </div>\n    `);window.editArrivalsModal={addArrival:()=>{let n=$("#plan_arrivals_input").val().toString().replace("T"," ");if(""==n)return;window.editArrivalsModal.arrivalsRef.includes(n)||window.editArrivalsModal.arrivalsRef.push(n),window.editArrivalsModal.arrivalsRef.sort(((n,e)=>n>e?1:-1));let e="";window.editArrivalsModal.arrivalsRef.forEach((n=>{e+=`<option value="${n}">${n}</option>`})),$("#plan_arrivals_select").html(e),1==$(".mainWindow").get().length?window.DB.savePlan(window.attackPlan):window.launchDialog.stepCheck()},removeArrival:()=>{let n=$("#plan_arrivals_select").val().toString().replace("T"," ");if(console.log(n),""==n)return;let e=window.editArrivalsModal.arrivalsRef.findIndex((e=>e==n));e>-1&&window.editArrivalsModal.arrivalsRef.splice(e,1);let t="";window.editArrivalsModal.arrivalsRef.forEach((n=>{t+=`<option value="${n}">${n}</option>`})),$("#plan_arrivals_select").html(t),1==$(".mainWindow").get().length?window.DB.savePlan(window.attackPlan):window.launchDialog.stepCheck()}}},"./src/view/editLaunchVillagesModal.ts":(n,e,t)=>{t.r(e),t.d(e,{editLaunchVillagesModal:()=>a});const a=n=>`\n        <label for="">Lanuchers:</label><br>\n        <select id="plan_launcher_list" size="5">\n        </select>\n        <select id="plan_launcher_select" style="font-size:16px" >\n            ${window.Groups.map((n=>`<option value="${n.id}">${n.name}</option>`)).join("")}\n        </select>\n        <div>\n            <button onclick="editLaunchVillagesModal.addGroup()" >add</button>\n            <button onclick="editLaunchVillagesModal.removeGroup()" >remove</button>\n        </div>\n    `;window.editLaunchVillagesModal={addGroup:()=>{let n=parseInt($("#plan_launcher_select").val().toString());if(window.launchDialog.groupIDs.findIndex((e=>e.id==n))>-1)return;window.launchDialog.groupIDs.push({id:n,name:$("#plan_launcher_select option:selected").text()});let e="";window.launchDialog.groupIDs.forEach((n=>{e+=`<option value="${n.id}">${n.name}</option>`})),$("#plan_launcher_list").html(e),window.launchDialog.stepCheck()},removeGroup:()=>{let n=parseInt($("#plan_launcher_list").val().toString()),e=window.launchDialog.groupIDs.findIndex((e=>e.id==n));window.launchDialog.groupIDs.splice(e,1);let t="";window.launchDialog.groupIDs.forEach((n=>{t+=`<option value="${n.id}">${n.name}</option>`})),$("#plan_launcher_list").html(t),window.launchDialog.stepCheck()}}},"./src/view/editPlanNameModal.ts":(n,e,t)=>{t.r(e),t.d(e,{editPlanNameModal:()=>a});const a=n=>(window.editPlanNameModal.planRef=n,`\n        <label for="template_name_input" >Template name:</label><br>\n        <input maxlength="20" value="${window.editPlanNameModal.planRef.name}" onkeyup="window.editPlanNameModal.saveName()" id="template_name_input" type="text"/>\n    `);window.editPlanNameModal={saveName:()=>{let n=$("#template_name_input").val().toString();n=n.substring(0,20).trim(),window.editPlanNameModal.planRef.name=n,$("#open-plan-name").get().length>0&&$("#open-plan-name").text(n),1==$(".mainWindow").get().length?window.DB.savePlan(window.attackPlan):window.launchDialog.stepCheck()}}},"./src/view/editTargetModal.ts":(n,e,t)=>{t.r(e),t.d(e,{editTargetModal:()=>i});var a=t("./src/core/Api.ts");const i=n=>(window.editTargetModal.targetRef=n,`\n    <div class="modal-input-group">\n    <label for="target-select">Targets (<span id="modal-targets-cnt">${n.length}</span>):</label>\n    <select id="target-select" size="5" multiple>\n        ${n.map((n=>`\n            <option value="${n.village.id}">${n.village.name} (${n.village.coord.text}) K${n.village.kontinent}</option>\n            `)).join("")}\n    </select>\n    </div>\n    <div class="modal-input-group">\n        <label for="">new targets:</label><br>\n        <textarea id="plan_targets" size="10"></textarea>\n    </div>\n    <div class="modal-input-inline">\n        <button class="btn" onclick="editTargetModal.addTargets()">Add</button><button class="btn" onclick="editTargetModal.removeTargets()">Remove</button>\n    </div>\n    `);window.editTargetModal={addTargets:()=>{let n=$("#plan_targets").val().toString();console.log(n);let e=Array.from(n.matchAll(/([0-9]{1,3}).([0-9]{1,3})/g));console.log(e),e.forEach((n=>{let e=n[1]+"|"+n[2],t=window.Villages.find((n=>n.coord.text==e)),a=window.editTargetModal.targetRef.findIndex((n=>n.village.coord.text==e));t&&-1==a&&window.editTargetModal.targetRef.push({booster:0,launchers:[],village:t,isOpen:!1,isSelected:!1})})),$("#plan_targets").val(""),$("#modal-targets-cnt").text(window.editTargetModal.targetRef.length),$("#target-select").html(window.editTargetModal.targetRef.map((n=>`\n            <option value="${n.village.name}">${n.village.name} (${n.village.coord.text}) K${n.village.kontinent}</option>\n            `)).join("")),1==$(".mainWindow").get().length?(window.DB.savePlan(window.attackPlan),window.renderTargetVillages()):window.launchDialog.stepCheck()},removeTargets:()=>{$("#target-select").val().toString().split(",").forEach((n=>{let e=window.editTargetModal.targetRef.findIndex((e=>e.village.id==parseInt(n)));1==$(".mainWindow").get().length&&window.editTargetModal.targetRef[e].launchers.forEach((n=>{let e=window.attackPlan.launchPool.findIndex((e=>e.id==n.village.id));-1==e?window.attackPlan.launchPool.push({...n.village}):[window.attackPlan.launchPool[e].unitsContain,n.village.unitsContain]=(0,a.TroopTransaction)(window.attackPlan.launchPool[e].unitsContain,n.village.unitsContain,n.village.unitsContain)})),window.editTargetModal.targetRef.splice(e,1)})),$("#target-select").html(window.editTargetModal.targetRef.map((n=>`\n            <option value="${n.village.name}">${n.village.name} (${n.village.coord.text}) K${n.village.kontinent}</option>\n            `)).join("")),1==$(".mainWindow").get().length&&(window.targetPoolQuery.resetAll(),window.launchVillagesQuery.resetAll())},targetRef:[]}},"./src/view/editTemplatesModal.ts":(n,e,t)=>{t.r(e),t.d(e,{editTemplatesModal:()=>a});const a=n=>(window.templateModal.templateRef=n,`\n        <style>\n            .template-editor {  \n            margin: 0 auto;\n            display: grid;\n            grid-template-columns: 100px 100px;\n            grid-template-rows: max-content 35px max-content max-content;\n            text-align:center;\n            gap: 10px 0px;\n            grid-auto-flow: row;\n            grid-template-areas:\n                "template-select-box template-select-box"\n                "template-buttons template-buttons"\n                "template-infantry template-calvary"\n                "template-machines template-other";\n            }\n            .template-select-box { grid-area: template-select-box; display:grid; }\n            .template-calvary { grid-area: template-calvary; }\n            .template-machines { grid-area: template-machines; }\n            .template-other { grid-area: template-other; }\n            .template-buttons{ grid-area: template-buttons; }\n            .template-infantry { grid-area: template-infantry; }\n            .template-input-group{\n                margin-top:5px;\n            }\n\n            .template-editor option {\n                font-size: 16px;\n                padding: 2px 5px;\n                text-align: center;\n            }\n            .template-unitsInput {\n                width: 45px;\n            }\n\n        </style>\n        <div class="template-editor">\n            <div class="template-select-box">\n                <label for="template_select">Templates:</label>\n                <select onclick="templateModal.selectTemplate()" id="template_select" size="5">\n                    ${n.map((n=>`\n                        <option value="${n.name}">${n.name}</option>\n                        `))}\n                </select>\n                <label for="temp_name">name:</label>\n                <input id="temp_name" type="text" />\n            </div>\n            <div class="template-infantry">\n                <div class="template-input-group">\n                    <img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_spear.png" >\n                    <input id="palnner_unit_input_spear" type="number" tabindex="1" value="0" class="template-unitsInput"><br>\n                    <input onclick="templateModal.selectAll('spear')" id="max_spear" type="checkbox"> Összes\n                </div>\n                <div class="template-input-group">\n                    <img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_sword.png" >\n                    <input id="palnner_unit_input_sword" type="number" tabindex="1" value="0" class="template-unitsInput"><br>\n                    <input onclick="templateModal.selectAll('sword')" id="max_sword" type="checkbox"> Összes\n                </div>\n                <div class="template-input-group">\n                    <img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_axe.png" >\n                    <input id="palnner_unit_input_axe" type="number" tabindex="1" value="0" class="template-unitsInput"><br>\n                    <input onclick="templateModal.selectAll('axe')" id="max_axe" type="checkbox"> Összes\n                </div>\n                <div class="template-input-group" ${0==window.gameConfig.game.archer?'style="display:none;"':""} >\n                    <img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_archer.png" >\n                    <input id="palnner_unit_input_archer" type="number" tabindex="1" value="0" class="template-unitsInput"><br>\n                    <input onclick="templateModal.selectAll('archer')" id="max_archer" type="checkbox"> Összes\n                </div>\n            </div>\n            <div class="template-calvary">\n                <div class="template-input-group">\n                    <img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_spy.png" >\n                    <input id="palnner_unit_input_spy" type="number" tabindex="1" value="0" class="template-unitsInput"><br>\n                    <input onclick="templateModal.selectAll('spy')" id="max_spy" type="checkbox"> Összes\n                </div>\n                <div class="template-input-group">\n                    <img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_light.png" >\n                    <input id="palnner_unit_input_light" type="number" tabindex="1" value="0" class="template-unitsInput"><br>\n                    <input onclick="templateModal.selectAll('light')" id="max_light" type="checkbox"> Összes\n                </div>\n                <div class="template-input-group" ${0==window.gameConfig.game.archer?'style="display:none;"':""}>\n                    <img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_marcher.png" >\n                    <input id="palnner_unit_input_marcher" type="number" tabindex="1" value="0" class="template-unitsInput"><br>\n                    <input onclick="templateModal.selectAll('marcher')" id="max_marcher" type="checkbox"> Összes\n                </div>\n                <div class="template-input-group">\n                    <img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_heavy.png" >\n                    <input id="palnner_unit_input_heavy" type="number" tabindex="1" value="0" class="template-unitsInput"><br>\n                    <input onclick="templateModal.selectAll('heavy')" id="max_heavy" type="checkbox"> Összes\n                </div>    \n            </div>\n            <div class="template-machines">\n                <div class="template-input-group">\n                    <img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_ram.png" >\n                    <input id="palnner_unit_input_ram" type="number" tabindex="1" value="0" class="template-unitsInput"><br>\n                    <input onclick="templateModal.selectAll('ram')" id="max_ram" type="checkbox"> Összes\n                </div>\n                <div class="template-input-group">\n                    <img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_catapult.png" >\n                    <input id="palnner_unit_input_catapult"  type="number" tabindex="1" value="0" class="template-unitsInput"><br>\n                    <input onclick="templateModal.selectAll('catapult')" id="max_catapult" type="checkbox"> Összes\n                </div>\n            </div>\n            <div class="template-other">\n                <div class="template-input-group">\n                    <img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_knight.png" >\n                    <input id="palnner_unit_input_knight" type="number" tabindex="1" value="0" class="template-unitsInput"><br>\n                    <input onclick="templateModal.selectAll('knight')" id="max_knight" type="checkbox"> Összes\n                </div>\n                <div class="template-input-group">\n                    <img src="https://dshu.innogamescdn.com/asset/31698b62/graphic/unit/unit_snob.png" >\n                    <input id="palnner_unit_input_snob" type="number" tabindex="1" value="0" class="template-unitsInput"><br>\n                    <input onclick="templateModal.selectAll('snob')" id="max_snob" type="checkbox"> Összes\n                </div>\n            </div>\n            <div class="template-buttons">\n                <button class="btn" onclick="templateModal.addTemplate()">add</button>\n                <button class="btn" onclick="templateModal.removeTemplate()">remove</button>\n            </div>\n        </div>\n    `);window.templateModal={templateRef:[],addTemplate:()=>{if($("#temp_name").val().toString().length>10)return;let n={name:$("#temp_name").val().toString(),units:{spear:0,sword:0,archer:0,axe:0,spy:0,light:0,marcher:0,heavy:0,ram:0,catapult:0,knight:0,snob:0}};if(Object.keys(n.units).forEach((e=>{let t=parseInt($(`#palnner_unit_input_${e}`).val().toString());console.log($(`#max_${e}`).is(":checked")),$(`#max_${e}`).is(":checked")&&(t=99999),null==t&&(t=0),n.units[e]=t})),console.log(n),""==n.name)return;let e=window.templateModal.templateRef.findIndex((e=>e.name==n.name));e>-1?window.templateModal.templateRef[e]=n:window.templateModal.templateRef.push(n),$("#temp_name").val(""),Object.keys(n.units).forEach((n=>{$(`#palnner_unit_input_${n}`).val("0"),$(`#palnner_unit_input_${n}`).prop("disabled",!1),$(`#max_${n}`).prop("checked",!1)}));let t="";window.templateModal.templateRef.forEach((n=>{t+=`<option value="${n.name}">${n.name}</option>`})),$("#template_select").html(t),1==$(".mainWindow").get().length?window.DB.savePlan(window.attackPlan):window.launchDialog.stepCheck()},removeTemplate:()=>{let n=$("#template_select").val(),e=window.templateModal.templateRef.findIndex((e=>e.name==n));e>-1&&window.templateModal.templateRef.splice(e,1);let t="";window.templateModal.templateRef.forEach((n=>{t+=`<option value="${n.name}">${n.name}</option>`})),$("#template_select").html(t),1==$(".mainWindow").get().length?window.DB.savePlan(window.attackPlan):window.launchDialog.stepCheck()},selectTemplate:()=>{let n=$("#template_select").val(),e=window.templateModal.templateRef.findIndex((e=>e.name==n));if(console.log(e,n,window.templateModal.templateRef),e>-1){let n=window.templateModal.templateRef[e];console.log(n),$("#temp_name").val(n.name),Object.keys(n.units).forEach((e=>{let t=n.units[e];99999==t?($(`#max_${e}`).prop("checked",!0),$(`#palnner_unit_input_${e}`).prop("disabled",!0),$(`#palnner_unit_input_${e}`).val("")):($(`#palnner_unit_input_${e}`).val(t),$(`#palnner_unit_input_${e}`).prop("disabled",!1),$(`#max_${e}`).prop("checked",!1))}))}},selectAll:n=>{$(`#max_${n}`).prop("checked")?$(`#palnner_unit_input_${n}`).val(""):$(`#palnner_unit_input_${n}`).val("0"),$(`#palnner_unit_input_${n}`).prop("disabled",$(`#max_${n}`).prop("checked"))}}},"./src/view/launchDialog.ts":(n,e,t)=>{t.r(e),t.d(e,{launchDialog:()=>c});var a=t("./src/core/Api.ts"),i=t("./src/view/editArrivalsModal.ts"),l=t("./src/view/editLaunchVillagesModal.ts"),o=t("./src/view/editPlanNameModal.ts"),s=t("./src/view/editTargetModal.ts"),r=t("./src/view/editTemplatesModal.ts"),d=t("./src/view/mainWindow.ts");const c=()=>`\n        <style>\n            .launch-dialog{\n                display:grid;\n                text-align:center;\n            }\n            .launch-dialog option {\n                font-size:16px;\n                padding:2px 5px;\n                text-align:center;\n            }\n\n            .launch-dialog button{\n                margin: 10px auto;\n                width: max-content;\n            }\n\n            .launch-dialog-selector{\n                display:grid;\n            }\n\n            .new-plan{\n                display:none;\n            }\n\n            .steps{\n                width:100%;\n                display:inline-flex;\n                justify-content: space-evenly;\n                width: 100%;\n                padding: 10px 0;\n            }\n\n            .step{\n                display:grid;\n            }\n\n            .circle{\n                border-radius:50%;\n                background: linear-gradient(to bottom, #947a62 0%,#7b5c3d 22%,#6c4824 30%,#6c4824 100%);\n                color:white;\n                padding: 4px 10px;\n                font-size: 20px;\n                cursor:pointer;\n                z-index:2;\n            }\n\n            .inactive{\n                background: linear-gradient(to bottom, #b1a397 0%, #645d56 22%, #635f5a 30%, #6c6763 100%) !important\n            }\n\n            .modal-input-group{\n                display:inline-grid;\n                text-align:center;\n                border-bottom: solid 1px #603000;\n                padding: 5px 0;\n            }\n\n            .modal-input-inline{\n                display:block;\n                text-align:center;\n                border-bottom: solid 1px #603000;\n                padding: 5px 0;\n            }\n\n            .modal-input-group label{\n                margin-bottom:10px;\n            }\n\n            .modal-input-group input{\n                margin-bottom:10px;\n            }\n\n            .modal-input-group textarea{\n                margin-bottom:10px;\n            }\n\n            .modal-input-group button{\n                margin-bottom:10px;\n            }\n\n            .modal-input-group input{\n                text-align:center;\n                font-size: 14px;\n            }\n\n            .modal-input-group select{\n                text-align:center;\n                font-size: 14px;\n                margin-bottom:10px;\n            }\n            .progress-field{\n                width:88%; \n                position:absolute;\n                height: 5px;\n                background-color: black;\n                margin-top: 13px;\n                z-index:1;\n                background: linear-gradient(to bottom, #b1a397 0%, #645d56 22%, #635f5a 30%, #6c6763 100%);\n            }\n            #progress-bar{\n                height:100%;\n                background: linear-gradient(to bottom, #947a62 0%,#7b5c3d 22%,#6c4824 30%,#6c4824 100%);\n                z-index:1;\n            }\n        </style>\n        <div id="dialog-loading" style="display: none;justify-content: center;width: 100%;">\n            <img style="height:25px" src="https://dshu.innogamescdn.com/asset/6389cdba/graphic/loading.gif"><span style="padding:5px">Betöltés...</span>\n        </div>\n        <div class="launch-dialog">\n            <div><h1>TW Attack Planner</h1></div>\n            <div class="launch-dialog-selector">\n                <h3>Plans:</h3>\n                <select id="launchDialogSelect" size="5">\n                    ${window.Plans.map((n=>(console.log(n),`<option value="${n.id}">${n.name}</option>`))).join("")}\n                </select>\n                <button onclick="launchDialog.loadPlan()" class="btn">Load Plan</button>\n                <button onclick="launchDialog.removePlan()" class="btn">Remove Plan</button>\n\n                <button onclick="launchDialog.newplan()" class="btn">+ New Plan</button>\n            </div>\n\n            <div class="new-plan">\n                <div class="steps">\n                    <div class="progress-field">\n                        <div id="progress-bar" style="width:0%"></div>\n                    </div>\n                    <div id="c1" onclick="launchDialog.goToStep(1)" class="circle">1</div>\n                    <div id="c2" class="circle inactive">2</div>\n                    <div id="c3" class="circle inactive">3</div>\n                    <div id="c4" class="circle inactive">4</div>\n                    <div id="c5" class="circle inactive">5</div>\n                </div>\n                <div class="step-1 step"></div>\n                <div class="step-2 step" style="display:none;"></div>\n                <div class="step-3 step" style="display:none;"></div>\n                <div class="step-4 step" style="display:none;"></div>\n                <div class="step-5 step" style="display:none;"></div>\n                <button id="nextBtn" onclick="launchDialog.goNext(2)" class="btn" disabled>Next</button>\n                <button style="display:none;" id="createPlan" onclick="launchDialog.createPlan()" class="btn" disabled>Create Plan</button>\n                <button onclick="launchDialog.cancelNewPlan()" class="btn">Cancel</button>\n            </div>\n        </div>\n    `;window.launchDialog={groupIDs:[],currentStep:0,stepCheck:()=>{if(0==$("#dialog-loading").get().length)return;let n=window.launchDialog.currentStep;switch(window.launchDialog.currentStep){case 0:if(!(window.launchDialog.plan.name.length>3&&-1==window.Plans.findIndex((n=>n.name==window.launchDialog.plan.name))))break;window.launchDialog.currentStep++;case 1:if(!(window.launchDialog.plan.targetPool.length>0))break;window.launchDialog.currentStep++;case 2:if(!(window.launchDialog.groupIDs.length>0))break;window.launchDialog.currentStep++;case 3:if(!(window.launchDialog.plan.arrivals.length>0))break;window.launchDialog.currentStep++;case 4:if(!(window.launchDialog.plan.templates.length>0))break;window.launchDialog.currentStep++}n<window.launchDialog.currentStep&&$("#nextBtn").prop("disabled",!1),5==window.launchDialog.currentStep&&$("#createPlan").prop("disabled",!1),console.log(n,window.launchDialog.currentStep)},goToStep:n=>{$(".step-1").hide(),$(".step-2").hide(),$(".step-3").hide(),$(".step-4").hide(),$(".step-5").hide(),$(".step-"+n).show(),n<5?($("#nextBtn").attr("onclick","launchDialog.goNext("+(n+1)+")"),$("#createPlan").hide(),$("#nextBtn").show()):($("#createPlan").show(),$("#nextBtn").hide()),window.launchDialog.stepCheck()},goNext:n=>{$(".step-1").hide(),$(".step-2").hide(),$(".step-3").hide(),$(".step-4").hide(),$(".step-5").hide(),console.log("in",n),$("#c"+n).attr("onclick","launchDialog.goToStep("+n+")"),n>4?($(".step-5").show(),$("#nextBtn").hide(),$("#createPlan").show(),$("#c"+n).removeClass("inactive"),$("#progress-bar").css("width",25*(n-1)+"%")):($("#nextBtn").prop("disabled",!0),$(".step-"+n).show(),$("#c"+n).removeClass("inactive"),$("#progress-bar").css("width",25*(n-1)+"%"),n++,$("#nextBtn").attr("onclick","launchDialog.goNext("+n+")"))},newplan:()=>{$(".new-plan").show(),$(".launch-dialog-selector").hide(),window.launchDialog.currentStep=0,window.launchDialog.plan={arrivals:[],boosters:[],launchPool:[],id:(new Date).getTime().toString(),name:"",targetPool:[],templates:[]},$(".step-1").html((0,o.editPlanNameModal)(window.launchDialog.plan)),$(".step-2").html((0,s.editTargetModal)(window.launchDialog.plan.targetPool)),$(".step-3").html((0,l.editLaunchVillagesModal)(window.launchDialog.plan.launchPool)),$(".step-4").html((0,i.editArrivalsModal)(window.launchDialog.plan.arrivals)),$(".step-5").html((0,r.editTemplatesModal)(window.launchDialog.plan.templates))},cancelNewPlan:()=>{$(".step-1").show(),$(".step-2").hide(),$(".step-3").hide(),$(".step-4").hide(),$(".step-5").hide(),$("#nextBtn").attr("onclick","launchDialog.goNext(2)"),$(".new-plan").hide(),$(".launch-dialog-selector").show(),$("#c2").addClass("inactive"),$("#c3").addClass("inactive"),$("#c4").addClass("inactive"),$("#c5").addClass("inactive"),$("#createPlan").hide(),$("#nextBtn").show(),$("#template_name").val(""),$("#c2").attr("onclick",""),$("#c3").attr("onclick",""),$("#c4").attr("onclick",""),$("#c5").attr("onclick",""),$("#plan_arrivals_select").html(""),$("#plan_targets").val(""),$("#template_select").html(""),$("#temp_name").val(""),window.launchDialog.groupIDs=[],$("#plan_launcher_list").html("")},createPlan:async()=>{$("#dialog-loading").css("display","inline-flex"),$(".launch-dialog").hide(),setTimeout((async()=>{window.attackPlan=window.launchDialog.plan,window.attackPlan.launchPool=await(0,a.loadPages)(window.launchDialog.groupIDs.map((n=>n.id))),await window.DB.savePlan(window.attackPlan),window.UI.SuccessMessage("Plan successfully created!"),setTimeout((()=>{window.Dialog.close("launchDialog"),window.Dialog.show("PlannerMainWindow",(0,d.mainWindow)()),$(".popup_box_container").append('<div style="position: fixed;width: 100%;height: 100%;top:0;left:0;z-index:12001"></div>')}),1e3)}),1e3)},loadPlan:()=>{let n=$("#launchDialogSelect").val().toString();if(""==n)return;let e=window.Plans.findIndex((e=>e.id==n));-1!=e&&($("#dialog-loading").css("display","inline-flex"),$(".launch-dialog").hide(),setTimeout((()=>{window.Dialog.close("launchDialog"),window.attackPlan=window.Plans[e],window.Dialog.show("PlannerMainWindow",(0,d.mainWindow)()),$(".popup_box_container").append('<div style="position: fixed;width: 100%;height: 100%;top:0;left:0;z-index:12001"></div>')}),1e3))},removePlan:async()=>{let n=$("#launchDialogSelect").val().toString();if(""==n)return;window.DB.removePlan(n);let e=await window.DB.loadPlans();$("#launchDialogSelect").html(`${e.map((n=>`<option value="${n.id}">${n.name}</option>`))}`)},plan:void 0}},"./src/view/launchItem.ts":(n,e,t)=>{t.r(e),t.d(e,{launchItem:()=>i});var a=t("./src/core/Api.ts");const i=n=>{n.popSize=(0,a.calcUnitPop)(n.unitsContain);let e="small";n.popSize>1e3&&n.popSize<=5e3?e="medium":n.popSize>5e3&&(e="large");let t=Object.keys(n.unitsContain);return`\n        <div class="launch-item" id="${n.id}">\n            <div class="name-field">\n                <a href="/game.php?village=${a.game.village.id}&screen=info_village&id=${n.id}" target="_blank">${n.name} (${n.coord.text}) K${n.kontinent}</a>\n            </div>\n            <div class="check-field">\n                <input type="checkbox" value="${n.id}"><img src="https://dshu.innogamescdn.com/asset/72737c96/graphic/command/attack_${e}.png">\n            </div>\n            ${t.map((e=>{if(0!=window.gameConfig.game.archer||"archer"!=e&&"marcher"!=e)return`<div class="${e}-field ${0==n.unitsContain[e]?"hidden":""}">${n.unitsContain[e]}</div>`})).join("")}\n        </div>`}},"./src/view/mainWindow.ts":(n,e,t)=>{t.r(e),t.d(e,{mainWindow:()=>w});var a=t("./src/core/Query.ts"),i=t("./src/view/addAttackModal.ts"),l=t("./src/view/addPlayerSpeedModal.ts"),o=t("./src/view/autoAssignModal.ts"),s=t("./src/view/calculatedAttackModal.ts"),r=t("./src/view/confirmCalculateAttackModal.ts"),d=t("./src/view/confirmResetAssignmentsModal.ts"),c=t("./src/view/editArrivalsModal.ts"),p=t("./src/view/editPlanNameModal.ts"),g=t("./src/view/editTargetModal.ts"),u=t("./src/view/editTemplatesModal.ts"),h=t("./src/view/launchItem.ts"),m=t("./src/view/targetItem.ts");const w=()=>`\n    <style>\n        ::-webkit-scrollbar {\n    width: 5px;\n    }\n    \n    /* Track */\n    ::-webkit-scrollbar-track {\n        box-shadow: inset 0 0 5px grey;\n        border-radius: 10px;\n    }\n    \n    /* Handle */\n    ::-webkit-scrollbar-thumb {\n        background: grey;\n        border-radius: 10px;\n    }\n\n        .mainWindow{\n            width: 100%;\n            height:85vh;\n        }\n        .popup_box_container{\n            height:100% !important;\n        }\n        #popup_box_PlannerMainWindow{\n            width: 95vw !important;\n        }\n        html{\n            overflow: hidden !important;\n        }\n        .container {\n            height: calc(100% - 10px);\n            border: solid 2px #6c4824;\n            border-radius:20px;\n            display: grid;\n            grid-template-columns: 260px 1.3fr 1.3fr;\n            grid-template-rows: 30px 3fr [option] 0.1fr;\n            gap: 0px 0px;\n            grid-auto-flow: row;\n        }\n\n        .options-title { \n            grid-area: 1 / 1 / 2 / 2; \n            border-top-left-radius: 20px;\n            border-right: solid 2px #6c4824;\n            border-bottom: solid 2px #6c4824;\n        }\n\n        .options-panel {\n            border-right: solid 2px #6c4824;\n            display: table;\n        }\n\n        .target-title { \n            grid-area: 1 / 2 / 2 / 3; \n            border-right: solid 1px #6c4824;\n            border-bottom: solid 2px #6c4824;\n        }\n\n        .target-panel { \n            grid-area: 2 / 2 / 4 / 3; \n            border-right: solid 1px #6c4824;\n\n            display: grid; \n            grid-template-columns: 1fr; \n            grid-template-rows: 30px 1fr; \n            gap: 0px 0px; \n            grid-template-areas: \n                "target-header"\n                "target-list";\n        }\n\n        .target-header {\n            grid-area: target-header; \n        }\n        .target-list { grid-area: target-list; overflow-y:auto; }\n\n        .launch-title { \n            grid-area: 1 / 3 / 2 / 4;\n            border-top-right-radius: 20px;\n            border-left: solid 1px #6c4824;\n            border-bottom: solid 2px #6c4824;\n            display: flex;\n            flex-wrap: nowrap;\n            justify-content: space-evenly;\n            align-items: flex-start;\n            align-content: flex-start;\n            flex-direction: row;\n        }\n\n        .launch-panel { \n            grid-area: 2 / 3 / 4 / 4; \n            border-left: solid 1px #6c4824;\n            display: grid; \n            grid-template-columns: 1fr; \n            grid-template-rows: 30px 1fr; \n            gap: 0px 0px; \n            grid-template-areas: \n                "launch-header"\n                "launch-list"; \n        }\n\n        .launch-list {\n            overflow-y:scroll;\n            border-bottom-right-radius: 20px;\n            grid-area: launch-list; \n            display: block;\n        }\n        .launch-header { \n            padding-right:5px;\n            background: linear-gradient(to bottom,#e2c07c 0%,#dab874 44%,#c1a264 100%);\n            grid-area: launch-header;\n            display: grid;\n            grid-template-columns:  1fr 1fr 1fr 1fr${1==window.gameConfig.game.archer&&" 1fr"} 1fr 1fr${1==window.gameConfig.game.archer&&" 1fr"} 1fr 1fr 1fr 1fr 1fr; \n            grid-template-rows: 30px;\n            gap: 0px;\n            grid-template-areas: \n                "size-icon spear-icon sword-icon axe-icon${1==window.gameConfig.game.archer&&" archer-icon"} spy-icon light-icon${1==window.gameConfig.game.archer&&" marcher-icon"} heavy-icon ram-icon catapult-icon pala-icon snob-icon"\n        }\n\n        .target-launch-header { \n            background: linear-gradient(to bottom,#e2c07c 0%,#dab874 44%,#c1a264 100%);\n            grid-area: launch-header;\n            display: grid;\n            grid-template-columns:  30px 1fr 1fr 1fr${1==window.gameConfig.game.archer&&" 1fr"} 1fr 1fr${1==window.gameConfig.game.archer?" 1fr":""} 1fr 1fr 1fr 1fr 1fr 30px; \n            grid-template-rows: 30px;\n            gap: 0px;\n            grid-template-areas: \n                "size-icon spear-icon sword-icon axe-icon${1==window.gameConfig.game.archer&&" archer-icon"} spy-icon light-icon${1==window.gameConfig.game.archer&&" marcher-icon"} heavy-icon ram-icon catapult-icon pala-icon snob-icon del-icon"\n        }\n\n        .target-launch-header div {\n            padding: 5px;\n        }\n\n        .target-launch-header img {\n            margin: 0 auto;\n            display: block;\n        }\n\n\n        .credits { grid-area: option / 1 / 4 / 2; border-right: solid 2px #6c4824; padding:10px;}\n\n        .header {\n            background: linear-gradient(to bottom,#e2c07c 0%,#dab874 44%,#c1a264 100%);\n            text-align: center;\n            padding:3px;\n        }\n\n        .launch-header div{\n            padding: 5px;\n        }\n        .launch-header img{\n            margin: 0 auto;\n            display: block;\n            cursor: pointer;\n        }\n\n        .size-icon { grid-area: size-icon; }\n        .spear-icon { grid-area: spear-icon; }\n        .sword-icon { grid-area: sword-icon; }\n        .axe-icon { grid-area: axe-icon; }\n        .archer-icon { grid-area: archer-icon; }\n        .spy-icon { grid-area: spy-icon; }\n        .light-icon { grid-area: light-icon; }\n        .marcher-icon { grid-area: marcher-icon; }\n        .heavy-icon { grid-area: heavy-icon; }\n        .ram-icon { grid-area: ram-icon; }\n        .catapult-icon { grid-area: catapult-icon; }\n        .pala-icon { grid-area: pala-icon; }\n        .snob-icon { grid-area: snob-icon; }\n        .del-icon { grid-area: del-icon; }\n\n        .option-item{\n            width:100%;\n            margin: 15px 0;\n        }\n        .option-item button{\n            height: 30px;\n            margin: 0 auto;\n            display: block;\n            min-width: 85%;\n        }\n        .option-item h2{\n            text-align:center;\n        }\n\n        .header-count{\n            margin-left:10px;\n            display: inline;\n        }\n\n        .header-count span{\n            font-weight: bold;\n            padding: 0 2px;\n        }\n\n        .btn-add-attack{\n                font-size: 30px !important;\n                padding: 0;\n                line-height: 20px;\n        }\n    </style>\n     <style>\n            .targetsLauncher-item{\n                height: max-content;\n                border-top: solid 1px #6c4824;\n                border-bottom: solid 1px #6c4824;\n                margin-top:3px;\n                text-align:center;\n                display: grid; \n                grid-template-columns:  30px 1fr 1fr 1fr${1==window.gameConfig.game.archer&&" 1fr"} 1fr 1fr${1==window.gameConfig.game.archer&&" 1fr"} 1fr 1fr 1fr 1fr 1fr 30px; \n                grid-template-rows: 35px 30px ;\n                gap: 0px 0px; \n                grid-template-areas: \n                    "size-field name-field name-field name-field${1==window.gameConfig.game.archer&&" name-field"} name-field name-field${1==window.gameConfig.game.archer&&" name-field"} name-field name-field name-field name-field name-field del-field"\n                    "size-field spear-field sword-field axe-field${1==window.gameConfig.game.archer&&" archer-field"} spy-field light-field${1==window.gameConfig.game.archer&&" marcher-field"} heavy-field ram-field catapult-field knight-field snob-field del-field";\n            }\n            .del-field{ grid-area: del-field; padding: 20px 5px;background-color:#fff5dc;border-left: 1px solid #6c4824;}\n            .size-field{ grid-area: size-field; padding: 5px 8px;background-color:#fff5dc;border-right: 1px solid #6c4824;}\n\n            .launch-item{\n            height: max-content;\n            border-top: solid 1px #6c4824;\n            border-bottom: solid 1px #6c4824;\n            margin-top:3px;\n            text-align:center;\n            display: grid; \n            grid-template-columns:  1fr 1fr 1fr 1fr${1==window.gameConfig.game.archer&&" 1fr"} 1fr 1fr${1==window.gameConfig.game.archer&&" 1fr"} 1fr 1fr 1fr 1fr 1fr;\n            grid-template-rows: 30px 30px ;\n            gap: 0px 0px; \n            grid-template-areas:\n                "check-field name-field name-field name-field${1==window.gameConfig.game.archer&&" name-field"} name-field name-field${1==window.gameConfig.game.archer&&" name-field"} name-field name-field name-field name-field name-field"\n                "check-field spear-field sword-field axe-field${1==window.gameConfig.game.archer&&" archer-field"} spy-field light-field${1==window.gameConfig.game.archer&&" marcher-field"}  heavy-field ram-field catapult-field knight-field snob-field";\n            }\n\n            .check-field input{\n                height:16px;\n                width:16px;\n                float:left;\n            }\n\n            .check-field img{\n                height: 16px;\n                float:right;\n                padding-right:3px;\n            }\n\n            .size-field img{\n                height: 16px;\n                float:right;\n                padding: 15px 0;\n            }\n\n            .del-field .remove-target-btn{\n                margin: 0 !important;\n            }\n\n            .check-field { grid-area: check-field; padding: 20px 0; background-color:#fff5dc; border-right:1px solid #6c4824}\n            .spear-field { grid-area: spear-field; padding: 5px 0;background-color:#fff5dc}\n            .sword-field { grid-area: sword-field; padding: 5px 0;background-color:#fff5dc}\n            .axe-field { grid-area: axe-field; padding: 5px 0;background-color:#fff5dc}\n            .archer-field { grid-area: archer-field; padding: 5px 0;background-color:#fff5dc}\n            .spy-field { grid-area: spy-field; padding: 5px 0;background-color:#fff5dc}\n            .light-field { grid-area: light-field; padding: 5px 0;background-color:#fff5dc}\n            .marcher-field { grid-area: marcher-field; padding: 5px 0;background-color:#fff5dc}\n            .heavy-field { grid-area: heavy-field; padding: 5px 0;background-color:#fff5dc}\n            .ram-field { grid-area: ram-field; padding: 5px 0;background-color:#fff5dc}\n            .catapult-field { grid-area: catapult-field; padding: 5px 0;background-color:#fff5dc}\n            .knight-field { grid-area: knight-field; padding: 5px 0;background-color:#fff5dc}\n            .snob-field { grid-area: snob-field; padding: 5px 0;background-color:#fff5dc}\n            .name-field { \n                display:grid;\n                grid-area: name-field;\n                color: #603000;\n                font-weight: bold;\n                background-color:#ecd8b2;\n                padding: 5px 0;\n            }\n            .target-item{\n                overflow-x:hidden;\n                display: block;\n                width:100%;\n                margin: 5px 0;\n                border-top: solid 1px #6c4824;\n                border-bottom: solid 1px #6c4824;\n            }\n            .target-header{\n                height:35px;\n                width:100%;\n                display: flex;\n\t            justify-content: space-around;\n                background-color: #ecd8b2;\n                cursor: pointer;\n            }\n\n            .target-header div{\n                padding-top: 9px;\n                padding-bottom: 9px;\n            }\n\n            .target-village-name{\n                color: #603000;\n                font-weight: bold;\n            }\n            .target-extras{\n                flex-grow: 1;\n            }\n\n            .target-launchers{\n                display:none;\n                width:100%;\n                min-height:20px;\n                background-color: #fff5dc;\n            }\n\n            .remove-target-btn {\n                float: right;\n                z-index: 2;\n                width: 20px;\n                height: 20px;\n                background: url(https://dshu.innogamescdn.com/asset/80b013af/graphic/login_close.png) top left no-repeat;\n                cursor: pointer;\n                background-size: 20px;\n                margin-right: 10px;\n            }\n            .add-village-booster{\n                background: url(https://klanhaboru.hu/graphic/plus.png) top left no-repeat;\n                height: 16px;\n                width: 16px;\n                margin-left: 5px;\n                cursor: pointer;\n                display: inline-block;\n                vertical-align: middle;\n            }\n\n            .indicator{\n                font-size: 16px;\n                padding-left: 5px;\n                padding-right: 5px;\n            }\n\n            .indicator-open{\n                transform: rotate(90deg);\n            }\n\n            .planner-modal {\n                background: transparent url(https://dshu.innogamescdn.com/asset/fd86cac8/graphic/index/contentbg.png) scroll left top repeat;\n                filter: drop-shadow(0 0 0.75rem rgb(88, 88, 88));\n                width: max-content;\n                height: fit-content;\n                max-height: calc(100vh - 120px);\n                border: 2px solid #6c4824;\n                position: absolute;\n                top: 0;\n                bottom: 0;\n                left: 0;\n                right: 0;\n                margin: auto;\n                border-radius: 10px;\n                z-index: 100001;\n                display: grid;\n                align-content: space-evenly;\n                grid-template-areas:\n                    'header'\n                    'content';\n                grid-template-rows: 30px calc(100% - 30px);\n            }\n\n            .planner-modal-header {\n                font-size:16px;\n                border-top-left-radius: 10px;\n                border-top-right-radius: 10px;\n                padding: 5px;\n                grid-area: header;\n                text-align: center;\n                background: linear-gradient(to bottom,#e2c07c 0%,#dab874 44%,#c1a264 100%);\n            }\n\n            .planner-modal-content {\n                display:grid;\n                grid-area: content;\n                padding: 10px;\n            }\n\n            .modal-input-group{\n                display:inline-grid;\n                text-align:center;\n                border-bottom: solid 1px #603000;\n                padding: 5px 0;\n            }\n\n            .modal-input-inline{\n                display:block;\n                text-align:center;\n                border-bottom: solid 1px #603000;\n                padding: 5px 0;\n            }\n\n            .modal-input-group label{\n                margin-bottom:10px;\n            }\n\n            .modal-input-group input{\n                margin-bottom:10px;\n            }\n\n            .modal-input-group textarea{\n                margin-bottom:10px;\n            }\n\n            .modal-input-group button{\n                margin-bottom:10px;\n            }\n\n            .modal-input-group input{\n                text-align:center;\n                font-size: 14px;\n            }\n\n            .modal-input-group select{\n                text-align:center;\n                font-size: 14px;\n                margin-bottom:10px;\n            }\n            \n            .del-boost {\n                background: url(https://klanhaboru.hu/graphic/minus.png) top left no-repeat;\n                height: 16px;\n                width: 16px;\n                margin-left: 5px;\n                cursor: pointer;\n                display: inline-block;\n                vertical-align: middle;\n            }\n\n            .booster-button {\n                display: inline;\n            }\n\n            .launch-search-bar{\n                display: inline-block;\n\n            }\n\n            .launch-search-bar input{\n                width:60px;\n                font-size:12px;\n            }\n\n            .remove-search-btn {\n                float: right;\n                z-index: 2;\n                width: 20px;\n                height: 20px;\n                background: url(https://dshu.innogamescdn.com/asset/80b013af/graphic/login_close.png) top left no-repeat;\n                cursor: pointer;\n                background-size: 20px;\n            }\n\n           \n\n        </style>\n    <div class="mainWindow">\n        <div class="container">\n            <div class="options-title header">\n                <h3>Options</h3>\n            </div>\n            <div class="options-panel">\n                <div class="option-item">\n                    <h2 style="font-size: 1rem;"><span id="open-plan-name">${window.attackPlan.name}</span><a onclick="window.editName()" class="rename-icon" href="#" data-title="Átnevez"></a></h2>\n                </div>\n                <div class="option-item">\n                    <button onclick="window.editTargets()" class="btn">Edit targets</button>\n                </div>\n                <div class="option-item">\n                    <button onclick="window.editArrivals()" class="btn">Edit arrivals</button>\n                </div>\n                <div class="option-item">\n                    <button onclick="window.editTemplates()" class="btn">Edit Templates</button>\n                </div>\n                <div class="option-item">\n                    <button onclick="window.editPlayerBoosts()" class="btn">Edit player boosts</button>\n                </div>\n                <div class="option-item">\n                    <button onclick="window.openAutoAssignModal()" class="btn">Auto assigner</button>\n                </div>\n                <div class="option-item">\n                    <button onclick="window.calculateAttack()" class="btn">Calculate</button>\n                </div>\n                <div class="option-item">\n                    <button onclick="window.resetAssignments()" class="btn">Reset assignments</button>\n                </div>\n            </div>\n            <div class="target-title header">\n                <h3>Targets (<span id="target-cnt"></span>)</h3>\n            </div>\n            <div class="target-panel">\n                <div class="target-header">\n                </div>\n                <div class="target-list">\n                </div>\n            </div>\n            <div class="launch-title header">\n                <div class="launch-filter-bar">\n                    <button onclick="window.launchVillagesQuery.order('coord')" class="btn">XY</button>\n                    <button onclick="window.launchVillagesQuery.order('name')" class="btn">Name</button>\n                    \n                </div>\n                <h3>Launch villages (<span id="launch-cnt"></span>)</h3>\n                <div class="launch-filter-bar">\n                    <button onclick="window.launchVillagesQuery.order('popSize')" class="btn">Size</button>\n                    <div class="launch-search-bar">\n                        <input id="search-bar" onkeyup="window.launchVillagesQuery.search()" placeholder='keresés' type="text">\n                        <button onclick="window.launchVillagesQuery.resetAll()" class="btn">Reset</button>\n                    </div>\n                </div>\n            </div>\n            <div class="launch-panel">\n                <div class="launch-header">\n                    <div class="size-icon">\n                        <button onclick="window.openAddLauncherWindow()" class="btn btn-add-attack">⬅</button>\n                    </div>\n                    <div class="spear-icon">\n                        <img onclick="window.launchVillagesQuery.order('unitsContain.spear')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_spear.png">\n                    </div>\n                    <div class="sword-icon">\n                        <img onclick="window.launchVillagesQuery.order('unitsContain.sword')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_sword.png">\n                    </div>\n                    <div class="axe-icon">\n                        <img onclick="window.launchVillagesQuery.order('unitsContain.axe')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_axe.png">\n                    </div>\n                    ${1==window.gameConfig.game.archer&&'<div class="archer-icon">\n                        <img onclick="window.launchVillagesQuery.order(\'unitsContain.archer\')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_archer.png">\n                    </div>'}\n                    <div class="spy-icon">\n                        <img onclick="window.launchVillagesQuery.order('unitsContain.spy')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_spy.png">\n                    </div>\n                    <div class="light-icon">\n                        <img onclick="window.launchVillagesQuery.order('unitsContain.light')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_light.png">\n                    </div>\n                    ${1==window.gameConfig.game.archer&&'<div class="marcher-icon">\n                            <img onclick="window.launchVillagesQuery.order(\'unitsContain.marcher\')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_marcher.png">\n                        </div>'}\n                    <div class="heavy-icon">\n                        <img onclick="window.launchVillagesQuery.order('unitsContain.heavy')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_heavy.png">\n                    </div>\n                    <div class="ram-icon">\n                        <img onclick="window.launchVillagesQuery.order('unitsContain.ram')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_ram.png">\n                    </div>\n                    <div class="catapult-icon">\n                        <img onclick="window.launchVillagesQuery.order('unitsContain.catapult')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_catapult.png">\n                    </div>\n                    <div class="pala-icon">\n                        <img onclick="window.launchVillagesQuery.order('unitsContain.pala')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_knight.png">\n                    </div>\n                    <div class="snob-icon">\n                        <img onclick="window.launchVillagesQuery.order('unitsContain.snob')" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_snob.png">\n                    </div>\n                </div>\n                <div class="launch-list">\n                </div>\n            </div>\n            <div class="credits">\n                v0.1.1-beta [2024.06.04.]; by: toldi26\n            </div>\n        </div>\n    </div>\n    <div class="planner-modal" style="display:none;">\n    <div class="planner-modal-header"><b></b></div>\n    <div class="planner-modal-content"> </div>\n    </div>\n    <script>\n        window.mainInit();\n    <\/script>\n    `;window.mainInit=()=>{window.launchVillagesQuery=new a.Query(window.attackPlan.launchPool,$(".launch-list").get()[0],$("#launch-cnt").get()[0],h.launchItem),window.launchVillagesQuery.render(),window.targetPoolQuery=new a.Query(window.attackPlan.targetPool,$(".target-list").get()[0],$("#target-cnt").get()[0],m.targetItem),window.targetPoolQuery.render()},window.openAddLauncherWindow=()=>{0!=$('input[name="target"]:checked').get().length&&0!=$('input[name="target"]:checked').get().length?0!=$(".launch-list").find("input:checked").get().length?window.createModal((0,i.addAttackModal)(),"Támadás hozzáadása"):window.UI.ErrorMessage("No launcher selected"):window.UI.ErrorMessage("No target selected")},window.createModal=(n,e)=>{$(".planner-modal-header b").text(e),$(".planner-modal-content").html(n+'<div id="plannerCloseBtn" class="modal-input-inline"><button class="btn" onclick="window.closeModal()">Bezár</button></div>'),$(".planner-modal").show()},window.closeModal=()=>{$(".planner-modal-header b").text(""),$(".planner-modal-content").html(""),$(".planner-modal").hide()},window.editName=()=>{window.createModal((0,p.editPlanNameModal)(window.attackPlan),"Terv átnevezése")},window.editTargets=()=>{window.createModal((0,g.editTargetModal)(window.attackPlan.targetPool),"Célpontok Hozzáadása")},window.editArrivals=()=>{window.createModal((0,c.editArrivalsModal)(window.attackPlan.arrivals),"Érkezések szerkesztése")},window.editTemplates=()=>{window.createModal((0,u.editTemplatesModal)(window.attackPlan.templates),"Sablonok szerkesztése")},window.editPlayerBoosts=()=>{window.createModal((0,l.addPlayerSpeedModal)(),"Gyorsítók szerkesztése")},window.calculateAttack=()=>{let n=0;window.attackPlan.targetPool.forEach((e=>{e.launchers.forEach((e=>{n++}))})),0!=n?window.createModal((0,r.confirmCalculateAttackModal)(),"Támadás kiszámítása"):window.UI.ErrorMessage("Nincs egy támadás se kiosztva!")},window.confirmCalculateAttack=()=>{window.createModal((0,s.calculatedAttackModal)(),"Támadási terv")},window.openAutoAssignModal=()=>{window.autoAssign.assignTypes=[],window.autoAssign.launchPoolCopy=structuredClone(window.attackPlan.launchPool),console.log(window.attackPlan.launchPool[5].unitsContain),console.log(window.autoAssign.launchPoolCopy[5].unitsContain),window.createModal((0,o.autoAssignModal)(),"Automata hozzárrendelés")},window.resetAssignments=()=>{window.createModal((0,d.confirmResetAssignmentsModal)(),"Támadások visszaállítása")}},"./src/view/targetItem.ts":(n,e,t)=>{t.r(e),t.d(e,{targetItem:()=>d});var a=t("./src/core/Api.ts"),i=t("./src/view/ConfirmVillageSpeedRemoveModal.ts"),l=t("./src/view/addVillageSpeedModal.ts"),o=t("./src/view/confirmRemoveModal.ts"),s=t("./src/view/confirmRemoveTargetModal.ts"),r=t("./src/view/targetsLauncher.ts");const d=n=>{let e=0,t=0,i=0,l=0,o=0;return n.launchers.forEach((n=>{n.village.popSize<=1e3?t++:n.village.popSize>1e3&&n.village.popSize<=5e3?i++:n.village.popSize>5e3&&l++,n.isAttack||o++,e+=n.village.unitsContain.snob})),`\n    <div id="${n.village.id}" class="target-item">\n        <div onclick="targetItem.toggleTargetItem(this)" class="target-header">\n            <div><input value="${n.village.id}" onclick="targetItem.selectTargetItem(event)" type="radio" name="target" ${n.isSelected?"checked":""}/></div>\n            <div class="indicator ${n.isOpen?"indicator-open":""}"><span >▶<span></div>\n            <div class="target-village-name"><a target="_blank" href="/game.php?village=${a.game.village.id}&screen=info_village&id=${n.village.id}">${n.village.name}(${n.village.coord.text}) K${n.village.kontinent}</a></div>\n            <div class="target-extras">\n                ${n.booster>0?`\n                <div class="booster-button">( ${n.booster}% <img height="15" src="https://dshu.innogamescdn.com/asset/f9cb54f8/graphic/items/3005.png">) <a class="del-boost" onclick="targetItem.removeVillageBooster(event,${n.village.id})"></a></div>\n                `:`\n                    <a onclick="targetItem.addVillageBooster(event,${n.village.id})" class="add-village-booster"></a>\n                `}\n                <div class="header-count">\n                    ${e>0?`<img height="14px" src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_snob.png"><span>${e}<span>`:""}\n                    ${l>0?`<img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/command/attack_large.png"><span>${l}<span>`:""}\n                    ${i>0?`<img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/command/attack_medium.png"><span>${i}<span>`:""}\n                    ${t>0?`<img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/command/attack_small.png"><span>${t}<span>`:""}\n                    ${o>0?`<img src="https://dshu.innogamescdn.com/asset/69990994/graphic/command/support.png"><span>${o}<span>`:""}\n                </div>\n            </div>\n            <div><a onclick="targetItem.removeTargetItem(event,${n.village.id})" class="remove-target-btn"></a></div>\n        </div>\n        <div class="target-launchers" style="display: ${n.isOpen?"block":"none"};">\n        <div class="target-launch-header">\n            <div class="spear-icon">\n                <img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_spear.png">\n            </div>\n            <div class="sword-icon">\n                <img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_sword.png">\n            </div>\n            <div class="axe-icon">\n                <img  src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_axe.png">\n            </div>\n            ${0==window.gameConfig.game.archer?"":'\n            <div class="archer-icon">\n                <img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_archer.png">\n            </div>\n            '}\n            <div class="spy-icon">\n                <img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_spy.png">\n            </div>\n            <div class="light-icon">\n                <img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_light.png">\n            </div>\n            ${0==window.gameConfig.game.archer?"":'\n            <div class="marcher-icon">\n                <img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_marcher.png">\n            </div>\n            '}\n            <div class="heavy-icon">\n                <img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_heavy.png">\n            </div>\n            <div class="ram-icon">\n                <img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_ram.png">\n            </div>\n            <div class="catapult-icon">\n                <img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_catapult.png">\n            </div>\n            <div class="pala-icon">\n                <img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_knight.png">\n            </div>\n            <div class="snob-icon">\n                <img src="https://dshu.innogamescdn.com/asset/fd86cac8/graphic/unit/unit_snob.png">\n            </div>\n            <div class="del-icon"></div> \n        </div>\n        ${n.launchers.map((e=>(0,r.targetsLauncher)(e,n.village.id))).join("")}\n        </div>\n    </div>\n    `};window.targetItem={toggleTargetItem:n=>{$(n).parent().find(".target-launchers").toggle(),$(n).find(".indicator").toggleClass("indicator-open"),$(n).find("input").prop("checked",!0);let e=parseInt($(n).parent().attr("id")),t=window.attackPlan.targetPool.findIndex((n=>n.village.id==e));window.attackPlan.targetPool[t].isOpen=!window.attackPlan.targetPool[t].isOpen},selectTargetItem:n=>{let e=parseInt($(n.target).parent().parent().parent().attr("id"));window.attackPlan.targetPool.forEach((n=>{n.village.id==e?(n.isSelected=!0,n.isOpen=!0):n.isSelected=!1})),n.stopPropagation(),$(n.target).parent().parent().parent().find(".target-launchers").toggle(),$(n.target).parent().parent().find(".indicator").toggleClass("indicator-open")},removeTargetItem:(n,e)=>{n.stopPropagation(),$(".planner-modal-header b").text("Célpont eltávolítása"),$(".planner-modal-content").html((0,s.confirmRemoveTargetModal)(e)),$(".planner-modal").show()},confirmRemoveTargetItem:n=>{let e=window.attackPlan.targetPool.findIndex((e=>e.village.id==n));e<-1||(window.attackPlan.targetPool[e].launchers.forEach((n=>{let e=window.attackPlan.launchPool.findIndex((e=>e.id==n.village.id));if(-1==e){let e={...n.village};window.attackPlan.launchPool.push(e)}else[window.attackPlan.launchPool[e].unitsContain,n.village.unitsContain]=(0,a.TroopTransaction)(window.attackPlan.launchPool[e].unitsContain,n.village.unitsContain,n.village.unitsContain)})),window.attackPlan.targetPool[e].launchers.length>0&&window.launchVillagesQuery.resetAll(),window.attackPlan.targetPool.splice(e,1),window.targetPoolQuery.resetAll(),window.closeModal(),window.DB.savePlan(window.attackPlan))},removeTargetLauncherItem:(n,e)=>{$(".planner-modal-header b").text("Támadás eltávolítása"),$(".planner-modal-content").html((0,o.confirmRemoveModal)(n,e)),$(".planner-modal").show()},confirmRemoveTargetLauncherItem:(n,e)=>{let t=[],i=window.attackPlan.targetPool.findIndex((n=>n.village.id==e));if(i<-1)return;let l=window.attackPlan.targetPool[i].launchers.findIndex((e=>e.village.id==n));if(l<-1)return;let o=window.attackPlan.launchPool.findIndex((e=>e.id==n));if(-1==o){let n={...window.attackPlan.targetPool[i].launchers[l].village};window.attackPlan.launchPool.push(n),window.attackPlan.targetPool[i].launchers.splice(l,1),window.launchVillagesQuery.resetAll()}else[window.attackPlan.launchPool[o].unitsContain,window.attackPlan.targetPool[i].launchers[l].village.unitsContain]=(0,a.TroopTransaction)(window.attackPlan.launchPool[o].unitsContain,window.attackPlan.targetPool[i].launchers[l].village.unitsContain,window.attackPlan.targetPool[i].launchers[l].village.unitsContain),console.log(window.attackPlan.launchPool[o].unitsContain,window.attackPlan.targetPool[i].launchers[l].village.unitsContain),t.push(window.attackPlan.launchPool[o]),window.attackPlan.targetPool[i].launchers.splice(l,1);window.launchVillagesQuery.partialRender(t,"id"),window.targetPoolQuery.partialRender([window.attackPlan.targetPool[i]],"village.id"),window.closeModal(),window.DB.savePlan(window.attackPlan)},addVillageBooster:(n,e)=>{n.stopPropagation(),$(".planner-modal-header b").text("Gyorsító hozzáadása faluhoz"),$(".planner-modal-content").html((0,l.addVillageBoosterModal)(e)),$(".planner-modal").show()},confirmAddVillageBooster:n=>{let e=window.attackPlan.targetPool.findIndex((e=>e.village.id==n));e<-1||(window.attackPlan.targetPool[e].booster=parseInt($("#planner-village-boost").val().toString()),window.closeModal(),window.targetPoolQuery.partialRender([window.attackPlan.targetPool[e]],"village.id"),window.DB.savePlan(window.attackPlan))},removeVillageBooster:(n,e)=>{n.stopPropagation(),$(".planner-modal-header b").text("Gyorsító eltávolítása faluról"),$(".planner-modal-content").html((0,i.ConfirmVillageSpeedRemoveModal)(e)),$(".planner-modal").show()},confirmRemoveVillageBooster:n=>{window.closeModal();let e=window.attackPlan.targetPool.findIndex((e=>e.village.id==n));e<-1||(window.attackPlan.targetPool[e].booster=0,window.closeModal(),window.targetPoolQuery.partialRender([window.attackPlan.targetPool[e]],"village.id"),window.DB.savePlan(window.attackPlan))}}},"./src/view/targetsLauncher.ts":(n,e,t)=>{t.r(e),t.d(e,{targetsLauncher:()=>i});var a=t("./src/core/Api.ts");const i=(n,e)=>{let t="small";n.village.popSize>1e3&&n.village.popSize<=5e3?t="medium":n.village.popSize>5e3&&(t="large");let i=`https://dshu.innogamescdn.com/asset/72737c96/graphic/command/attack_${t}.png`;n.isAttack||(i="https://dshu.innogamescdn.com/asset/69990994/graphic/command/support.png");let l=Object.keys(n.village.unitsContain),o="";for(let e=0;e<l.length;e++){const t=l[e];(0!=window.gameConfig.game.archer||"archer"!=t&&"marcher"!=t)&&(o+=`<div class="${t}-field ${0==n.village.unitsContain[t]?"hidden":""}">${n.village.unitsContain[t]}</div>`)}return`\n    <div class="targetsLauncher-item" id="${n.village.id}">\n        <div class="name-field">\n            <span><a target="_blank" href="/game.php?village=${a.game.village.id}&screen=info_village&id=${n.village.id}">${n.village.name} (${n.village.coord.text}) K${n.village.kontinent}</a></span>\n            <span style="font-size:9px;color:black">(${n.arrival})</span>\n        </div>\n        <div class="size-field"><img src="${i}"></div>\n        ${o}\n        <div class="del-field"><a onclick="window.targetItem.removeTargetLauncherItem(${n.village.id.toString()},${e})" class="remove-target-btn"></a></div>\n    </div>`}}},e={};function t(a){var i=e[a];if(void 0!==i)return i.exports;var l=e[a]={exports:{}};return n[a](l,l.exports,t),l.exports}t.d=(n,e)=>{for(var a in e)t.o(e,a)&&!t.o(n,a)&&Object.defineProperty(n,a,{enumerable:!0,get:e[a]})},t.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),t.r=n=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};var a={};(()=>{t.r(a);var n=t("./src/core/Api.ts"),e=t("./src/core/PlayersModel.ts"),i=t("./src/core/VillageModel.ts"),l=t("./src/core/planDB.ts"),o=t("./src/view/launchDialog.ts");(async()=>{window.DB=new l.planDB,await window.DB.init(),window.Plans=await window.DB.loadPlans(),window.gameConfig=await(0,n.getServerConifg)(),window.unitConfig=await(0,n.getUnitConfig)(),window.Villages=await i.VillageModel.init(),window.Players=await e.PlayersModel.init(),window.Groups=await(0,n.fetchGroups)(),window.Dialog.show("launchDialog",(0,o.launchDialog)()),$(".popup_box_container").append('<div style="position: fixed;width: 100%;height: 100%;top:0;left:0;z-index:12001"></div>')})()})()})();